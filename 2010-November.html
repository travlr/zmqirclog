

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>2010-November &mdash; ZeroMq IRC Log v0.1 documentation</title>
    <link rel="stylesheet" href="static/default.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <link rel="top" title="ZeroMq IRC Log v0.1 documentation" href="index.html" />
    <link rel="next" title="2011-September" href="2011-September.html" />
    <link rel="prev" title="2010-October" href="2010-October.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="2011-September.html" title="2011-September"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="2010-October.html" title="2010-October"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">ZeroMq IRC Log v0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="november">
<h1>2010-November<a class="headerlink" href="#november" title="Permalink to this headline">Â¶</a></h1>
<div class="line-block">
<div class="line">[Monday 01 November 2010] [00:23:54] &lt;xraid&gt;  gandhijee: <a class="reference external" href="http://api.zeromq.org/zmq_msg_size.html">http://api.zeromq.org/zmq_msg_size.html</a> &#8211; what binding are you using ?</div>
<div class="line">[Monday 01 November 2010] [00:26:53] &lt;gandhijee&gt;      xraid: C, i am using protocol buffers from google</div>
<div class="line">[Monday 01 November 2010] [00:27:27] &lt;gandhijee&gt;      and i am trying to figure out how to allocate the memory for the message after i get it from the sender</div>
<div class="line">[Monday 01 November 2010] [00:29:54] &lt;gandhijee&gt;      xraid: that was it, thanks!</div>
<div class="line">[Monday 01 November 2010] [03:27:45] &lt;dccmx&gt;  i have a question</div>
<div class="line">[Monday 01 November 2010] [04:28:19] &lt;xraid&gt;  hey whats up with the ML i am subscribed but cants send to it as i am not a member of the list ? i thought i was a member of the list if subscribed ?</div>
<div class="line">[Monday 01 November 2010] [04:33:02] &lt;<a href="#id13"><span class="problematic" id="id14">sustrik_</span></a>&gt;       xraid: what&#8217;s your address?</div>
<div class="line">[Monday 01 November 2010] [04:34:51] &lt;xraid&gt;  zmq iprobot.com</div>
<div class="line">[Monday 01 November 2010] [04:38:34] &lt;<a href="#id15"><span class="problematic" id="id16">sustrik_</span></a>&gt;       let me see</div>
<div class="line">[Monday 01 November 2010] [04:40:25] &lt;xraid&gt;  hehe i tried to sub as xraid but i was banned . i then replied with a &#8220;why so&#8221; . no answer yet ...</div>
<div class="line">[Monday 01 November 2010] [04:41:52] &lt;<a href="#id17"><span class="problematic" id="id18">sustrik_</span></a>&gt;       xraid: the subscription is see is &#8220;omq at iprobot.com&#8221;</div>
<div class="line">[Monday 01 November 2010] [04:43:54] &lt;xraid&gt;  ahhh that explains it then ...</div>
<div class="line">[Monday 01 November 2010] [04:48:33] &lt;xraid&gt;  sustrik: if possible i much prefer to change omq to xraid if possible</div>
<div class="line">[Monday 01 November 2010] [04:54:15] &lt;<a href="#id19"><span class="problematic" id="id20">sustrik_</span></a>&gt;       well, do so</div>
<div class="line">[Monday 01 November 2010] [04:54:51] &lt;<a href="#id21"><span class="problematic" id="id22">sustrik_</span></a>&gt;       ah, xraid is banned?</div>
<div class="line">[Monday 01 November 2010] [04:55:34] &lt;xraid&gt;  huh ;-9</div>
<div class="line">[Monday 01 November 2010] [04:55:45] &lt;xraid&gt;  how come</div>
<div class="line">[Monday 01 November 2010] [04:56:22] &lt;<a href="#id23"><span class="problematic" id="id24">sustrik_</span></a>&gt;       hm, it&#8217;s not in the ban list</div>
<div class="line">[Monday 01 November 2010] [04:56:27] &lt;<a href="#id25"><span class="problematic" id="id26">sustrik_</span></a>&gt;       ???</div>
<div class="line">[Monday 01 November 2010] [04:56:40] &lt;<a href="#id27"><span class="problematic" id="id28">sustrik_</span></a>&gt;       &#8220;hehe i tried to sub as xraid but i was banned&#8221;</div>
<div class="line">[Monday 01 November 2010] [07:33:47] &lt;Ogedei&gt; do I understand correctly that msg&#8217;s <em>can</em> be passed between threads (as long as they are accessed in a single-threaded way), and don&#8217;t have restriction that sockets have?</div>
<div class="line">[Monday 01 November 2010] [07:39:19] &lt;sustrik&gt;        Ogedei: yes</div>
<div class="line">[Monday 01 November 2010] [07:39:26] &lt;sustrik&gt;        they are plain structures</div>
<div class="line">[Monday 01 November 2010] [07:45:43] &lt;Ogedei&gt; sustrik: thank you</div>
<div class="line">[Monday 01 November 2010] [07:47:37] &lt;sustrik&gt;        you are welcome</div>
<div class="line">[Monday 01 November 2010] [08:32:28] &lt;mato&gt;   sustrik: are you there?</div>
<div class="line">[Monday 01 November 2010] [08:32:50] &lt;sustrik&gt;        hi</div>
<div class="line">[Monday 01 November 2010] [08:33:01] &lt;mato&gt;   hi</div>
<div class="line">[Monday 01 November 2010] [08:33:14] &lt;mato&gt;   sustrik: what exactly would you like me to test with the new signaler, performance-wise?</div>
<div class="line">[Monday 01 November 2010] [08:33:33] &lt;sustrik&gt;        not yet, just test whether it works for you</div>
<div class="line">[Monday 01 November 2010] [08:33:47] &lt;mato&gt;   ah, ok</div>
<div class="line">[Monday 01 November 2010] [08:33:51] &lt;mato&gt;   i&#8217;ll do that now then</div>
<div class="line">[Monday 01 November 2010] [08:33:55] &lt;sustrik&gt;        ok</div>
<div class="line">[Monday 01 November 2010] [08:35:43] &lt;mato&gt;   sustrik: note that my userspace (Debian lenny) is too old for eventfd, so I&#8217;ll be testing the socketpair implementation</div>
<div class="line">[Monday 01 November 2010] [08:36:05] &lt;sustrik&gt;        goosd</div>
<div class="line">[Monday 01 November 2010] [08:36:07] &lt;mato&gt;   i can maybe hack something together to try and make eventfd work on my systems, but not right now</div>
<div class="line">[Monday 01 November 2010] [08:36:24] &lt;sustrik&gt;        just test what you have</div>
<div class="line">[Monday 01 November 2010] [09:01:19] &lt;CIA-21&gt; zeromq2: 03Mikael Helbo Kjaer 07master * r0ad71f8 10/ (src/select.cpp src/select.hpp):</div>
<div class="line">[Monday 01 November 2010] [09:01:19] &lt;CIA-21&gt; zeromq2: select now uses Erase-Remove idiom for retired fds</div>
<div class="line">[Monday 01 November 2010] [09:01:19] &lt;CIA-21&gt; zeromq2: Signed-off-by: Mikael Helbo Kjaer &lt;<a class="reference external" href="mailto:mhk&#37;&#52;&#48;designtech&#46;dk">mhk<span>&#64;</span>designtech<span>&#46;</span>dk</a>&gt; - <a class="reference external" href="http://bit.ly/9mdkZd">http://bit.ly/9mdkZd</a></div>
<div class="line">[Monday 01 November 2010] [09:04:15] &lt;mato&gt;   sustrik: seems to work so far... testing with up to 600 nodes</div>
<div class="line">[Monday 01 November 2010] [09:04:29] &lt;sustrik&gt;        mato: the patch you&#8217;ve sent means that INSTALL goes to git, right?</div>
<div class="line">[Monday 01 November 2010] [09:04:50] &lt;mato&gt;   sustrik: the topology setup time obviously increases, and i increased the listen backlog and turned wait_before_reconnect on as usual</div>
<div class="line">[Monday 01 November 2010] [09:05:00] &lt;mato&gt;   sustrik: yes, that&#8217;s correct, just apply the patch as is</div>
<div class="line">[Monday 01 November 2010] [09:05:14] &lt;mato&gt;   sustrik: it removes INSTALL from .gitignore and adds it into git, yes</div>
<div class="line">[Monday 01 November 2010] [09:05:50] &lt;sustrik&gt;        interestingly, git apply doesn&#8217;t add the new file to the git</div>
<div class="line">[Monday 01 November 2010] [09:06:12] &lt;mato&gt;   probably because it&#8217;s in .gitignore</div>
<div class="line">[Monday 01 November 2010] [09:06:21] &lt;sustrik&gt;        np</div>
<div class="line">[Monday 01 November 2010] [09:06:23] &lt;mato&gt;   just add it in by hand or something</div>
<div class="line">[Monday 01 November 2010] [09:06:33] &lt;sustrik&gt;        i did</div>
<div class="line">[Monday 01 November 2010] [09:06:37] &lt;mato&gt;   and don&#8217;t forget to remote it from .gitignore :-)</div>
<div class="line">[Monday 01 November 2010] [09:06:53] &lt;sustrik&gt;        that part was applied ok</div>
<div class="line">[Monday 01 November 2010] [09:09:32] &lt;pieterh&gt;        sustrik: without the foreign flag, autotools will generate INSTALL automatically</div>
<div class="line">[Monday 01 November 2010] [09:10:03] &lt;mato&gt;   pieterh: kind of, but with the foreign flag it breaks our automatic ChangeLog generation</div>
<div class="line">[Monday 01 November 2010] [09:10:29] &lt;pieterh&gt;        you mean without foreign flag?</div>
<div class="line">[Monday 01 November 2010] [09:10:34] &lt;mato&gt;   yes, I wrote about it</div>
<div class="line">[Monday 01 November 2010] [09:10:38] &lt;pieterh&gt;        yes</div>
<div class="line">[Monday 01 November 2010] [09:10:47] &lt;sustrik&gt;        patch looks like working ok</div>
<div class="line">[Monday 01 November 2010] [09:10:50] &lt;sustrik&gt;        committing it</div>
<div class="line">[Monday 01 November 2010] [09:10:53] &lt;mato&gt;   there&#8217;s a reason for that foreign flag</div>
<div class="line">[Monday 01 November 2010] [09:10:57] &lt;mato&gt;   as I explained.</div>
<div class="line">[Monday 01 November 2010] [09:11:12] &lt;pieterh&gt;        mato: I was just explaining to sustrik that INSTALL is usually generated code</div>
<div class="line">[Monday 01 November 2010] [09:11:22] &lt;sustrik&gt;        it used to be</div>
<div class="line">[Monday 01 November 2010] [09:11:24] &lt;mato&gt;   no, it&#8217;s stuck in as a template if it&#8217;s not there</div>
<div class="line">[Monday 01 November 2010] [09:11:34] &lt;sustrik&gt;        not it&#8217;s not</div>
<div class="line">[Monday 01 November 2010] [09:11:39] &lt;pieterh&gt;        we were looking for this yesterday but I couldn&#8217;t see where the foreign flag was being set</div>
<div class="line">[Monday 01 November 2010] [09:11:42] &lt;sustrik&gt;        i don&#8217;t care much</div>
<div class="line">[Monday 01 November 2010] [09:12:01] &lt;mato&gt;   whatever, the INSTALL file will eventually contain custom content anyway</div>
<div class="line">[Monday 01 November 2010] [09:12:08] &lt;mato&gt;   so it&#8217;ll be in git anyway</div>
<div class="line">[Monday 01 November 2010] [09:12:12] &lt;pieterh&gt;        presumably, yes</div>
<div class="line">[Monday 01 November 2010] [09:12:51] &lt;CIA-21&gt; zeromq2: 03Martin Lucina 07maint * reb83678 10/ (.gitignore INSTALL):</div>
<div class="line">[Monday 01 November 2010] [09:12:51] &lt;CIA-21&gt; zeromq2: Add INSTALL to Git, thus making it a normal file</div>
<div class="line">[Monday 01 November 2010] [09:12:51] &lt;CIA-21&gt; zeromq2: INSTALL gets added in somewhat magically by automake, or not. Adding it into</div>
<div class="line">[Monday 01 November 2010] [09:12:51] &lt;CIA-21&gt; zeromq2: Git ensures it&#8217;s always included in the distribution.</div>
<div class="line">[Monday 01 November 2010] [09:12:51] &lt;CIA-21&gt; zeromq2: Signed-off-by: Martin Lucina &lt;<a class="reference external" href="mailto:mato&#37;&#52;&#48;kotelna&#46;sk">mato<span>&#64;</span>kotelna<span>&#46;</span>sk</a>&gt; - <a class="reference external" href="http://bit.ly/bCAWcw">http://bit.ly/bCAWcw</a></div>
<div class="line">[Monday 01 November 2010] [09:17:50] &lt;sustrik&gt;        mato, pieter: for development releases i propose we won&#8217;t upload the man pages to the website</div>
<div class="line">[Monday 01 November 2010] [09:17:59] &lt;sustrik&gt;        they are included in the package</div>
<div class="line">[Monday 01 November 2010] [09:18:12] &lt;mato&gt;   sustrik: dunno, maybe... or we have two sets on the website</div>
<div class="line">[Monday 01 November 2010] [09:18:16] &lt;sustrik&gt;        and it would confuse users using the stable release</div>
<div class="line">[Monday 01 November 2010] [09:18:16] &lt;mato&gt;   to be determined</div>
<div class="line">[Monday 01 November 2010] [09:18:27] &lt;sustrik&gt;        it there are 2 versions of docs on the website</div>
<div class="line">[Monday 01 November 2010] [09:18:32] &lt;pieterh&gt;        to be determined</div>
<div class="line">[Monday 01 November 2010] [09:18:42] &lt;pieterh&gt;        how does, e.g. APR do this?  How does any project do this?</div>
<div class="line">[Monday 01 November 2010] [09:18:57] &lt;sustrik&gt;        no idea</div>
<div class="line">[Monday 01 November 2010] [09:19:07] &lt;sustrik&gt;        do they have &#8216;unstable&#8217; releases?</div>
<div class="line">[Monday 01 November 2010] [09:19:10] &lt;pieterh&gt;        sure</div>
<div class="line">[Monday 01 November 2010] [09:19:11] &lt;mato&gt;   yes</div>
<div class="line">[Monday 01 November 2010] [09:19:17] &lt;pieterh&gt;        every serious project has</div>
<div class="line">[Monday 01 November 2010] [09:19:19] &lt;mato&gt;   and they have multiple versions of the docs uploaded</div>
<div class="line">[Monday 01 November 2010] [09:19:22] &lt;mato&gt;   clearly marked</div>
<div class="line">[Monday 01 November 2010] [09:19:22] &lt;pieterh&gt;        indeed</div>
<div class="line">[Monday 01 November 2010] [09:19:28] &lt;pieterh&gt;        it&#8217;s just code at a URL</div>
<div class="line">[Monday 01 November 2010] [09:19:35] &lt;mato&gt;   some people will of course not read the clear marking and get confused anyway, too bad</div>
<div class="line">[Monday 01 November 2010] [09:19:38] &lt;pieterh&gt;        indeed</div>
<div class="line">[Monday 01 November 2010] [09:19:42] &lt;sustrik&gt;        ok</div>
<div class="line">[Monday 01 November 2010] [09:21:04] &lt;mato&gt;   sustrik: ok, so what are we going to do with the new signaler?</div>
<div class="line">[Monday 01 November 2010] [09:21:30] &lt;mato&gt;   sustrik: it seems to work as far as I can tell, but as I say, I&#8217;ve only tested on a single platform and have not done any serious performance tests...</div>
<div class="line">[Monday 01 November 2010] [09:21:53] &lt;CIA-21&gt; zeromq2: 03Martin Lucina 07master * reb83678 10/ (.gitignore INSTALL):</div>
<div class="line">[Monday 01 November 2010] [09:21:53] &lt;CIA-21&gt; zeromq2: Add INSTALL to Git, thus making it a normal file</div>
<div class="line">[Monday 01 November 2010] [09:21:53] &lt;CIA-21&gt; zeromq2: INSTALL gets added in somewhat magically by automake, or not. Adding it into</div>
<div class="line">[Monday 01 November 2010] [09:21:53] &lt;CIA-21&gt; zeromq2: Git ensures it&#8217;s always included in the distribution.</div>
<div class="line">[Monday 01 November 2010] [09:21:53] &lt;CIA-21&gt; zeromq2: Signed-off-by: Martin Lucina &lt;<a class="reference external" href="mailto:mato&#37;&#52;&#48;kotelna&#46;sk">mato<span>&#64;</span>kotelna<span>&#46;</span>sk</a>&gt; - <a class="reference external" href="http://bit.ly/bCAWcw">http://bit.ly/bCAWcw</a></div>
<div class="line">[Monday 01 November 2010] [09:21:53] &lt;CIA-21&gt; zeromq2: 03Martin Sustrik 07master * rdbcd382 10/ (.gitignore INSTALL):</div>
<div class="line">[Monday 01 November 2010] [09:21:55] &lt;CIA-21&gt; zeromq2: Merge branch &#8216;maint&#8217;</div>
<div class="line">[Monday 01 November 2010] [09:21:55] &lt;CIA-21&gt; zeromq2: * maint:</div>
<div class="line">[Monday 01 November 2010] [09:21:55] &lt;CIA-21&gt; zeromq2:  Add INSTALL to Git, thus making it a normal file - <a class="reference external" href="http://bit.ly/aK31FB">http://bit.ly/aK31FB</a></div>
<div class="line">[Monday 01 November 2010] [09:22:05] &lt;sustrik&gt;        mato: well, it&#8217;s kind of complex</div>
<div class="line">[Monday 01 November 2010] [09:22:19] &lt;sustrik&gt;        maybe you want just to patch your version as for now?</div>
<div class="line">[Monday 01 November 2010] [09:22:26] &lt;mato&gt;   why?</div>
<div class="line">[Monday 01 November 2010] [09:22:32] &lt;sustrik&gt;        time pressure?</div>
<div class="line">[Monday 01 November 2010] [09:22:32] &lt;mato&gt;   that all gets very confusing rapidly</div>
<div class="line">[Monday 01 November 2010] [09:22:41] &lt;mato&gt;   and i&#8217;d like to avoid extra patches if at all possible...</div>
<div class="line">[Monday 01 November 2010] [09:22:51] &lt;sustrik&gt;        so, for starters we need win32 implementation of event</div>
<div class="line">[Monday 01 November 2010] [09:23:05] &lt;sustrik&gt;        i&#8217;ve only did linux one</div>
<div class="line">[Monday 01 November 2010] [09:23:20] &lt;sustrik&gt;        also, i&#8217;ve merged the hp-ux/aix code with linux code</div>
<div class="line">[Monday 01 November 2010] [09:23:26] &lt;mato&gt;   right, i saw that</div>
<div class="line">[Monday 01 November 2010] [09:23:37] &lt;sustrik&gt;        hopefully, brett will test that part</div>
<div class="line">[Monday 01 November 2010] [09:23:43] &lt;mato&gt;   that doesn&#8217;t matter too much, if hp-ux/aix breaks then i&#8217;d expect those users to speak up</div>
<div class="line">[Monday 01 November 2010] [09:23:54] &lt;mato&gt;   we cannot obviously test on platforms we don&#8217;t have</div>
<div class="line">[Monday 01 November 2010] [09:24:05] &lt;mato&gt;   and hp-ux/aix are a minority platform anyway</div>
<div class="line">[Monday 01 November 2010] [09:24:08] &lt;sustrik&gt;        so, we need win implementation</div>
<div class="line">[Monday 01 November 2010] [09:24:15] &lt;mato&gt;   right...</div>
<div class="line">[Monday 01 November 2010] [09:24:20] &lt;sustrik&gt;        test the eventfd implementation</div>
<div class="line">[Monday 01 November 2010] [09:24:35] &lt;sustrik&gt;        i&#8217;ve did a bit, but maybe running some larger payload would be good</div>
<div class="line">[Monday 01 November 2010] [09:24:41] &lt;sustrik&gt;        then we need to optimise it</div>
<div class="line">[Monday 01 November 2010] [09:25:17] &lt;sustrik&gt;        will you do the win32 part?</div>
<div class="line">[Monday 01 November 2010] [09:26:04] &lt;mato&gt;   i could do that, yes</div>
<div class="line">[Monday 01 November 2010] [09:26:58] &lt;sustrik&gt;        thx</div>
<div class="line">[Monday 01 November 2010] [09:28:51] &lt;sustrik&gt;        mato: btw, i copied your release process here:</div>
<div class="line">[Monday 01 November 2010] [09:28:52] &lt;sustrik&gt;        <a class="reference external" href="http://www.zeromq.org/docs:procedures#toc7">http://www.zeromq.org/docs:procedures#toc7</a></div>
<div class="line">[Monday 01 November 2010] [09:29:29] &lt;mato&gt;   sustrik: oh, good</div>
<div class="line">[Monday 01 November 2010] [09:29:55] &lt;sustrik&gt;        it&#8217;s not perfect, but at least it&#8217;s documented</div>
<div class="line">[Monday 01 November 2010] [09:30:04] &lt;mato&gt;   yup, good</div>
<div class="line">[Monday 01 November 2010] [09:34:33] &lt;pieterh&gt;        sustrik: very nice, we were missing this</div>
<div class="line">[Monday 01 November 2010] [10:34:55] &lt;mato&gt;   <a href="#id29"><span class="problematic" id="id30">sustrik_</span></a>: hmm, event_t::wait() is supposed to busy-loop?</div>
<div class="line">[Monday 01 November 2010] [10:35:28] &lt;mato&gt;   <a href="#id31"><span class="problematic" id="id32">sustrik_</span></a>: ah, sorry, i misread the code</div>
<div class="line">[Monday 01 November 2010] [11:10:21] &lt;mato&gt;   <a href="#id33"><span class="problematic" id="id34">sustrik_</span></a>: here?</div>
<div class="line">[Monday 01 November 2010] [11:25:51] &lt;mato&gt;   <a href="#id35"><span class="problematic" id="id36">sustrik_</span></a>: um, the signaler has always been ignoring EINTR as far as I can tell...</div>
<div class="line">[Monday 01 November 2010] [11:26:08] &lt;mato&gt;   <a href="#id37"><span class="problematic" id="id38">sustrik_</span></a>: so it would seem that is the <em>correct</em> behaviour</div>
<div class="line">[Monday 01 November 2010] [11:26:25] &lt;mato&gt;   <a href="#id39"><span class="problematic" id="id40">sustrik_</span></a>: and the do { recv() } while() loop has to stay for POSIX platforms</div>
<div class="line">[Monday 01 November 2010] [11:26:39] &lt;<a href="#id41"><span class="problematic" id="id42">sustrik_</span></a>&gt;       hm</div>
<div class="line">[Monday 01 November 2010] [11:26:58] &lt;<a href="#id43"><span class="problematic" id="id44">sustrik_</span></a>&gt;       ignoring = looping?</div>
<div class="line">[Monday 01 November 2010] [11:27:19] &lt;mato&gt;   yes</div>
<div class="line">[Monday 01 November 2010] [11:27:34] &lt;<a href="#id45"><span class="problematic" id="id46">sustrik_</span></a>&gt;       even blocking read?</div>
<div class="line">[Monday 01 November 2010] [11:27:36] &lt;<a href="#id47"><span class="problematic" id="id48">sustrik_</span></a>&gt;       let me see</div>
<div class="line">[Monday 01 November 2010] [11:27:41] &lt;mato&gt;   ah, hang on</div>
<div class="line">[Monday 01 November 2010] [11:27:51] &lt;mato&gt;   the different implementations are a mess...</div>
<div class="line">[Monday 01 November 2010] [11:28:06] &lt;<a href="#id49"><span class="problematic" id="id50">sustrik_</span></a>&gt;           if (nbytes == -1 &amp;&amp; (errno == EAGAIN || errno == EINTR))</div>
<div class="line">[Monday 01 November 2010] [11:28:07] &lt;<a href="#id51"><span class="problematic" id="id52">sustrik_</span></a>&gt;               return -1;</div>
<div class="line">[Monday 01 November 2010] [11:28:23] &lt;mato&gt;   yeah, because that implementation uses MSG_DONTWAIT</div>
<div class="line">[Monday 01 November 2010] [11:28:32] &lt;mato&gt;   which is specific to god knows what platforms</div>
<div class="line">[Monday 01 November 2010] [11:28:44] &lt;<a href="#id53"><span class="problematic" id="id54">sustrik_</span></a>&gt;       yep</div>
<div class="line">[Monday 01 November 2010] [11:28:58] &lt;<a href="#id55"><span class="problematic" id="id56">sustrik_</span></a>&gt;       we don&#8217;t need that now so we can drop it</div>
<div class="line">[Monday 01 November 2010] [11:29:24] &lt;<a href="#id57"><span class="problematic" id="id58">sustrik_</span></a>&gt;       in any case if (EINTR) return -1</div>
<div class="line">[Monday 01 November 2010] [11:29:47] &lt;mato&gt;   yeah but your event_t has no notion of returning anything (all the methods are void)</div>
<div class="line">[Monday 01 November 2010] [11:29:58] &lt;mato&gt;   i&#8217;m just wondering how that is supposed to work...</div>
<div class="line">[Monday 01 November 2010] [11:30:19] &lt;<a href="#id59"><span class="problematic" id="id60">sustrik_</span></a>&gt;       we&#8217;ll have to add the reurn codes then</div>
<div class="line">[Monday 01 November 2010] [11:30:42] &lt;<a href="#id61"><span class="problematic" id="id62">sustrik_</span></a>&gt;       the idea is that application thread exits on EINTR</div>
<div class="line">[Monday 01 November 2010] [11:30:56] &lt;<a href="#id63"><span class="problematic" id="id64">sustrik_</span></a>&gt;       while I/O thread restarts the operation</div>
<div class="line">[Monday 01 November 2010] [11:31:15] &lt;mato&gt;   so that means that signaler_t::recv() must return EINTR if the underlying blocking call is interrupted, right?</div>
<div class="line">[Monday 01 November 2010] [11:31:26] &lt;<a href="#id65"><span class="problematic" id="id66">sustrik_</span></a>&gt;       tes</div>
<div class="line">[Monday 01 November 2010] [11:31:31] &lt;<a href="#id67"><span class="problematic" id="id68">sustrik_</span></a>&gt;       yes</div>
<div class="line">[Monday 01 November 2010] [11:31:59] &lt;<a href="#id69"><span class="problematic" id="id70">sustrik_</span></a>&gt;       actually, i am not sure EINTR can even happen in I/O thread</div>
<div class="line">[Monday 01 November 2010] [11:32:02] &lt;mato&gt;   so both event_t::wait() and event_t::reset() need to be able to return -1 and errno=EINTR, right?</div>
<div class="line">[Monday 01 November 2010] [11:32:12] &lt;<a href="#id71"><span class="problematic" id="id72">sustrik_</span></a>&gt;       given that signals are switched off in those threads</div>
<div class="line">[Monday 01 November 2010] [11:32:29] &lt;mato&gt;   good question, no idea</div>
<div class="line">[Monday 01 November 2010] [11:32:30] &lt;<a href="#id73"><span class="problematic" id="id74">sustrik_</span></a>&gt;       even set can return EINTR</div>
<div class="line">[Monday 01 November 2010] [11:32:53] &lt;mato&gt;   if ::send() is interrupted?</div>
<div class="line">[Monday 01 November 2010] [11:32:57] &lt;<a href="#id75"><span class="problematic" id="id76">sustrik_</span></a>&gt;       yes</div>
<div class="line">[Monday 01 November 2010] [11:33:07] &lt;mato&gt;   right, so all of those need to be int</div>
<div class="line">[Monday 01 November 2010] [11:33:11] &lt;<a href="#id77"><span class="problematic" id="id78">sustrik_</span></a>&gt;       ack</div>
<div class="line">[Monday 01 November 2010] [11:33:16] &lt;mato&gt;   i will change that</div>
<div class="line">[Monday 01 November 2010] [11:36:16] &lt;<a href="#id79"><span class="problematic" id="id80">sustrik_</span></a>&gt;       ok, I/O thread handles EINTR correctly (restarts the operation)</div>
<div class="line">[Monday 01 November 2010] [11:37:16] &lt;mato&gt;   ok, but what about signaler_t::send()?</div>
<div class="line">[Monday 01 November 2010] [11:37:22] &lt;mato&gt;   that method does not return anything...</div>
<div class="line">[Monday 01 November 2010] [11:37:38] &lt;mato&gt;   so what is it supposed to do if event_t::set() returns EINTR? restart it?</div>
<div class="line">[Monday 01 November 2010] [11:39:48] &lt;<a href="#id81"><span class="problematic" id="id82">sustrik_</span></a>&gt;       hmm</div>
<div class="line">[Monday 01 November 2010] [11:40:06] &lt;<a href="#id83"><span class="problematic" id="id84">sustrik_</span></a>&gt;       the problem is that by restarting you loose the signal</div>
<div class="line">[Monday 01 November 2010] [11:40:37] &lt;<a href="#id85"><span class="problematic" id="id86">sustrik_</span></a>&gt;       but the signal handling is not 100% efficient anyway</div>
<div class="line">[Monday 01 November 2010] [11:40:47] &lt;<a href="#id87"><span class="problematic" id="id88">sustrik_</span></a>&gt;       so yes, we can just restart the send</div>
<div class="line">[Monday 01 November 2010] [11:41:27] &lt;pieterh&gt;        sustrik: you have a second?</div>
<div class="line">[Monday 01 November 2010] [11:41:32] &lt;pieterh&gt;        question on code structure</div>
<div class="line">[Monday 01 November 2010] [11:41:56] &lt;pieterh&gt;        why does select.cpp do a bunch of stuff for windows, and then invoke select.hpp that does the same?</div>
<div class="line">[Monday 01 November 2010] [11:42:17] &lt;pieterh&gt;        afaics select.hpp isn&#8217;t used by any other code</div>
<div class="line">[Monday 01 November 2010] [11:42:48] &lt;<a href="#id89"><span class="problematic" id="id90">sustrik_</span></a>&gt;       pieterh: historic reasons</div>
<div class="line">[Monday 01 November 2010] [11:43:04] &lt;pieterh&gt;        ?</div>
<div class="line">[Monday 01 November 2010] [11:43:14] &lt;pieterh&gt;        i mean, is this by design or just bogus?</div>
<div class="line">[Monday 01 November 2010] [11:43:19] &lt;<a href="#id91"><span class="problematic" id="id92">sustrik_</span></a>&gt;       the poll algo classes should be refactored</div>
<div class="line">[Monday 01 November 2010] [11:43:24] &lt;<a href="#id93"><span class="problematic" id="id94">sustrik_</span></a>&gt;       bogus</div>
<div class="line">[Monday 01 November 2010] [11:43:46] &lt;pieterh&gt;        ok... cause there&#8217;s duplicate code but it&#8217;s not quite the same in both cases</div>
<div class="line">[Monday 01 November 2010] [11:43:54] &lt;pieterh&gt;        actually it&#8217;s worse, there&#8217;s also windows.hpp that does the same again</div>
<div class="line">[Monday 01 November 2010] [11:44:26] &lt;<a href="#id95"><span class="problematic" id="id96">sustrik_</span></a>&gt;       i know, but it&#8217;s hard to change without breaking anything</div>
<div class="line">[Monday 01 November 2010] [11:44:27] &lt;mato&gt;   there is much historical weird stuff to clean up wrt windows.wpp and the bits that depend on it</div>
<div class="line">[Monday 01 November 2010] [11:44:43] &lt;mato&gt;   but, as sustrik says, it&#8217;s all pretty fragile, so if it ain&#8217;t broke, don&#8217;t fix it</div>
<div class="line">[Monday 01 November 2010] [11:44:46] &lt;pieterh&gt;        well, select.hpp is only used in one place</div>
<div class="line">[Monday 01 November 2010] [11:44:48] &lt;pieterh&gt;        and it is broken</div>
<div class="line">[Monday 01 November 2010] [11:45:00] &lt;pieterh&gt;        and I do intend to fix it, the FD_SETSIZE issue has been there for years and should go</div>
<div class="line">[Monday 01 November 2010] [11:45:16] &lt;<a href="#id97"><span class="problematic" id="id98">sustrik_</span></a>&gt;       sure, send the patch</div>
<div class="line">[Monday 01 November 2010] [11:45:22] &lt;mato&gt;   oh dear, not that again</div>
<div class="line">[Monday 01 November 2010] [11:45:36] &lt;pieterh&gt;        well, my question is whether you really want me to &#8216;fix&#8217; three places that are all actually the same?</div>
<div class="line">[Monday 01 November 2010] [11:45:39] &lt;mato&gt;   FD_SETSIZE is a problem because zmq.h depends on winsock for SOCKET *</div>
<div class="line">[Monday 01 November 2010] [11:45:47] &lt;pieterh&gt;        mato: please</div>
<div class="line">[Monday 01 November 2010] [11:45:53] &lt;pieterh&gt;        we do understand the case pretty well</div>
<div class="line">[Monday 01 November 2010] [11:46:07] &lt;pieterh&gt;        the problem here is just 0MQ&#8217;s code, not the fix in question</div>
<div class="line">[Monday 01 November 2010] [11:46:12] &lt;mato&gt;   sure</div>
<div class="line">[Monday 01 November 2010] [11:46:15] &lt;pieterh&gt;        winsock.h is included 4 times</div>
<div class="line">[Monday 01 November 2010] [11:46:20] &lt;pieterh&gt;        that is the problem</div>
<div class="line">[Monday 01 November 2010] [11:46:30] &lt;<a href="#id99"><span class="problematic" id="id100">sustrik_</span></a>&gt;       i don&#8217;t know about FD_SETSIZE, but if there&#8217;s a bug in select.cpp, just fix it and send the patch</div>
<div class="line">[Monday 01 November 2010] [11:46:34] &lt;mato&gt;   if you can make all the code work <em>correctly</em> <em>and</em> avoid redefining an <em>application&#8217;s</em> view of FD_SETSIZE, go for it</div>
<div class="line">[Monday 01 November 2010] [11:46:47] &lt;pieterh&gt;        mato: we&#8217;ve been over this</div>
<div class="line">[Monday 01 November 2010] [11:47:06] &lt;pieterh&gt;        code that calls a library must defacto use that library&#8217;s value for FD_SETSIZE</div>
<div class="line">[Monday 01 November 2010] [11:47:15] &lt;mato&gt;   pieterh: I will not accept any patch that redefines FD_SETSIZE of an <em>application</em> including zmq.h</div>
<div class="line">[Monday 01 November 2010] [11:47:22] &lt;mato&gt;   for reasons that I have explained</div>
<div class="line">[Monday 01 November 2010] [11:47:30] &lt;pieterh&gt;        you&#8217;ve not explained, and/or have not understood</div>
<div class="line">[Monday 01 November 2010] [11:47:43] &lt;mato&gt;   zmq.h is the <em>API</em> header</div>
<div class="line">[Monday 01 November 2010] [11:47:51] &lt;pieterh&gt;        every library that wraps select() must define a value for FD_SETSIZE</div>
<div class="line">[Monday 01 November 2010] [11:47:53] &lt;mato&gt;   it has no business changing the <em>application&#8217;s</em> view of FD_SETSIZE</div>
<div class="line">[Monday 01 November 2010] [11:48:00] &lt;mato&gt;   yes, sure</div>
<div class="line">[Monday 01 November 2010] [11:48:03] &lt;pieterh&gt;        lll</div>
<div class="line">[Monday 01 November 2010] [11:48:08] &lt;mato&gt;   i have no problem with that</div>
<div class="line">[Monday 01 November 2010] [11:48:10] &lt;pieterh&gt;        it changes the API&#8217;s definition</div>
<div class="line">[Monday 01 November 2010] [11:48:21] &lt;pieterh&gt;        this is standard stuff</div>
<div class="line">[Monday 01 November 2010] [11:48:31] &lt;pieterh&gt;        now, including zmq.h magically sets FD_SETSIZE to 64</div>
<div class="line">[Monday 01 November 2010] [11:48:40] &lt;pieterh&gt;        which is not a feature, but a bug</div>
<div class="line">[Monday 01 November 2010] [11:48:53] &lt;mato&gt;   no it doesn&#8217;t, it leaves it at whatever the default is</div>
<div class="line">[Monday 01 November 2010] [11:48:57] &lt;pieterh&gt;        no it doesn&#8217;t</div>
<div class="line">[Monday 01 November 2010] [11:49:02] &lt;pieterh&gt;        winsock.h defines it</div>
<div class="line">[Monday 01 November 2010] [11:49:03] &lt;mato&gt;   bah</div>
<div class="line">[Monday 01 November 2010] [11:49:05] &lt;pieterh&gt;        unless it&#8217;s already defined</div>
<div class="line">[Monday 01 November 2010] [11:49:10] &lt;mato&gt;   exactly</div>
<div class="line">[Monday 01 November 2010] [11:49:21] &lt;pieterh&gt;        well... did you think I&#8217;d ignore a previous definition?</div>
<div class="line">[Monday 01 November 2010] [11:49:24] &lt;pieterh&gt;        /  Raise max sockets from default of 64 to more usable value</div>
<div class="line">[Monday 01 November 2010] [11:49:24] &lt;pieterh&gt;        /  Must be consistent in any code that shares FD sets</div>
<div class="line">[Monday 01 November 2010] [11:49:24] &lt;pieterh&gt;        #ifndef FD_SETSIZE</div>
<div class="line">[Monday 01 November 2010] [11:49:24] &lt;pieterh&gt;        #define FD_SETSIZE   1024</div>
<div class="line">[Monday 01 November 2010] [11:49:24] &lt;pieterh&gt;        #endif</div>
<div class="line">[Monday 01 November 2010] [11:49:32] &lt;<a href="#id101"><span class="problematic" id="id102">sustrik_</span></a>&gt;       afaiu, the problem is that 0mq and the application have to have same value of FD_SETSIZE to work well</div>
<div class="line">[Monday 01 November 2010] [11:49:40] &lt;<a href="#id103"><span class="problematic" id="id104">sustrik_</span></a>&gt;       right?</div>
<div class="line">[Monday 01 November 2010] [11:49:45] &lt;pieterh&gt;        it&#8217;s just an array max for the select call</div>
<div class="line">[Monday 01 November 2010] [11:49:47] &lt;mato&gt;   no, i don&#8217;t think so</div>
<div class="line">[Monday 01 November 2010] [11:50:03] &lt;pieterh&gt;        so any code that shares fdsets must agree on the max</div>
<div class="line">[Monday 01 November 2010] [11:50:04] &lt;mato&gt;   <a href="#id105"><span class="problematic" id="id106">sustrik_</span></a>: libzmq.dll&#8217;s FD_SETSIZE AFAICT has nothing to do with the app&#8217;s FD_SETSIZE</div>
<div class="line">[Monday 01 November 2010] [11:50:20] &lt;pieterh&gt;        mato: there is no &#8216;app&#8217;s FD_SETSIZE&#8217;</div>
<div class="line">[Monday 01 November 2010] [11:50:33] &lt;mato&gt;   huh?</div>
<div class="line">[Monday 01 November 2010] [11:50:33] &lt;pieterh&gt;        every select call has an FD_SETSIZE</div>
<div class="line">[Monday 01 November 2010] [11:50:39] &lt;pieterh&gt;        it&#8217;s not per application or per binary</div>
<div class="line">[Monday 01 November 2010] [11:50:43] &lt;pieterh&gt;        it&#8217;s per select() call...</div>
<div class="line">[Monday 01 November 2010] [11:50:45] &lt;mato&gt;   sure</div>
<div class="line">[Monday 01 November 2010] [11:50:47] &lt;mato&gt;   my point is...</div>
<div class="line">[Monday 01 November 2010] [11:51:02] &lt;mato&gt;   what if you have an existing application which is mixing normal sockets and zmq code</div>
<div class="line">[Monday 01 November 2010] [11:51:15] &lt;mato&gt;   including zmq.h should not go and magically change that app&#8217;s FD_SETSIZE...</div>
<div class="line">[Monday 01 November 2010] [11:51:21] &lt;pieterh&gt;        (a) that is 1% of the case where as &#8216;normal 0MQ apps&#8217; are 99% of the case</div>
<div class="line">[Monday 01 November 2010] [11:51:35] &lt;pieterh&gt;        (b) you can set your own FD_SETSIZE beforehand</div>
<div class="line">[Monday 01 November 2010] [11:51:45] &lt;pieterh&gt;        (c) you need to recompile ALL your code then to match</div>
<div class="line">[Monday 01 November 2010] [11:51:47] &lt;pieterh&gt;        including 0MQ</div>
<div class="line">[Monday 01 November 2010] [11:51:52] &lt;pieterh&gt;        that&#8217;s pretty straight-forward</div>
<div class="line">[Monday 01 November 2010] [11:52:02] &lt;mato&gt;   does it really work that way? (c) included?</div>
<div class="line">[Monday 01 November 2010] [11:52:05] &lt;pieterh&gt;        what is not acceptable is &#8220;install 0MQ, build app, watch it break at 64 sockets&#8217;</div>
<div class="line">[Monday 01 November 2010] [11:52:08] &lt;pieterh&gt;        yes mato</div>
<div class="line">[Monday 01 November 2010] [11:52:17] &lt;pieterh&gt;        define the macro in your project, rebuild</div>
<div class="line">[Monday 01 November 2010] [11:52:19] &lt;pieterh&gt;        period</div>
<div class="line">[Monday 01 November 2010] [11:52:29] &lt;pieterh&gt;        i&#8217;ve been doing this for 15 years or so with Xitami / SFL /...</div>
<div class="line">[Monday 01 November 2010] [11:52:48] &lt;mato&gt;   ok, ok, i believe you</div>
<div class="line">[Monday 01 November 2010] [11:53:04] &lt;mato&gt;   i was just trying to avoid zmq.h doing anything &#8220;surprising&#8221;</div>
<div class="line">[Monday 01 November 2010] [11:53:08] &lt;pieterh&gt;        the _only_ difficulty here is that 0MQ includes winsock 4 times in different places</div>
<div class="line">[Monday 01 November 2010] [11:53:13] &lt;pieterh&gt;        which is... less than elegant</div>
<div class="line">[Monday 01 November 2010] [11:53:19] &lt;mato&gt;   yes, that needs to be refactored</div>
<div class="line">[Monday 01 November 2010] [11:53:35] &lt;mato&gt;   oh</div>
<div class="line">[Monday 01 November 2010] [11:53:42] &lt;mato&gt;   there is one other complexity</div>
<div class="line">[Monday 01 November 2010] [11:53:48] &lt;mato&gt;   when building zmq on windows</div>
<div class="line">[Monday 01 November 2010] [11:53:51] &lt;pieterh&gt;        yes?</div>
<div class="line">[Monday 01 November 2010] [11:54:10] &lt;mato&gt;   FD_SETSIZE must be defined correctly the 1st time winsock.h is included in the app</div>
<div class="line">[Monday 01 November 2010] [11:54:18] &lt;pieterh&gt;        there is no &#8216;app&#8217;</div>
<div class="line">[Monday 01 November 2010] [11:54:21] &lt;mato&gt;   which for zmq basically means changing all those places</div>
<div class="line">[Monday 01 November 2010] [11:54:23] &lt;pieterh&gt;        you keep speaking of &#8216;apps&#8217;</div>
<div class="line">[Monday 01 November 2010] [11:54:34] &lt;mato&gt;   i&#8217;m sorry, zeromq <em>library</em></div>
<div class="line">[Monday 01 November 2010] [11:54:38] &lt;pieterh&gt;        every source file</div>
<div class="line">[Monday 01 November 2010] [11:54:46] &lt;pieterh&gt;        is compiled with a certain value for FD_SETSIZE</div>
<div class="line">[Monday 01 November 2010] [11:54:54] &lt;pieterh&gt;        winsock.h is included 4 times in different places</div>
<div class="line">[Monday 01 November 2010] [11:55:09] &lt;pieterh&gt;        some are obviously redundant (select.cpp, select.hpp)</div>
<div class="line">[Monday 01 November 2010] [11:55:12] &lt;pieterh&gt;        others are less so</div>
<div class="line">[Monday 01 November 2010] [11:55:29] &lt;<a href="#id107"><span class="problematic" id="id108">sustrik_</span></a>&gt;       can someone explain what FD_SETSIZE actually affects? if every call to select can have different FD_SETSIZE why not define it to 1024 in our cpp files and leave the header alone?</div>
<div class="line">[Monday 01 November 2010] [11:55:45] &lt;pieterh&gt;        <a href="#id109"><span class="problematic" id="id110">sustrik_</span></a>, it tells the win32 library how large the fdset arrays are</div>
<div class="line">[Monday 01 November 2010] [11:56:02] &lt;<a href="#id111"><span class="problematic" id="id112">sustrik_</span></a>&gt;       and can it differ throughout the program?</div>
<div class="line">[Monday 01 November 2010] [11:56:08] &lt;mato&gt;   no one knows :-)</div>
<div class="line">[Monday 01 November 2010] [11:56:11] &lt;pieterh&gt;        if you include winsock.h or winsock2.h without defining this, it sets a value of 64</div>
<div class="line">[Monday 01 November 2010] [11:56:23] &lt;pieterh&gt;        so each source file can have different values compiled into it</div>
<div class="line">[Monday 01 November 2010] [11:56:39] &lt;pieterh&gt;        winsock.h passes the macro value to the win32 functions</div>
<div class="line">[Monday 01 November 2010] [11:56:52] &lt;pieterh&gt;        so it can differ in every call to select()</div>
<div class="line">[Monday 01 November 2010] [11:57:05] &lt;pieterh&gt;        does that make sense?</div>
<div class="line">[Monday 01 November 2010] [11:57:23] &lt;mato&gt;   if that&#8217;s how it actually works, then yes, i think so</div>
<div class="line">[Monday 01 November 2010] [11:57:24] &lt;<a href="#id113"><span class="problematic" id="id114">sustrik_</span></a>&gt;       then why not go for defining FD_SETSIZE only for select.cpp and zmq.cpp?</div>
<div class="line">[Monday 01 November 2010] [11:57:37] &lt;pieterh&gt;        sustrik: if those are the only places you call select(), yes</div>
<div class="line">[Monday 01 November 2010] [11:57:45] &lt;pieterh&gt;        in fact only in select.cpp then</div>
<div class="line">[Monday 01 November 2010] [11:57:52] &lt;mato&gt;   zmq.cpp also calls select()</div>
<div class="line">[Monday 01 November 2010] [11:57:55] &lt;<a href="#id115"><span class="problematic" id="id116">sustrik_</span></a>&gt;       yes</div>
<div class="line">[Monday 01 November 2010] [11:57:57] &lt;pieterh&gt;        right</div>
<div class="line">[Monday 01 November 2010] [11:57:59] &lt;mato&gt;   for the zmq_poll() implementation</div>
<div class="line">[Monday 01 November 2010] [11:58:11]   * pieterh doesn&#8217;t understand why this is not abstracted</div>
<div class="line">[Monday 01 November 2010] [11:58:39] &lt;pieterh&gt;        ok, i&#8217;ll make a patch and ask for volunteers to test that under win32</div>
<div class="line">[Monday 01 November 2010] [11:58:46] &lt;pieterh&gt;        if it&#8217;s stable we can include it</div>
<div class="line">[Monday 01 November 2010] [11:58:53] &lt;pieterh&gt;        zmq.h and select.cpp only then</div>
<div class="line">[Monday 01 November 2010] [11:59:08] &lt;mato&gt;   zmq.h?</div>
<div class="line">[Monday 01 November 2010] [11:59:09] &lt;<a href="#id117"><span class="problematic" id="id118">sustrik_</span></a>&gt;       noo</div>
<div class="line">[Monday 01 November 2010] [11:59:12] &lt;mato&gt;   zmq.cpp you mean</div>
<div class="line">[Monday 01 November 2010] [11:59:51] &lt;pieterh&gt;        well, it has to be defined _before_ including winsock.h</div>
<div class="line">[Monday 01 November 2010] [11:59:57] &lt;pieterh&gt;        that happens in zmq.h</div>
<div class="line">[Monday 01 November 2010] [11:59:57] &lt;mato&gt;   yes, so?</div>
<div class="line">[Monday 01 November 2010] [12:00:08] &lt;pieterh&gt;        so you want me to add this code to the very start of zmq.cpp?</div>
<div class="line">[Monday 01 November 2010] [12:00:11] &lt;pieterh&gt;        wow</div>
<div class="line">[Monday 01 November 2010] [12:00:12] &lt;mato&gt;   then put the #define in zmq.cpp before it include anything</div>
<div class="line">[Monday 01 November 2010] [12:00:13] &lt;mato&gt;   yes</div>
<div class="line">[Monday 01 November 2010] [12:00:15] &lt;pieterh&gt;        no way</div>
<div class="line">[Monday 01 November 2010] [12:00:23] &lt;pieterh&gt;        that&#8217;s so ugly</div>
<div class="line">[Monday 01 November 2010] [12:00:33] &lt;mato&gt;   the whole FD_SETSIZE thing is ugly</div>
<div class="line">[Monday 01 November 2010] [12:00:35] &lt;mato&gt;   not our fault</div>
<div class="line">[Monday 01 November 2010] [12:00:38] &lt;pieterh&gt;        &#8216;here&#8217;s our global header file but wait, some magic stuff happens before that!&#8217;</div>
<div class="line">[Monday 01 November 2010] [12:00:48] &lt;pieterh&gt;        no, it&#8217;s the fault of this code structure</div>
<div class="line">[Monday 01 November 2010] [12:00:54] &lt;pieterh&gt;        it should be done in windows.hpp</div>
<div class="line">[Monday 01 November 2010] [12:01:10] &lt;pieterh&gt;        or somewhere for &#8216;include all random windows stuff&#8217;</div>
<div class="line">[Monday 01 November 2010] [12:01:19] &lt;mato&gt;   yes, but not in zmq.h</div>
<div class="line">[Monday 01 November 2010] [12:01:29] &lt;mato&gt;   that&#8217;s the only point i&#8217;m making, pieter</div>
<div class="line">[Monday 01 November 2010] [12:01:37] &lt;mato&gt;   do it any way you like, just not in zmq.h please</div>
<div class="line">[Monday 01 November 2010] [12:01:49] &lt;<a href="#id119"><span class="problematic" id="id120">sustrik_</span></a>&gt;       windows.hpp is actually a nice place to set it</div>
<div class="line">[Monday 01 November 2010] [12:01:51] &lt;mato&gt;   if you clean up the mess with windows.hpp while you&#8217;re at it, so much the better</div>
<div class="line">[Monday 01 November 2010] [12:01:52] &lt;pieterh&gt;        you&#8217;re not making a point, you&#8217;re just imposing an arbitrary limitation</div>
<div class="line">[Monday 01 November 2010] [12:02:00] &lt;mato&gt;   it&#8217;s not arbitrary</div>
<div class="line">[Monday 01 November 2010] [12:02:01] &lt;<a href="#id121"><span class="problematic" id="id122">sustrik_</span></a>&gt;       as it&#8217;s included from all 0mq compilation units</div>
<div class="line">[Monday 01 November 2010] [12:02:04] &lt;<a href="#id123"><span class="problematic" id="id124">sustrik_</span></a>&gt;       but not from zmq.h</div>
<div class="line">[Monday 01 November 2010] [12:02:06] &lt;pieterh&gt;        it should be _consistent_ for the whole library</div>
<div class="line">[Monday 01 November 2010] [12:02:15] &lt;pieterh&gt;        and it should be easy to override from the project file</div>
<div class="line">[Monday 01 November 2010] [12:02:16] &lt;pieterh&gt;        period</div>
<div class="line">[Monday 01 November 2010] [12:02:44] &lt;pieterh&gt;        look, I&#8217;m willing to spend some effort cleaning this up, but not to navigate random opinions</div>
<div class="line">[Monday 01 November 2010] [12:02:47] &lt;mato&gt;   <a href="#id125"><span class="problematic" id="id126">sustrik_</span></a>: do you understand why making the change in zmq.h seems like a bad idea? or am I alone in this?</div>
<div class="line">[Monday 01 November 2010] [12:02:50] &lt;pieterh&gt;        the windows build of 0MQ is broken</div>
<div class="line">[Monday 01 November 2010] [12:02:55] &lt;<a href="#id127"><span class="problematic" id="id128">sustrik_</span></a>&gt;       mato: i do</div>
<div class="line">[Monday 01 November 2010] [12:02:55] &lt;pieterh&gt;        64 sockets is not realistic, period</div>
<div class="line">[Monday 01 November 2010] [12:03:05] &lt;pieterh&gt;        you are both wrong, then</div>
<div class="line">[Monday 01 November 2010] [12:03:14] &lt;<a href="#id129"><span class="problematic" id="id130">sustrik_</span></a>&gt;       pieterh: try putting it into windows.hpp, that should work ok</div>
<div class="line">[Monday 01 November 2010] [12:03:20] &lt;pieterh&gt;        any application that mixes tcp and 0mq must in any case define a FD_SETSIZE</div>
<div class="line">[Monday 01 November 2010] [12:03:23] &lt;pieterh&gt;        externally</div>
<div class="line">[Monday 01 November 2010] [12:03:26] &lt;pieterh&gt;        in its project file</div>
<div class="line">[Monday 01 November 2010] [12:03:39] &lt;pieterh&gt;        this applies to any library that wraps select()</div>
<div class="line">[Monday 01 November 2010] [12:03:55] &lt;pieterh&gt;        sustrik: nope, windows.hpp is not used by select.cpp for instance</div>
<div class="line">[Monday 01 November 2010] [12:04:18] &lt;<a href="#id131"><span class="problematic" id="id132">sustrik_</span></a>&gt;       it should</div>
<div class="line">[Monday 01 November 2010] [12:04:22] &lt;pieterh&gt;        yeah, it should</div>
<div class="line">[Monday 01 November 2010] [12:04:29] &lt;pieterh&gt;        hence my original question about the code structure</div>
<div class="line">[Monday 01 November 2010] [12:04:41] &lt;pieterh&gt;        the platform code shouldn&#8217;t be spread out like that IMO</div>
<div class="line">[Monday 01 November 2010] [12:04:52] &lt;<a href="#id133"><span class="problematic" id="id134">sustrik_</span></a>&gt;       historic reasons</div>
<div class="line">[Monday 01 November 2010] [12:04:58] &lt;pieterh&gt;        sorry, poor excuse :-)</div>
<div class="line">[Monday 01 November 2010] [12:05:06] &lt;<a href="#id135"><span class="problematic" id="id136">sustrik_</span></a>&gt;       well, fix it then</div>
<div class="line">[Monday 01 November 2010] [12:05:08] &lt;mato&gt;   exactly</div>
<div class="line">[Monday 01 November 2010] [12:05:12] &lt;mato&gt;   stop bitching about it</div>
<div class="line">[Monday 01 November 2010] [12:05:14] &lt;mato&gt;   and fix it</div>
<div class="line">[Monday 01 November 2010] [12:05:21] &lt;pieterh&gt;        that&#8217;s all I was asking for</div>
<div class="line">[Monday 01 November 2010] [12:05:39] &lt;mato&gt;   all i&#8217;m saying, and sustrik is agreeing, is don&#8217;t change FD_SETSIZE in zmq.h</div>
<div class="line">[Monday 01 November 2010] [12:05:46] &lt;mato&gt;   and all of this <em>can</em> be done without that</div>
<div class="line">[Monday 01 November 2010] [12:05:56] &lt;pieterh&gt;        i&#8217;m curious to see how you will do that, mato</div>
<div class="line">[Monday 01 November 2010] [12:06:21] &lt;mato&gt;   ?</div>
<div class="line">[Monday 01 November 2010] [12:06:27] &lt;pieterh&gt;        since zmq.h includes winsock.h</div>
<div class="line">[Monday 01 November 2010] [12:06:34] &lt;pieterh&gt;        well, since you know best, I step back</div>
<div class="line">[Monday 01 November 2010] [12:06:45] &lt;mato&gt;   yes, so you make sure FD_SETSIZE is defined before zmq.h is included in the relevant places</div>
<div class="line">[Monday 01 November 2010] [12:07:05] &lt;pieterh&gt;        that IMO makes the code dirtier and I won&#8217;t do that, sorry</div>
<div class="line">[Monday 01 November 2010] [12:07:16] &lt;pieterh&gt;        zmq.h is the system-wide header file</div>
<div class="line">[Monday 01 November 2010] [12:07:23] &lt;<a href="#id137"><span class="problematic" id="id138">sustrik_</span></a>&gt;       afaiu, each compilation unit has to have a consistent value of FD_SETSIZE</div>
<div class="line">[Monday 01 November 2010] [12:07:28] &lt;mato&gt;   it&#8217;s not the syste-wide header file</div>
<div class="line">[Monday 01 November 2010] [12:07:37] &lt;mato&gt;   it&#8217;s the exported API header file</div>
<div class="line">[Monday 01 November 2010] [12:07:41] &lt;<a href="#id139"><span class="problematic" id="id140">sustrik_</span></a>&gt;       but there&#8217;s no requirement that different compilation units have to have the same value</div>
<div class="line">[Monday 01 November 2010] [12:07:47] &lt;pieterh&gt;        then it should absolutely not call winsock.h</div>
<div class="line">[Monday 01 November 2010] [12:07:58] &lt;pieterh&gt;        because today it effectively sets FD_SETSIZE to 64</div>
<div class="line">[Monday 01 November 2010] [12:08:00] &lt;pieterh&gt;        don&#8217;t you get this?</div>
<div class="line">[Monday 01 November 2010] [12:08:12] &lt;pieterh&gt;        zmq.h already makes a mess for any app</div>
<div class="line">[Monday 01 November 2010] [12:08:18] &lt;mato&gt;   <em>that</em> is an entirely different problem</div>
<div class="line">[Monday 01 November 2010] [12:08:29] &lt;pieterh&gt;        ?</div>
<div class="line">[Monday 01 November 2010] [12:08:51] &lt;mato&gt;   the reason it&#8217;s included winsock.h is...</div>
<div class="line">[Monday 01 November 2010] [12:09:09] &lt;mato&gt;   that the zmq_pollitem_t definition needs a type for &#8220;OS sockets&#8221;</div>
<div class="line">[Monday 01 November 2010] [12:09:19] &lt;mato&gt;   so it needs access to SOCKET</div>
<div class="line">[Monday 01 November 2010] [12:09:29] &lt;<a href="#id141"><span class="problematic" id="id142">sustrik_</span></a>&gt;       yeah, that&#8217;s a really annoying problem</div>
<div class="line">[Monday 01 November 2010] [12:09:37] &lt;pieterh&gt;        it sets FD_SETSIZE to 64</div>
<div class="line">[Monday 01 November 2010] [12:09:41] &lt;<a href="#id143"><span class="problematic" id="id144">sustrik_</span></a>&gt;       in reality SOCKET is void*</div>
<div class="line">[Monday 01 November 2010] [12:09:52] &lt;pieterh&gt;        that is a serious fault</div>
<div class="line">[Monday 01 November 2010] [12:09:58] &lt;pieterh&gt;        i&#8217;m proposing to make it a less serious faulyt</div>
<div class="line">[Monday 01 November 2010] [12:09:59] &lt;pieterh&gt;        <a href="#id1"><span class="problematic" id="id2">*</span></a>fault</div>
<div class="line">[Monday 01 November 2010] [12:10:12] &lt;mato&gt;   no you&#8217;re not</div>
<div class="line">[Monday 01 November 2010] [12:10:25] &lt;<a href="#id145"><span class="problematic" id="id146">sustrik_</span></a>&gt;       what about using void* instead of SOCKET</div>
<div class="line">[Monday 01 November 2010] [12:10:37] &lt;mato&gt;   well, would that work?</div>
<div class="line">[Monday 01 November 2010] [12:10:45] &lt;<a href="#id147"><span class="problematic" id="id148">sustrik_</span></a>&gt;       it&#8217;s not nice but all the other alternatives are even worse</div>
<div class="line">[Monday 01 November 2010] [12:10:49] &lt;pieterh&gt;        &#8220;zmq.h should not magically go and change the app&#8217;s FD_SETSIZE&#8221;:</div>
<div class="line">[Monday 01 November 2010] [12:10:57] &lt;pieterh&gt;        but that&#8217;s what it does today</div>
<div class="line">[Monday 01 November 2010] [12:11:00] &lt;<a href="#id149"><span class="problematic" id="id150">sustrik_</span></a>&gt;       i think if holds for all win platforms</div>
<div class="line">[Monday 01 November 2010] [12:11:06] &lt;<a href="#id151"><span class="problematic" id="id152">sustrik_</span></a>&gt;       hard to check though</div>
<div class="line">[Monday 01 November 2010] [12:11:14] &lt;mato&gt;   well, there&#8217;s an easy way to check actually</div>
<div class="line">[Monday 01 November 2010] [12:11:16] &lt;pieterh&gt;        look, there are several problems here</div>
<div class="line">[Monday 01 November 2010] [12:11:22] &lt;<a href="#id153"><span class="problematic" id="id154">sustrik_</span></a>&gt;       mato: how?</div>
<div class="line">[Monday 01 November 2010] [12:11:24] &lt;pieterh&gt;        - windows code is spread out through multiple header files</div>
<div class="line">[Monday 01 November 2010] [12:11:32] &lt;mato&gt;   <a href="#id155"><span class="problematic" id="id156">sustrik_</span></a>: in zmq_init, assert (sizeof (SOCKET) == sizeof (void <a href="#id3"><span class="problematic" id="id4">*</span></a>))</div>
<div class="line">[Monday 01 November 2010] [12:11:35] &lt;pieterh&gt;        - select() is used with bogus limit of 64</div>
<div class="line">[Monday 01 November 2010] [12:11:43] &lt;<a href="#id157"><span class="problematic" id="id158">sustrik_</span></a>&gt;       :)</div>
<div class="line">[Monday 01 November 2010] [12:11:47] &lt;mato&gt;   <a href="#id159"><span class="problematic" id="id160">sustrik_</span></a>: that would do for starters...</div>
<div class="line">[Monday 01 November 2010] [12:11:59] &lt;<a href="#id161"><span class="problematic" id="id162">sustrik_</span></a>&gt;       ok, that solves the problem, no?</div>
<div class="line">[Monday 01 November 2010] [12:12:10] &lt;mato&gt;   it would seem so, yes</div>
<div class="line">[Monday 01 November 2010] [12:12:17] &lt;pieterh&gt;        yes, that solves zmq.h</div>
<div class="line">[Monday 01 November 2010] [12:12:49] &lt;<a href="#id163"><span class="problematic" id="id164">sustrik_</span></a>&gt;       when we have that</div>
<div class="line">[Monday 01 November 2010] [12:12:57] &lt;pieterh&gt;        if zmq.h no longer whacks FD_SETSIZE then it can be safely set per source file where needed</div>
<div class="line">[Monday 01 November 2010] [12:13:00] &lt;mato&gt;   <a href="#id165"><span class="problematic" id="id166">sustrik_</span></a>: in fact, you can add a compile-time dummy check</div>
<div class="line">[Monday 01 November 2010] [12:13:04] &lt;mato&gt;   <a href="#id167"><span class="problematic" id="id168">sustrik_</span></a>: even better</div>
<div class="line">[Monday 01 November 2010] [12:13:17] &lt;<a href="#id169"><span class="problematic" id="id170">sustrik_</span></a>&gt;       good</div>
<div class="line">[Monday 01 November 2010] [12:13:19] &lt;mato&gt;   <a href="#id171"><span class="problematic" id="id172">sustrik_</span></a>: SOCKET foo; void <a href="#id5"><span class="problematic" id="id6">*</span></a>bar; bar = foo</div>
<div class="line">[Monday 01 November 2010] [12:13:23] &lt;mato&gt;   <a href="#id173"><span class="problematic" id="id174">sustrik_</span></a>: or something like that</div>
<div class="line">[Monday 01 November 2010] [12:13:42] &lt;<a href="#id175"><span class="problematic" id="id176">sustrik_</span></a>&gt;       ok, however, let&#8217;s do this after 2.1.0 release</div>
<div class="line">[Monday 01 November 2010] [12:14:06] &lt;<a href="#id177"><span class="problematic" id="id178">sustrik_</span></a>&gt;       it can break 0mq on some win systems (if we are wrong about void*)</div>
<div class="line">[Monday 01 November 2010] [12:14:15] &lt;mato&gt;   2.1.0 is development</div>
<div class="line">[Monday 01 November 2010] [12:14:20] &lt;mato&gt;   it shoudn&#8217;t matter too much</div>
<div class="line">[Monday 01 November 2010] [12:14:21] &lt;<a href="#id179"><span class="problematic" id="id180">sustrik_</span></a>&gt;       thus it would be good to have one functional dev release</div>
<div class="line">[Monday 01 November 2010] [12:14:36] &lt;mato&gt;   up to you</div>
<div class="line">[Monday 01 November 2010] [12:14:51] &lt;mato&gt;   anyway, looks like we have a sensible solution</div>
<div class="line">[Monday 01 November 2010] [12:14:57]   * mato gets back to the signaler</div>
<div class="line">[Monday 01 November 2010] [12:15:18] &lt;<a href="#id181"><span class="problematic" id="id182">sustrik_</span></a>&gt;       pieter: you can fix it on a topic branch</div>
<div class="line">[Monday 01 November 2010] [12:15:30] &lt;<a href="#id183"><span class="problematic" id="id184">sustrik_</span></a>&gt;       we can merge it in after 2.1.0 is out</div>
<div class="line">[Monday 01 November 2010] [12:17:21] &lt;pieterh&gt;        <a href="#id185"><span class="problematic" id="id186">sustrik_</span></a>, sure</div>
<div class="line">[Monday 01 November 2010] [12:17:32] &lt;pieterh&gt;        I submit a patch, do what you like with it :-)</div>
<div class="line">[Monday 01 November 2010] [12:20:01] &lt;pieterh&gt;        please tell me when you&#8217;ve removed the winsock.h call from zmq.h, then I&#8217;ll make the change</div>
<div class="line">[Monday 01 November 2010] [12:23:38] &lt;mato&gt;   <a href="#id187"><span class="problematic" id="id188">sustrik_</span></a>: fd_t is the canonical type used internally for sockets, right?</div>
<div class="line">[Monday 01 November 2010] [12:23:50] &lt;<a href="#id189"><span class="problematic" id="id190">sustrik_</span></a>&gt;       yes</div>
<div class="line">[Monday 01 November 2010] [12:23:50] &lt;mato&gt;   <a href="#id191"><span class="problematic" id="id192">sustrik_</span></a>: i.e. it&#8217;s SOCKET on windows and int everywhere else</div>
<div class="line">[Monday 01 November 2010] [12:29:53] &lt;<a href="#id193"><span class="problematic" id="id194">sustrik_</span></a>&gt;       mato: in zmq.h we are using _WIN32 to find out whether we are on windows or somewhere else</div>
<div class="line">[Monday 01 November 2010] [12:30:12] &lt;<a href="#id195"><span class="problematic" id="id196">sustrik_</span></a>&gt;       does that meen windows.h has to be included prior to zmq.h?</div>
<div class="line">[Monday 01 November 2010] [12:30:27] &lt;mato&gt;   <a href="#id197"><span class="problematic" id="id198">sustrik_</span></a>: _WIN32 should be defined by the compiler</div>
<div class="line">[Monday 01 November 2010] [12:30:33] &lt;<a href="#id199"><span class="problematic" id="id200">sustrik_</span></a>&gt;       ok</div>
<div class="line">[Monday 01 November 2010] [12:30:44] &lt;<a href="#id201"><span class="problematic" id="id202">sustrik_</span></a>&gt;       what abour win64 btw?</div>
<div class="line">[Monday 01 November 2010] [12:30:49] &lt;mato&gt;   i hope so anyway, otherwise it&#8217;s totally braindead</div>
<div class="line">[Monday 01 November 2010] [12:30:57] &lt;mato&gt;   _WIN32 just means &#8220;Win32 API&#8221;</div>
<div class="line">[Monday 01 November 2010] [12:31:02] &lt;<a href="#id203"><span class="problematic" id="id204">sustrik_</span></a>&gt;       i see</div>
<div class="line">[Monday 01 November 2010] [12:31:04] &lt;mato&gt;   irrelevant to x64 target</div>
<div class="line">[Monday 01 November 2010] [12:35:09] &lt;<a href="#id205"><span class="problematic" id="id206">sustrik_</span></a>&gt;       ok, i&#8217;ve checked it, MSVC does define _WIN32</div>
<div class="line">[Monday 01 November 2010] [12:35:12] &lt;<a href="#id207"><span class="problematic" id="id208">sustrik_</span></a>&gt;       good</div>
<div class="line">[Monday 01 November 2010] [12:35:27] &lt;<a href="#id209"><span class="problematic" id="id210">sustrik_</span></a>&gt;       hopefully, MinGW does the same thing</div>
<div class="line">[Monday 01 November 2010] [12:35:33] &lt;mato&gt;   it must</div>
<div class="line">[Monday 01 November 2010] [12:41:07] &lt;<a href="#id211"><span class="problematic" id="id212">sustrik_</span></a>&gt;       i&#8217;m checking what SOCKET actually is :(</div>
<div class="line">[Monday 01 November 2010] [12:41:17] &lt;mato&gt;   oh dear ... :-)</div>
<div class="line">[Monday 01 November 2010] [12:41:46] &lt;<a href="#id213"><span class="problematic" id="id214">sustrik_</span></a>&gt;       if _WIN64 is defined</div>
<div class="line">[Monday 01 November 2010] [12:42:13] &lt;<a href="#id215"><span class="problematic" id="id216">sustrik_</span></a>&gt;       it&#8217;s uinsigned __int64</div>
<div class="line">[Monday 01 November 2010] [12:42:18] &lt;<a href="#id217"><span class="problematic" id="id218">sustrik_</span></a>&gt;       otherwise it&#8217;s</div>
<div class="line">[Monday 01 November 2010] [12:42:38] &lt;<a href="#id219"><span class="problematic" id="id220">sustrik_</span></a>&gt;       __w64 unsigned int</div>
<div class="line">[Monday 01 November 2010] [12:42:44] &lt;<a href="#id221"><span class="problematic" id="id222">sustrik_</span></a>&gt;       whatever that means</div>
<div class="line">[Monday 01 November 2010] [12:48:35] &lt;pieterh&gt;        <a href="#id223"><span class="problematic" id="id224">sustrik_</span></a>, __w64 just means &#8220;this integer can be a pointer, safely&#8221;</div>
<div class="line">[Monday 01 November 2010] [12:48:59] &lt;pieterh&gt;        __w64 unsigned int on a 64-bit Windows box is the same as __int64</div>
<div class="line">[Monday 01 November 2010] [12:49:22] &lt;pieterh&gt;        &#8216;unsigned __int64&#8217;, sorry</div>
<div class="line">[Monday 01 November 2010] [13:16:51] &lt;mato&gt;   <a href="#id225"><span class="problematic" id="id226">sustrik_</span></a>: event_t::reset () should also be restarted automagically on EINTR in signaler_t::recv() ?</div>
<div class="line">[Monday 01 November 2010] [13:17:30] &lt;mato&gt;   <a href="#id227"><span class="problematic" id="id228">sustrik_</span></a>: or should it just drop out with EINTR?</div>
<div class="line">[Monday 01 November 2010] [13:19:23] &lt;<a href="#id229"><span class="problematic" id="id230">sustrik_</span></a>&gt;       mato: if it&#8217;s hard you can drop it</div>
<div class="line">[Monday 01 November 2010] [13:19:35] &lt;mato&gt;   <a href="#id231"><span class="problematic" id="id232">sustrik_</span></a>: it&#8217;s not hard, i&#8217;m asking what it should do...</div>
<div class="line">[Monday 01 November 2010] [13:19:58] &lt;mato&gt;   <a href="#id233"><span class="problematic" id="id234">sustrik_</span></a>: what does &#8220;set&#8221; and &#8220;reset&#8221; mean, exactly?</div>
<div class="line">[Monday 01 November 2010] [13:20:04] &lt;mato&gt;   <a href="#id235"><span class="problematic" id="id236">sustrik_</span></a>: semantically...</div>
<div class="line">[Monday 01 November 2010] [13:21:30] &lt;mato&gt;   <a href="#id237"><span class="problematic" id="id238">sustrik_</span></a>: bah, /me is confused...</div>
<div class="line">[Monday 01 November 2010] [13:23:22] &lt;mato&gt;   <a href="#id239"><span class="problematic" id="id240">sustrik_</span></a>: i think i need to look at the signaler code together with you, otherwise i&#8217;ll get it wrong</div>
<div class="line">[Monday 01 November 2010] [13:24:02] &lt;mato&gt;   <a href="#id241"><span class="problematic" id="id242">sustrik_</span></a>: anyway, i do have a nicely refactored event.hpp/event.cpp that tries to minimize duplication</div>
<div class="line">[Monday 01 November 2010] [13:25:03] &lt;mato&gt;   <a href="#id243"><span class="problematic" id="id244">sustrik_</span></a>: what needs to be protected by the mutex? queue and signaled or just queue?</div>
<div class="line">[Monday 01 November 2010] [13:51:56] &lt;CIA-21&gt; zeromq2: 03Martin Lucina 07wip-signaler * rf78cb39 10/ (8 files in 3 dirs):</div>
<div class="line">[Monday 01 November 2010] [13:51:56] &lt;CIA-21&gt; zeromq2: WIP version of new signaler_t/event_t</div>
<div class="line">[Monday 01 November 2010] [13:51:56] &lt;CIA-21&gt; zeromq2: Signed-off-by: Martin Lucina &lt;<a class="reference external" href="mailto:mato&#37;&#52;&#48;kotelna&#46;sk">mato<span>&#64;</span>kotelna<span>&#46;</span>sk</a>&gt; - <a class="reference external" href="http://bit.ly/9BPDCp">http://bit.ly/9BPDCp</a></div>
<div class="line">[Monday 01 November 2010] [13:52:40] &lt;Guthur&gt; sustrik: Thanks for the comments</div>
<div class="line">[Monday 01 November 2010] [13:53:07] &lt;Guthur&gt; unfortunately C# doesn&#8217;t support friends, I had thought of that</div>
<div class="line">[Monday 01 November 2010] [13:54:22] &lt;Guthur&gt; And I didn&#8217;t realise about spaces vs tabs</div>
<div class="line">[Monday 01 November 2010] [13:54:46] &lt;<a href="#id245"><span class="problematic" id="id246">sustrik_</span></a>&gt;       it makes the code ugly when your editor is set differently</div>
<div class="line">[Monday 01 November 2010] [13:55:05] &lt;Guthur&gt; No problem</div>
<div class="line">[Monday 01 November 2010] [13:55:09] &lt;Guthur&gt; I&#8217;ll use spaces</div>
<div class="line">[Monday 01 November 2010] [13:55:10] &lt;<a href="#id247"><span class="problematic" id="id248">sustrik_</span></a>&gt;       anyway, if there are no friends, it probably have to stay as is</div>
<div class="line">[Monday 01 November 2010] [13:55:44] &lt;Guthur&gt; The reason for  Queue methods was really to just improve the interface slightly</div>
<div class="line">[Monday 01 November 2010] [13:56:04] &lt;Guthur&gt; but I can understand wanting to reflect the underlying API as much as possible</div>
<div class="line">[Monday 01 November 2010] [13:56:41] &lt;Guthur&gt; Queue, Forwarder, and Streamer methods*</div>
<div class="line">[Monday 01 November 2010] [13:57:59] &lt;<a href="#id249"><span class="problematic" id="id250">sustrik_</span></a>&gt;       yes</div>
<div class="line">[Monday 01 November 2010] [13:58:09] &lt;<a href="#id251"><span class="problematic" id="id252">sustrik_</span></a>&gt;       also, it&#8217;s easier to tweak constants</div>
<div class="line">[Monday 01 November 2010] [13:58:15] &lt;<a href="#id253"><span class="problematic" id="id254">sustrik_</span></a>&gt;       than tweaking functions</div>
<div class="line">[Monday 01 November 2010] [13:58:24] &lt;<a href="#id255"><span class="problematic" id="id256">sustrik_</span></a>&gt;       in case anything changes in the future</div>
<div class="line">[Monday 01 November 2010] [13:58:33] &lt;Guthur&gt; Reasonable enough, I&#8217;ll change to reflect your suggestion</div>
<div class="line">[Monday 01 November 2010] [13:59:33] &lt;<a href="#id257"><span class="problematic" id="id258">sustrik_</span></a>&gt;       btw, the clrzmq project is kind of orphaned, do you want to help with it?</div>
<div class="line">[Monday 01 November 2010] [14:00:02] &lt;<a href="#id259"><span class="problematic" id="id260">sustrik_</span></a>&gt;       how it can be done is you&#8217;ll get write access to the repo</div>
<div class="line">[Monday 01 November 2010] [14:00:48] &lt;<a href="#id261"><span class="problematic" id="id262">sustrik_</span></a>&gt;       if it is rather one-off patch, then send the patch to the mailing list</div>
<div class="line">[Monday 01 November 2010] [14:01:22] &lt;Guthur&gt; <a href="#id263"><span class="problematic" id="id264">sustrik_</span></a>, Sure no problem</div>
<div class="line">[Monday 01 November 2010] [14:02:02] &lt;Guthur&gt; is Jeffrey no longer involved?</div>
<div class="line">[Monday 01 November 2010] [14:04:37] &lt;<a href="#id265"><span class="problematic" id="id266">sustrik_</span></a>&gt;       haven&#8217;t heard anything about clrzmq for quite a long time</div>
<div class="line">[Monday 01 November 2010] [14:04:49] &lt;<a href="#id267"><span class="problematic" id="id268">sustrik_</span></a>&gt;       but maybe i&#8217;ve just missed it?</div>
<div class="line">[Monday 01 November 2010] [14:05:56] &lt;<a href="#id269"><span class="problematic" id="id270">sustrik_</span></a>&gt;       last update aug, 30</div>
<div class="line">[Monday 01 November 2010] [14:06:24] &lt;Guthur&gt; Has there been many interface changes to zmq since then?</div>
<div class="line">[Monday 01 November 2010] [14:06:32] &lt;Guthur&gt; or is it mostly under the hood</div>
<div class="line">[Monday 01 November 2010] [14:06:39] &lt;<a href="#id271"><span class="problematic" id="id272">sustrik_</span></a>&gt;       it&#8217;s under the hood</div>
<div class="line">[Monday 01 November 2010] [14:06:44] &lt;<a href="#id273"><span class="problematic" id="id274">sustrik_</span></a>&gt;       some new socket options</div>
<div class="line">[Monday 01 November 2010] [14:07:12] &lt;Guthur&gt; I&#8217;ll try to work through the examples and add the missing ones</div>
<div class="line">[Monday 01 November 2010] [14:07:24] &lt;Guthur&gt; Good way to find any missing features I would imagine</div>
<div class="line">[Monday 01 November 2010] [14:07:27] &lt;<a href="#id275"><span class="problematic" id="id276">sustrik_</span></a>&gt;       just have a look at zmq.h</div>
<div class="line">[Monday 01 November 2010] [14:07:41] &lt;Guthur&gt; that would also work, hehe</div>
<div class="line">[Monday 01 November 2010] [14:08:05] &lt;<a href="#id277"><span class="problematic" id="id278">sustrik_</span></a>&gt;       for the master branch there are these new options:</div>
<div class="line">[Monday 01 November 2010] [14:08:06] &lt;<a href="#id279"><span class="problematic" id="id280">sustrik_</span></a>&gt;       #define ZMQ_FD 14</div>
<div class="line">[Monday 01 November 2010] [14:08:06] &lt;<a href="#id281"><span class="problematic" id="id282">sustrik_</span></a>&gt;       #define ZMQ_EVENTS 15</div>
<div class="line">[Monday 01 November 2010] [14:08:07] &lt;<a href="#id283"><span class="problematic" id="id284">sustrik_</span></a>&gt;       #define ZMQ_TYPE 16</div>
<div class="line">[Monday 01 November 2010] [14:08:07] &lt;<a href="#id285"><span class="problematic" id="id286">sustrik_</span></a>&gt;       #define ZMQ_LINGER 17</div>
<div class="line">[Monday 01 November 2010] [14:08:07] &lt;<a href="#id287"><span class="problematic" id="id288">sustrik_</span></a>&gt;       #define ZMQ_RECONNECT_IVL 18</div>
<div class="line">[Monday 01 November 2010] [14:08:08] &lt;<a href="#id289"><span class="problematic" id="id290">sustrik_</span></a>&gt;       #define ZMQ_BACKLOG 19</div>
<div class="line">[Monday 01 November 2010] [14:08:43] &lt;<a href="#id291"><span class="problematic" id="id292">sustrik_</span></a>&gt;       first two are irrelevant from clrzmq&#8217;s point of view</div>
<div class="line">[Monday 01 November 2010] [14:08:52] &lt;<a href="#id293"><span class="problematic" id="id294">sustrik_</span></a>&gt;       that leaves us with 4 new options</div>
<div class="line">[Monday 01 November 2010] [14:10:39] &lt;Guthur&gt; what about ZMQ_RCVMORE</div>
<div class="line">[Monday 01 November 2010] [14:11:08] &lt;<a href="#id295"><span class="problematic" id="id296">sustrik_</span></a>&gt;       it&#8217;s not there?</div>
<div class="line">[Monday 01 November 2010] [14:11:22] &lt;Guthur&gt; not in what I cloned</div>
<div class="line">[Monday 01 November 2010] [14:11:33] &lt;Guthur&gt; let me double check github</div>
<div class="line">[Monday 01 November 2010] [14:11:59] &lt;<a href="#id297"><span class="problematic" id="id298">sustrik_</span></a>&gt;       what&#8217;s your name on github?</div>
<div class="line">[Monday 01 November 2010] [14:12:22] &lt;Guthur&gt; Guthur, though I notice it gives my real name in the commits</div>
<div class="line">[Monday 01 November 2010] [14:12:38] &lt;Guthur&gt; Its not in the clrzmq</div>
<div class="line">[Monday 01 November 2010] [14:12:42] &lt;Guthur&gt; ZMQ_RCVMORE that is</div>
<div class="line">[Monday 01 November 2010] [14:12:54] &lt;<a href="#id299"><span class="problematic" id="id300">sustrik_</span></a>&gt;       ok, you have commit access to clrzmq</div>
<div class="line">[Monday 01 November 2010] [14:13:00] &lt;<a href="#id301"><span class="problematic" id="id302">sustrik_</span></a>&gt;       be carefull not to break it</div>
<div class="line">[Monday 01 November 2010] [14:13:09] &lt;<a href="#id303"><span class="problematic" id="id304">sustrik_</span></a>&gt;       let me check...</div>
<div class="line">[Monday 01 November 2010] [14:13:17] &lt;mato&gt;   <a href="#id305"><span class="problematic" id="id306">sustrik_</span></a>: should i be disabling interrupt coalescing only for RX or also for TX?</div>
<div class="line">[Monday 01 November 2010] [14:13:18] &lt;<a href="#id307"><span class="problematic" id="id308">toni_</span></a>&gt;  hi there. I am using zmq with python. The docs of pyzmq only cover sockets. Does anybody know where I can find more information about pyzmq?</div>
<div class="line">[Monday 01 November 2010] [14:13:55] &lt;<a href="#id309"><span class="problematic" id="id310">sustrik_</span></a>&gt;       Guthur: there&#8217;s no getsockopt function at all :(</div>
<div class="line">[Monday 01 November 2010] [14:14:05] &lt;<a href="#id311"><span class="problematic" id="id312">sustrik_</span></a>&gt;       mato: both</div>
<div class="line">[Monday 01 November 2010] [14:14:26] &lt;Guthur&gt; <a href="#id313"><span class="problematic" id="id314">sustrik_</span></a>: Definitely needs some work then</div>
<div class="line">[Monday 01 November 2010] [14:14:52] &lt;<a href="#id315"><span class="problematic" id="id316">sustrik_</span></a>&gt;       <a href="#id317"><span class="problematic" id="id318">toni_</span></a>: what do you mean?</div>
<div class="line">[Monday 01 November 2010] [14:14:58] &lt;Guthur&gt; I&#8217;ll try to bring it up to current</div>
<div class="line">[Monday 01 November 2010] [14:15:08] &lt;<a href="#id319"><span class="problematic" id="id320">sustrik_</span></a>&gt;       Guther: great!</div>
<div class="line">[Monday 01 November 2010] [14:16:14] &lt;<a href="#id321"><span class="problematic" id="id322">toni_</span></a>&gt;  <a href="#id323"><span class="problematic" id="id324">sustrik_</span></a>: I downloaded the pyzmq. Building the docs with sphinx I only get some info about the methods of the socket object. I need a more detailed documentation of the python api</div>
<div class="line">[Monday 01 November 2010] [14:16:52] &lt;<a href="#id325"><span class="problematic" id="id326">sustrik_</span></a>&gt;       socket object presumably _is_ python api</div>
<div class="line">[Monday 01 November 2010] [14:18:17] &lt;mato&gt;   <a href="#id327"><span class="problematic" id="id328">sustrik_</span></a>: hmm, i don&#8217;t entirely trust this switch</div>
<div class="line">[Monday 01 November 2010] [14:18:39] &lt;mato&gt;   <a href="#id329"><span class="problematic" id="id330">sustrik_</span></a>: but the results I see <em>appear</em> to show that I get ~60us latency with the old code, and ~78us with the new cose</div>
<div class="line">[Monday 01 November 2010] [14:18:42] &lt;mato&gt;   <a href="#id7"><span class="problematic" id="id8">*</span></a>code</div>
<div class="line">[Monday 01 November 2010] [14:18:52] &lt;<a href="#id331"><span class="problematic" id="id332">sustrik_</span></a>&gt;       uhm</div>
<div class="line">[Monday 01 November 2010] [14:19:03] &lt;<a href="#id333"><span class="problematic" id="id334">sustrik_</span></a>&gt;       ok, we&#8217;ll need some optimisation</div>
<div class="line">[Monday 01 November 2010] [14:19:06] &lt;mato&gt;   <a href="#id335"><span class="problematic" id="id336">sustrik_</span></a>: throughput is weird, it seemed to fluctuate but now appears stablew</div>
<div class="line">[Monday 01 November 2010] [14:19:18] &lt;<a href="#id337"><span class="problematic" id="id338">sustrik_</span></a>&gt;       throughput is a weird metric</div>
<div class="line">[Monday 01 November 2010] [14:19:20] &lt;mato&gt;   I guess ideally I should test w/o the switch, no?</div>
<div class="line">[Monday 01 November 2010] [14:19:29] &lt;<a href="#id339"><span class="problematic" id="id340">sustrik_</span></a>&gt;       fluctuating almost by definition</div>
<div class="line">[Monday 01 November 2010] [14:19:54] &lt;<a href="#id341"><span class="problematic" id="id342">sustrik_</span></a>&gt;       ideally, but normally switch is not the bottleneck</div>
<div class="line">[Monday 01 November 2010] [14:20:16] &lt;mato&gt;   well, it&#8217;s only 100 EUR worth of switch so it won&#8217;t be <em>that</em> great</div>
<div class="line">[Monday 01 November 2010] [14:20:28] &lt;mato&gt;   i can test tomorrow with a direct link, not now...</div>
<div class="line">[Monday 01 November 2010] [14:20:36] &lt;<a href="#id343"><span class="problematic" id="id344">sustrik_</span></a>&gt;       i don&#8217;t think it&#8217;s needed</div>
<div class="line">[Monday 01 November 2010] [14:20:43] &lt;<a href="#id345"><span class="problematic" id="id346">sustrik_</span></a>&gt;       the latency test is relevant</div>
<div class="line">[Monday 01 November 2010] [14:20:51] &lt;<a href="#id347"><span class="problematic" id="id348">sustrik_</span></a>&gt;       18us delta is too much</div>
<div class="line">[Monday 01 November 2010] [14:20:56] &lt;mato&gt;   ok, well that consistently shows the same result</div>
<div class="line">[Monday 01 November 2010] [14:21:00] &lt;<a href="#id349"><span class="problematic" id="id350">sustrik_</span></a>&gt;       we have to optimise</div>
<div class="line">[Monday 01 November 2010] [14:21:17] &lt;mato&gt;   well, let&#8217;s sit down and look at it together tomorrow</div>
<div class="line">[Monday 01 November 2010] [14:21:21] &lt;<a href="#id351"><span class="problematic" id="id352">sustrik_</span></a>&gt;       ok</div>
<div class="line">[Monday 01 November 2010] [14:21:24] &lt;mato&gt;   now, beer?</div>
<div class="line">[Monday 01 November 2010] [14:21:45] &lt;<a href="#id353"><span class="problematic" id="id354">sustrik_</span></a>&gt;       allegedly, there&#8217;s some klezmer-tango concert in nuspirit club</div>
<div class="line">[Monday 01 November 2010] [14:22:03] &lt;mato&gt;   ah, yes, someone did mention something the other day</div>
<div class="line">[Monday 01 November 2010] [14:22:06] &lt;mato&gt;   i forget who</div>
<div class="line">[Monday 01 November 2010] [14:22:15] &lt;<a href="#id355"><span class="problematic" id="id356">sustrik_</span></a>&gt;       your cousin?</div>
<div class="line">[Monday 01 November 2010] [14:22:15] &lt;Guthur&gt; <a href="#id357"><span class="problematic" id="id358">sustrik_</span></a>: By the looks of it someone imported the setsockopt twice instead of doing getsockopt</div>
<div class="line">[Monday 01 November 2010] [14:22:22] &lt;mato&gt;   dunno</div>
<div class="line">[Monday 01 November 2010] [14:22:37] &lt;<a href="#id359"><span class="problematic" id="id360">sustrik_</span></a>&gt;       Guthur: quite possible</div>
<div class="line">[Monday 01 November 2010] [14:22:46] &lt;<a href="#id361"><span class="problematic" id="id362">sustrik_</span></a>&gt;       as I said, the project is kind of orphaned</div>
<div class="line">[Monday 01 November 2010] [14:23:05] &lt;<a href="#id363"><span class="problematic" id="id364">sustrik_</span></a>&gt;       looks like .net devs have not much love for open source</div>
<div class="line">[Monday 01 November 2010] [14:23:55] &lt;Guthur&gt; yeah that tends to be the case</div>
<div class="line">[Monday 01 November 2010] [14:24:18] &lt;Guthur&gt; I would have thought mono might be reversing the trend</div>
<div class="line">[Monday 01 November 2010] [14:24:40] &lt;Guthur&gt; I&#8217;m only interested in it because I am paid to be, hehe</div>
<div class="line">[Monday 01 November 2010] [14:25:51] &lt;<a href="#id365"><span class="problematic" id="id366">sustrik_</span></a>&gt;       i&#8217;m afraid that&#8217;s the case with most people using the .net binding</div>
<div class="line">[Monday 01 November 2010] [15:27:16] &lt;PythonMQ&gt;       hello, does anyone knows where can I find a compative version of pyzmq for old Python 2.4?</div>
<div class="line">[Monday 01 November 2010] [15:28:30] &lt;PythonMQ&gt;       when I try to create an extension for Python 2.4, it asks for .nET 1.1 SDK, Vs 2003, etc... which I dont have</div>
<div class="line">[Monday 01 November 2010] [16:32:00] &lt;mikko&gt;  good evening</div>
<div class="line">[Monday 01 November 2010] [17:18:04] &lt;<a href="#id367"><span class="problematic" id="id368">sustrik_</span></a>&gt;       travlr: hi, are you there by chance?</div>
<div class="line">[Monday 01 November 2010] [17:39:24] &lt;Guthur&gt; <a href="#id369"><span class="problematic" id="id370">sustrik_</span></a>, when setting the identity through setsockopt is it string length + 1?</div>
<div class="line">[Monday 01 November 2010] [17:39:47] &lt;Guthur&gt; for the optvallen</div>
<div class="line">[Monday 01 November 2010] [17:40:20] &lt;mikko&gt;  Guthur: no need for +1 as you give the length</div>
<div class="line">[Monday 01 November 2010] [17:41:01] &lt;mikko&gt;  as far as i remember it doesnt matter as long as it&#8217;s consistent</div>
<div class="line">[Monday 01 November 2010] [17:41:22] &lt;Guthur&gt; oh ok, its just unless I did that it was corrupting the last char</div>
<div class="line">[Monday 01 November 2010] [17:41:46] &lt;Guthur&gt; but it could be something wrong with  the C# marshal  code</div>
<div class="line">[Monday 01 November 2010] [17:42:47] &lt;<a href="#id371"><span class="problematic" id="id372">sustrik_</span></a>&gt;       i think mikko is right</div>
<div class="line">[Monday 01 November 2010] [17:42:59] &lt;<a href="#id373"><span class="problematic" id="id374">sustrik_</span></a>&gt;       the identity is a binary blob, not a string</div>
<div class="line">[Monday 01 November 2010] [17:43:23] &lt;<a href="#id375"><span class="problematic" id="id376">sustrik_</span></a>&gt;       if it corrupts the last byte, it&#8217;s a bug</div>
<div class="line">[Monday 01 November 2010] [17:44:59] &lt;Guthur&gt; ok, I&#8217;ll investigate a little</div>
<div class="line">[Monday 01 November 2010] [18:53:49] &lt;Guthur&gt; <a href="#id377"><span class="problematic" id="id378">sustrik_</span></a>, should I do some checking so that people don&#8217;t do silly things like set an affinity of -1</div>
<div class="line">[Tuesday 02 November 2010] [03:12:26] &lt;hellophp&gt;      hi</div>
<div class="line">[Tuesday 02 November 2010] [03:14:29] &lt;hellophp&gt;      chat</div>
<div class="line">[Tuesday 02 November 2010] [03:14:31] &lt;hellophp&gt;      kk</div>
<div class="line">[Tuesday 02 November 2010] [03:14:32] &lt;hellophp&gt;      test</div>
<div class="line">[Tuesday 02 November 2010] [04:13:08] &lt;nettok&gt;        is there something like &#8220;getpeername&#8221; for zeromq sockets?</div>
<div class="line">[Tuesday 02 November 2010] [04:13:35] &lt;guido_g&gt;       no</div>
<div class="line">[Tuesday 02 November 2010] [04:13:44] &lt;nettok&gt;        ok thanks</div>
<div class="line">[Tuesday 02 November 2010] [07:40:16] &lt;Ogedei&gt;        so zmq_send seems to clear my msg struct&#8217;s data &#8211; yet the docs don&#8217;t talk about it, and some examples in the guide seem to assume it doesn&#8217;t</div>
<div class="line">[Tuesday 02 November 2010] [07:40:24] &lt;mikko&gt; hi</div>
<div class="line">[Tuesday 02 November 2010] [07:41:16] &lt;Ogedei&gt;        the question then, is: what happens to a msg struct when it is passed to zmq_send?</div>
<div class="line">[Tuesday 02 November 2010] [07:43:32] &lt;sustrik&gt;       it&#8217;s cleared</div>
<div class="line">[Tuesday 02 November 2010] [07:43:43] &lt;sustrik&gt;       which examples in the guide assume it&#8217;s not?</div>
<div class="line">[Tuesday 02 November 2010] [07:45:19] &lt;Ogedei&gt;        ah, found it (you cannot send the same message twice). yet, the topic_msg in an example in the guide seems to be reused</div>
<div class="line">[Tuesday 02 November 2010] [07:45:35] &lt;Ogedei&gt;        hah</div>
<div class="line">[Tuesday 02 November 2010] [07:45:41] &lt;Ogedei&gt;        ah, that&#8217;s an example of broken code</div>
<div class="line">[Tuesday 02 November 2010] [07:45:50] &lt;Ogedei&gt;        a big red flashing warning would be good</div>
<div class="line">[Tuesday 02 November 2010] [07:46:56] &lt;pieterh&gt;       Ogedei, :-) Just saw that myself</div>
<div class="line">[Tuesday 02 November 2010] [07:47:03] &lt;pieterh&gt;       It does say: &#8220;Note than when you have passed a message to zmq_send(3), MQ will clear the message, i.e. set the size to zero. You cannot send the same message twice, and you cannot access the message data after sending it.&#8221;</div>
<div class="line">[Tuesday 02 November 2010] [07:47:06] &lt;pieterh&gt;       but somewhat later</div>
<div class="line">[Tuesday 02 November 2010] [07:47:19] &lt;Ogedei&gt;        so, can I re-initialize my msg struct and send it again, or should I close it and make a new one?</div>
<div class="line">[Tuesday 02 November 2010] [07:47:29] &lt;pieterh&gt;       whatever is neater for your code</div>
<div class="line">[Tuesday 02 November 2010] [07:47:44] &lt;sustrik&gt;       there&#8217;s also zmq_msg_copy function</div>
<div class="line">[Tuesday 02 November 2010] [07:48:13] &lt;Ogedei&gt;        doing msg_init on a zero-length, but unclosed message won&#8217;t leak memory, right?</div>
<div class="line">[Tuesday 02 November 2010] [07:48:15] &lt;pieterh&gt;       that&#8217;s if you want to send the identical message to multiple sockets or more than once to the same socket</div>
<div class="line">[Tuesday 02 November 2010] [07:48:23] &lt;pieterh&gt;       Ogedei, it&#8217;s safe</div>
<div class="line">[Tuesday 02 November 2010] [07:48:26] &lt;Ogedei&gt;        what if it is not zero-length? will it be magically closed?</div>
<div class="line">[Tuesday 02 November 2010] [07:48:31] &lt;pieterh&gt;       yes</div>
<div class="line">[Tuesday 02 November 2010] [07:48:34] &lt;Ogedei&gt;        awesome</div>
<div class="line">[Tuesday 02 November 2010] [07:48:59] &lt;pieterh&gt;       indeed it is :-)</div>
<div class="line">[Tuesday 02 November 2010] [07:49:20] &lt;sustrik&gt;       wait a sec, magically closed, what?</div>
<div class="line">[Tuesday 02 November 2010] [07:49:49] &lt;Ogedei&gt;        whether msg-init (and friends) will close their argument, if necessary</div>
<div class="line">[Tuesday 02 November 2010] [07:49:50] &lt;Ogedei&gt;        actually</div>
<div class="line">[Tuesday 02 November 2010] [07:49:55] &lt;pieterh&gt;       sustrik: question was, if you do zmq_msg_init on an existing message will it close the old message or not</div>
<div class="line">[Tuesday 02 November 2010] [07:49:57] &lt;Ogedei&gt;        how could they do that? it might be raw memory</div>
<div class="line">[Tuesday 02 November 2010] [07:50:07] &lt;sustrik&gt;       exactly</div>
<div class="line">[Tuesday 02 November 2010] [07:50:10] &lt;sustrik&gt;       they don&#8217;t</div>
<div class="line">[Tuesday 02 November 2010] [07:50:18] &lt;pieterh&gt;       what if there&#8217;s a free function provided?</div>
<div class="line">[Tuesday 02 November 2010] [07:50:36] &lt;sustrik&gt;       it&#8217;s called when message is zmq_close&#8217;d</div>
<div class="line">[Tuesday 02 November 2010] [07:50:46] &lt;sustrik&gt;       zmq_msg_close&#8217;d</div>
<div class="line">[Tuesday 02 November 2010] [07:50:48] &lt;pieterh&gt;       and if you re-init the message it&#8217;ll leak?</div>
<div class="line">[Tuesday 02 November 2010] [07:50:52] &lt;sustrik&gt;       yes</div>
<div class="line">[Tuesday 02 November 2010] [07:50:57] &lt;pieterh&gt;       Ogedei, sorry, I was optimistic</div>
<div class="line">[Tuesday 02 November 2010] [07:50:57] &lt;Ogedei&gt;        I guess I&#8217;ll take care to close my messages then</div>
<div class="line">[Tuesday 02 November 2010] [07:50:58] &lt;sustrik&gt;       as any other C structure</div>
<div class="line">[Tuesday 02 November 2010] [07:51:26] &lt;pieterh&gt;       sustrik: C structures don&#8217;t really behave anything like this</div>
<div class="line">[Tuesday 02 November 2010] [07:51:46] &lt;sustrik&gt;       struct {char <a href="#id9"><span class="problematic" id="id10">*</span></a>a; char <a href="#id11"><span class="problematic" id="id12">*</span></a>b};</div>
<div class="line">[Tuesday 02 November 2010] [07:51:54] &lt;pieterh&gt;       structures don&#8217;t have constructors</div>
<div class="line">[Tuesday 02 November 2010] [07:51:54] &lt;sustrik&gt;       when are the strings deallocated?</div>
<div class="line">[Tuesday 02 November 2010] [07:52:12] &lt;sustrik&gt;       yes, you need an initialisation and deinitialisation functions</div>
<div class="line">[Tuesday 02 November 2010] [07:52:22] &lt;sustrik&gt;       that&#8217;s what zmq_msg_init and zmq_msg_close are</div>
<div class="line">[Tuesday 02 November 2010] [07:52:36] &lt;pieterh&gt;       any particular reason you _don&#8217;<a href="#id379"><span class="problematic" id="id380">t_</span></a> call close when re-initializing a message?</div>
<div class="line">[Tuesday 02 November 2010] [07:52:44] &lt;pieterh&gt;       i assume close is idempotent</div>
<div class="line">[Tuesday 02 November 2010] [07:52:57] &lt;sustrik&gt;       because you have no idea whether you are re-initialising</div>
<div class="line">[Tuesday 02 November 2010] [07:53:01] &lt;pieterh&gt;       and the msg api does have callbacks for deallocators</div>
<div class="line">[Tuesday 02 November 2010] [07:53:24] &lt;Ogedei&gt;        you can&#8217;t just follow the pointers in there &#8211; might be uninitialized raw memory</div>
<div class="line">[Tuesday 02 November 2010] [07:53:25] &lt;pieterh&gt;       ah, it could just be random data...</div>
<div class="line">[Tuesday 02 November 2010] [07:53:36] &lt;sustrik&gt;       yes</div>
<div class="line">[Tuesday 02 November 2010] [07:53:43] &lt;Ogedei&gt;        anyway, did anyone ever get anywhere with a ruby wrapper? I&#8217;m writting a wrapper for (the also green-threaded) Allegro Common Lisp</div>
<div class="line">[Tuesday 02 November 2010] [07:53:48] &lt;pieterh&gt;       because you&#8217;re not constructing the message, it&#8217;s just on the stack</div>
<div class="line">[Tuesday 02 November 2010] [07:54:09] &lt;pieterh&gt;       hmm...</div>
<div class="line">[Tuesday 02 November 2010] [07:54:13] &lt;Ogedei&gt;        there were some discouraging messages on the list</div>
<div class="line">[Tuesday 02 November 2010] [07:54:15] &lt;sustrik&gt;       right, there may be garbage inside</div>
<div class="line">[Tuesday 02 November 2010] [07:54:29] &lt;sustrik&gt;       what&#8217;s wrong with the ruby wrapper?</div>
<div class="line">[Tuesday 02 November 2010] [07:54:46] &lt;Ogedei&gt;        there&#8217;s this issue with blocking APIs and green threads</div>
<div class="line">[Tuesday 02 November 2010] [07:54:52] &lt;pieterh&gt;       Ogedei, what list ? :-)</div>
<div class="line">[Tuesday 02 November 2010] [07:54:59] &lt;Ogedei&gt;        lemme search</div>
<div class="line">[Tuesday 02 November 2010] [07:55:59] &lt;sustrik&gt;       i would guess it&#8217;s about the fact that ruby, being green-threaded, cannot use blocking calls</div>
<div class="line">[Tuesday 02 November 2010] [07:56:18] &lt;sustrik&gt;       if so, it&#8217;s a problem with ruby rather than with 0mq</div>
<div class="line">[Tuesday 02 November 2010] [07:56:26] &lt;sustrik&gt;       you can still use non-blocking calls</div>
<div class="line">[Tuesday 02 November 2010] [07:56:55] &lt;Ogedei&gt;        yeah, but then you can say good-bye to responsiveness (that&#8217;s an exaggeration of course)</div>
<div class="line">[Tuesday 02 November 2010] [07:57:34] &lt;sustrik&gt;       yes, unfortunately, it&#8217;s a ruby issue</div>
<div class="line">[Tuesday 02 November 2010] [07:57:41] &lt;sustrik&gt;       there&#8217;s little i can do about it</div>
<div class="line">[Tuesday 02 November 2010] [07:58:29] &lt;sustrik&gt;       green-threads are simply not good for high-perf scenarios</div>
<div class="line">[Tuesday 02 November 2010] [07:58:55] &lt;sustrik&gt;       anyway, that python guys are doing, afaiu, is that they launch several instances of python interpreter</div>
<div class="line">[Tuesday 02 November 2010] [07:59:05] &lt;sustrik&gt;       each running exactly one green thread</div>
<div class="line">[Tuesday 02 November 2010] [07:59:14] &lt;Ogedei&gt;        i have a trick with companion C threads and a pipe that works reasonably well, but yeah, it&#8217;s awkward</div>
<div class="line">[Tuesday 02 November 2010] [07:59:14] &lt;sustrik&gt;       which means it can use blocking calls</div>
<div class="line">[Tuesday 02 November 2010] [07:59:29] &lt;sustrik&gt;       then they use 0mq to send messages between the instances</div>
<div class="line">[Tuesday 02 November 2010] [08:00:50] &lt;sustrik&gt;       i think no trick would help: either you use non-blocking calls, thus loosing performance or you use blocking calls thus eventually blocking other green threads :(</div>
<div class="line">[Tuesday 02 November 2010] [08:05:18] &lt;Ogedei&gt;        well, no, in my case, i have a thread written in C which does the blocking, and the Lisp runtime is listening on a pipe for events, and thus gets notified when the C thread has done its work. more indirect, but no polling is involved</div>
<div class="line">[Tuesday 02 November 2010] [08:10:13] &lt;sustrik&gt;       ah, you can do that with 0mq as well</div>
<div class="line">[Tuesday 02 November 2010] [08:10:23] &lt;sustrik&gt;       you can poll on sockets</div>
<div class="line">[Tuesday 02 November 2010] [08:12:14] &lt;sustrik&gt;       in a separate C thread</div>
<div class="line">[Tuesday 02 November 2010] [08:12:35] &lt;sustrik&gt;       however, the problem is how to notify ruby</div>
<div class="line">[Tuesday 02 November 2010] [08:12:47] &lt;sustrik&gt;       you are back to the same problem</div>
<div class="line">[Tuesday 02 November 2010] [08:12:59] &lt;sustrik&gt;       ruby can either check for new events, thus loosing performance</div>
<div class="line">[Tuesday 02 November 2010] [08:13:15] &lt;sustrik&gt;       or block waiting for them, thus blocking other green-threads</div>
<div class="line">[Tuesday 02 November 2010] [08:37:50] &lt;CIA-20&gt;        zeromq2: 03Martin Sustrik 07master * rde93f63 10/ configure.in :</div>
<div class="line">[Tuesday 02 November 2010] [08:37:50] &lt;CIA-20&gt;        zeromq2: crypto library is needed on HP-UX to generate UUIDs</div>
<div class="line">[Tuesday 02 November 2010] [08:37:50] &lt;CIA-20&gt;        zeromq2: Signed-off-by: Martin Sustrik &lt;<a class="reference external" href="mailto:sustrik&#37;&#52;&#48;250bpm&#46;com">sustrik<span>&#64;</span>250bpm<span>&#46;</span>com</a>&gt; - <a class="reference external" href="http://bit.ly/bUi6DJ">http://bit.ly/bUi6DJ</a></div>
<div class="line">[Tuesday 02 November 2010] [08:37:56] &lt;Guthur&gt;        Ogedei, It might be good if you extended the current CL binding with some read time conditionals for ACL</div>
<div class="line">[Tuesday 02 November 2010] [08:38:12] &lt;mato&gt;  sustrik: shouldn&#8217;t that have gone onto maint also?</div>
<div class="line">[Tuesday 02 November 2010] [08:38:13] &lt;Guthur&gt;        if possible...</div>
<div class="line">[Tuesday 02 November 2010] [08:38:21] &lt;mato&gt;  sustrik: (that == HP-UX -lcrypto)</div>
<div class="line">[Tuesday 02 November 2010] [08:40:38] &lt;sustrik&gt;       mato: it&#8217;s probably broken anyway</div>
<div class="line">[Tuesday 02 November 2010] [08:40:44] &lt;mato&gt;  sustrik: why so?</div>
<div class="line">[Tuesday 02 November 2010] [08:41:05] &lt;sustrik&gt;       what i mean, there are issues compiling it, right?</div>
<div class="line">[Tuesday 02 November 2010] [08:41:14] &lt;sustrik&gt;       so people are presumably not using it</div>
<div class="line">[Tuesday 02 November 2010] [08:41:26] &lt;sustrik&gt;       so, let them rather start with 2.1</div>
<div class="line">[Tuesday 02 November 2010] [08:41:40] &lt;mato&gt;  sustrik: as you wish</div>
<div class="line">[Tuesday 02 November 2010] [08:41:44] &lt;sustrik&gt;       instead of using 2.0 and then having to upgrade to 2.1 in a short time</div>
<div class="line">[Tuesday 02 November 2010] [08:42:15] &lt;mato&gt;  sustrik: for the OPEN_MAX thing, just add in a define defining it to _POSIX_OPEN_MAX if it&#8217;s not there</div>
<div class="line">[Tuesday 02 November 2010] [08:42:32] &lt;sustrik&gt;       nope, the macros have differnet semantics</div>
<div class="line">[Tuesday 02 November 2010] [08:42:42] &lt;mato&gt;  they do?</div>
<div class="line">[Tuesday 02 November 2010] [08:42:42] &lt;sustrik&gt;       check POSIX</div>
<div class="line">[Tuesday 02 November 2010] [08:42:54] &lt;sustrik&gt;       {OPEN_MAX}</div>
<div class="line">[Tuesday 02 November 2010] [08:42:54] &lt;sustrik&gt;           Maximum number of files that one process can have open at any one time.</div>
<div class="line">[Tuesday 02 November 2010] [08:42:54] &lt;sustrik&gt;           Minimum Acceptable Value: {_POSIX_OPEN_MAX}</div>
<div class="line">[Tuesday 02 November 2010] [08:44:01] &lt;mato&gt;  sustrik: hmm, well, then it&#8217;s a bug in HP-UX</div>
<div class="line">[Tuesday 02 November 2010] [08:44:11] &lt;mato&gt;  sustrik: or they need to find out what the correct value to use is</div>
<div class="line">[Tuesday 02 November 2010] [08:44:11] &lt;sustrik&gt;       not even that&#8221;</div>
<div class="line">[Tuesday 02 November 2010] [08:44:20] &lt;sustrik&gt;       POSIX says:</div>
<div class="line">[Tuesday 02 November 2010] [08:44:21] &lt;sustrik&gt;       &#8220;A definition of one of the symbolic names in the following list shall be omitted from &lt;limits.h&gt; on specific implementations where the corresponding value is equal to or greater than the stated minimum, but is unspecified.</div>
<div class="line">[Tuesday 02 November 2010] [08:44:21] &lt;sustrik&gt;       This indetermination might depend on the amount of available memory space on a specific instance of a specific implementation. The actual value supported by a specific instance shall be provided by the sysconf() function.&#8221;</div>
<div class="line">[Tuesday 02 November 2010] [08:44:36] &lt;mato&gt;  sustrik: sure, usual POSIX ambiguity</div>
<div class="line">[Tuesday 02 November 2010] [08:44:49] &lt;sustrik&gt;       i would do it in following way:</div>
<div class="line">[Tuesday 02 November 2010] [08:44:53] &lt;mato&gt;  sustrik: what I mean is someone at HP has to say what value should go in there on HP-UX</div>
<div class="line">[Tuesday 02 November 2010] [08:44:55] &lt;sustrik&gt;       on Solaris use OPEN_MAX-1</div>
<div class="line">[Tuesday 02 November 2010] [08:45:10] &lt;sustrik&gt;       on other paltforms use our constand defined in config.hpp</div>
<div class="line">[Tuesday 02 November 2010] [08:45:22] &lt;sustrik&gt;       &#8220;max_io_events&#8221;</div>
<div class="line">[Tuesday 02 November 2010] [08:45:33] &lt;mato&gt;  sustrik: not a great idea; /dev/poll is platform-specific anyway</div>
<div class="line">[Tuesday 02 November 2010] [08:45:43] &lt;mato&gt;  sustrik: so that platform-specific value should be determined</div>
<div class="line">[Tuesday 02 November 2010] [08:45:57] &lt;sustrik&gt;       that&#8217;s what i&#8217;ve proposed</div>
<div class="line">[Tuesday 02 November 2010] [08:46:13] &lt;DerGuteMoritz&gt; is the Ruby green thread blocking discussion from earlier still current?</div>
<div class="line">[Tuesday 02 November 2010] [08:46:20] &lt;sustrik&gt;       looks like solaris has this limit of &#8220;at most OPEN_MAX&#8221;</div>
<div class="line">[Tuesday 02 November 2010] [08:46:29] &lt;sustrik&gt;       hp-ux doesn&#8217;t seem to have the limit</div>
<div class="line">[Tuesday 02 November 2010] [08:46:39] &lt;sustrik&gt;       anyway, i&#8217;ll ask brett to test it</div>
<div class="line">[Tuesday 02 November 2010] [08:47:03] &lt;sustrik&gt;       DerGuteMoritz: yes, nothing have changed in the meantime :)</div>
<div class="line">[Tuesday 02 November 2010] [08:47:03] &lt;mato&gt;  ah, right, you&#8217;re saying that HP-UX has no limit</div>
<div class="line">[Tuesday 02 November 2010] [08:47:05] &lt;mato&gt;  that&#8217;s possiblew</div>
<div class="line">[Tuesday 02 November 2010] [08:48:12] &lt;mato&gt;  bah, I can&#8217;t seem to find a copy of the /dev/poll (poll(7d)) manpage for HP-UX on the net anywhere</div>
<div class="line">[Tuesday 02 November 2010] [08:48:17] &lt;mato&gt;  sustrik: anyhow, check with brett</div>
<div class="line">[Tuesday 02 November 2010] [08:48:23] &lt;mato&gt;  sustrik: and/or get him to ask their devs</div>
<div class="line">[Tuesday 02 November 2010] [08:51:18] &lt;DerGuteMoritz&gt; I don&#8217;t know what Ruby provides something like that but Chicken&#8217;s green thread scheduler provides a hook to wait for i/o on a file descriptor without blocking other threads. I use it successfully with ZMQ_FD</div>
<div class="line">[Tuesday 02 November 2010] [08:51:34] &lt;DerGuteMoritz&gt; works with 2.1 only then, of course</div>
<div class="line">[Tuesday 02 November 2010] [08:52:12] &lt;sustrik&gt;       DerGuteMoritz: maybe Ruby can do the same thing</div>
<div class="line">[Tuesday 02 November 2010] [08:52:21] &lt;DerGuteMoritz&gt; mayhaps!</div>
<div class="line">[Tuesday 02 November 2010] [08:52:39] &lt;sustrik&gt;       it&#8217;s up to Ruby binding maintainers though</div>
<div class="line">[Tuesday 02 November 2010] [08:52:45]          * sustrik has no idea how ruby works</div>
<div class="line">[Tuesday 02 November 2010] [08:53:00] &lt;mato&gt;  sustrik: ok, so, event.set() and event.reset() should never return EINTR, right?</div>
<div class="line">[Tuesday 02 November 2010] [08:53:06] &lt;mato&gt;  sustrik: only event.wait() should do so</div>
<div class="line">[Tuesday 02 November 2010] [08:53:20] &lt;DerGuteMoritz&gt; yeah :-)</div>
<div class="line">[Tuesday 02 November 2010] [08:53:28] &lt;sustrik&gt;       mato: it can be that way</div>
<div class="line">[Tuesday 02 November 2010] [08:53:29] &lt;DerGuteMoritz&gt; just thought I&#8217;d mention it :-)</div>
<div class="line">[Tuesday 02 November 2010] [08:53:31] &lt;mato&gt;  sustrik: the other two should just silently restart the call since it <em>must</em> succeed</div>
<div class="line">[Tuesday 02 November 2010] [08:53:46] &lt;sustrik&gt;       the whole EINTR thing is a heurstic anyway</div>
<div class="line">[Tuesday 02 November 2010] [08:53:54] &lt;mato&gt;  ok, i&#8217;ll go with this approach for now</div>
<div class="line">[Tuesday 02 November 2010] [08:53:57] &lt;sustrik&gt;       ok</div>
<div class="line">[Tuesday 02 November 2010] [08:53:58] &lt;mato&gt;  and we&#8217;ll see what happens</div>
<div class="line">[Tuesday 02 November 2010] [09:07:16] &lt;mikko&gt; mato: <a class="reference external" href="http://webcache.googleusercontent.com/search?q=cache:XwnPSWMLfJkJ:docs.hp.com/en/B3921-90010/poll.7.html+hp-ux+dev/poll&amp;cd=1&amp;hl=en&amp;ct=clnk&amp;client=firefox-a">http://webcache.googleusercontent.com/search?q=cache:XwnPSWMLfJkJ:docs.hp.com/en/B3921-90010/poll.7.html+hp-ux+dev/poll&amp;cd=1&amp;hl=en&amp;ct=clnk&amp;client=firefox-a</a></div>
<div class="line">[Tuesday 02 November 2010] [09:07:20] &lt;mikko&gt; is that the one?</div>
<div class="line">[Tuesday 02 November 2010] [09:10:02] &lt;mikko&gt; ah</div>
<div class="line">[Tuesday 02 November 2010] [09:10:03] &lt;mikko&gt; <a class="reference external" href="http://h20000.www2.hp.com/bc/docs/support/SupportManual/c02263385/c02263385.pdf">http://h20000.www2.hp.com/bc/docs/support/SupportManual/c02263385/c02263385.pdf</a></div>
<div class="line">[Tuesday 02 November 2010] [09:10:16] &lt;mikko&gt; poll(7) as pdf</div>
<div class="line">[Tuesday 02 November 2010] [09:11:42] &lt;mato&gt;  mikko: hey, thanks! yeah, that&#8217;s it</div>
<div class="line">[Tuesday 02 November 2010] [09:12:27] &lt;mikko&gt; mato: <a class="reference external" href="http://h20000.www2.hp.com/bizsupport/TechSupport/CoreRedirect.jsp?redirectReason=DocIndexPDF&amp;prodSeriesId=4256918&amp;targetPage=http%3A%2F%2Fbizsupport2.austin.hp.com%2Fbc%2Fdocs%2Fsupport%2FSupportManual%2Fc02456334%2Fc02456334.pdf">http://h20000.www2.hp.com/bizsupport/TechSupport/CoreRedirect.jsp?redirectReason=DocIndexPDF&amp;prodSeriesId=4256918&amp;targetPage=http%3A%2F%2Fbizsupport2.austin.hp.com%2Fbc%2Fdocs%2Fsupport%2FSupportManual%2Fc02456334%2Fc02456334.pdf</a></div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="2010-October.html"
                        title="previous chapter">2010-October</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="2011-September.html"
                        title="next chapter">2011-September</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="sources/2010-November.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="2011-September.html" title="2011-September"
             >next</a> |</li>
        <li class="right" >
          <a href="2010-October.html" title="2010-October"
             >previous</a> |</li>
        <li><a href="index.html">ZeroMq IRC Log v0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2010, Peter Alexander.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>