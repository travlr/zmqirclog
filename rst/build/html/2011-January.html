

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>2011-January &mdash; ZeroMq IRC Log v0.1 documentation</title>
    <link rel="stylesheet" href="static/default.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <link rel="top" title="ZeroMq IRC Log v0.1 documentation" href="index.html" />
    <link rel="prev" title="2011-December" href="2011-December.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="2011-December.html" title="2011-December"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">ZeroMq IRC Log v0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="january">
<h1>2011-January<a class="headerlink" href="#january" title="Permalink to this headline">Â¶</a></h1>
<div class="line-block">
<div class="line">[Saturday 01 January 2011] [10:10:37] &lt;dos000&gt;        and happy new year</div>
<div class="line">[Saturday 01 January 2011] [10:10:51] &lt;dos000&gt;        is sustrik here ?</div>
<div class="line">[Saturday 01 January 2011] [10:12:02] &lt;mikko&gt; he was in yesterday</div>
<div class="line">[Saturday 01 January 2011] [10:12:28] &lt;mikko&gt; havent seen him talking today</div>
<div class="line">[Saturday 01 January 2011] [10:15:01] &lt;dos000&gt;        ah!</div>
<div class="line">[Saturday 01 January 2011] [12:34:22] &lt;sustrik&gt;       dos000: hi</div>
<div class="line">[Saturday 01 January 2011] [12:36:15] &lt;sustrik&gt;       happy new year everyone!</div>
<div class="line">[Saturday 01 January 2011] [13:16:07] &lt;pythonirc1011&gt; how much work is it to get a installer ready for windows7 for zeromq+python bindings. Where can one get started on that?</div>
<div class="line">[Saturday 01 January 2011] [13:33:07] &lt;mikko&gt; pythonirc1011: probably it&#8217;s just building the installer</div>
<div class="line">[Saturday 01 January 2011] [13:33:38] &lt;mikko&gt; pythonirc1011: not sure how python extensions are installed on windows or any platform really</div>
<div class="line">[Saturday 01 January 2011] [13:41:38] &lt;dos000&gt;        sustrik, howdy !</div>
<div class="line">[Saturday 01 January 2011] [13:42:03] &lt;dos000&gt;        sustrik, happy new year to you too</div>
<div class="line">[Saturday 01 January 2011] [13:47:30] &lt;sustrik&gt;       pythonirc1011: building a win installer would be very helpful</div>
<div class="line">[Saturday 01 January 2011] [13:47:42] &lt;sustrik&gt;       i would start with the core part</div>
<div class="line">[Saturday 01 January 2011] [13:47:43] &lt;pythonirc1011&gt; mikko: so i need a installation script language + compilation of a zeromq on my win box i guess...</div>
<div class="line">[Saturday 01 January 2011] [13:47:57] &lt;sustrik&gt;       it&#8217;s just a lib and a header file so it should be easy</div>
<div class="line">[Saturday 01 January 2011] [13:48:20] &lt;pythonirc1011&gt; i&#8217;m more after building the python bindings. I need to use it from python</div>
<div class="line">[Saturday 01 January 2011] [13:48:35] &lt;sustrik&gt;       sure, but those are dependent on the lib</div>
<div class="line">[Saturday 01 January 2011] [13:48:44] &lt;pythonirc1011&gt; true</div>
<div class="line">[Saturday 01 January 2011] [13:48:53] &lt;pythonirc1011&gt; perhaps ship the library pre-compiler on windows</div>
<div class="line">[Saturday 01 January 2011] [13:48:58] &lt;pythonirc1011&gt; compiler</div>
<div class="line">[Saturday 01 January 2011] [13:49:01] &lt;pythonirc1011&gt; compiled i meant</div>
<div class="line">[Saturday 01 January 2011] [13:49:04] &lt;sustrik&gt;       exactly</div>
<div class="line">[Saturday 01 January 2011] [13:49:10] &lt;sustrik&gt;       what you need is 2 libraties</div>
<div class="line">[Saturday 01 January 2011] [13:49:12] &lt;sustrik&gt;       libzmq</div>
<div class="line">[Saturday 01 January 2011] [13:49:18] &lt;sustrik&gt;       and libpyzmq</div>
<div class="line">[Saturday 01 January 2011] [13:49:24] &lt;sustrik&gt;       you need to compile them</div>
<div class="line">[Saturday 01 January 2011] [13:49:35] &lt;sustrik&gt;       and build an installer</div>
<div class="line">[Saturday 01 January 2011] [13:49:42] &lt;pythonirc1011&gt; k, that should be doable...are they dlls?</div>
<div class="line">[Saturday 01 January 2011] [13:49:59] &lt;sustrik&gt;       i am not sure whether python needs anythig else aside of those libs</div>
<div class="line">[Saturday 01 January 2011] [13:50:15] &lt;sustrik&gt;       yes, i think so</div>
<div class="line">[Saturday 01 January 2011] [13:50:48] &lt;pythonirc1011&gt; I&#8217;ll look into it soon. Thanks.</div>
<div class="line">[Saturday 01 January 2011] [13:55:38] &lt;dos000&gt;        sustrik, does zma uses lock free ring buffers  ? sometalk i listened mentioned it being musch faster than using queues becose of contention</div>
<div class="line">[Saturday 01 January 2011] [13:55:51] &lt;dos000&gt;        s/zma/0mq</div>
<div class="line">[Saturday 01 January 2011] [13:56:04] &lt;sustrik&gt;       yes, the queues are lock-free</div>
<div class="line">[Saturday 01 January 2011] [13:56:46] &lt;dos000&gt;        sustrik, is it ringbuffer based ?</div>
<div class="line">[Saturday 01 January 2011] [13:57:06] &lt;sustrik&gt;       messages are allocated in blocks</div>
<div class="line">[Saturday 01 January 2011] [13:57:10] &lt;sustrik&gt;       (256 per block)</div>
<div class="line">[Saturday 01 January 2011] [13:57:40] &lt;dos000&gt;        sustrik, here is the talk <a class="reference external" href="http://www.infoq.com/presentations/LMAX">http://www.infoq.com/presentations/LMAX</a> jump to 36:00 for the real meat.</div>
<div class="line">[Saturday 01 January 2011] [13:57:54] &lt;sustrik&gt;       one block is recycled to eliminate excessive allocation/deallocation</div>
<div class="line">[Saturday 01 January 2011] [13:58:17] &lt;dos000&gt;        its kinda java oriented but i think the same issues apply in c++</div>
<div class="line">[Saturday 01 January 2011] [13:58:28] &lt;sustrik&gt;       however, if the number of messages in the queue drops, only 1 block is recycled, any subsequent blocvks are dealloc&#8217;d</div>
<div class="line">[Saturday 01 January 2011] [13:58:41] &lt;dos000&gt;        ah!</div>
<div class="line">[Saturday 01 January 2011] [13:59:02] &lt;dos000&gt;        thats seems smarter .. they allocate 2min off hand to counter java gc</div>
<div class="line">[Saturday 01 January 2011] [13:59:09] &lt;dos000&gt;        2 millions</div>
<div class="line">[Saturday 01 January 2011] [13:59:31] &lt;sustrik&gt;       well, depends on the use case</div>
<div class="line">[Saturday 01 January 2011] [13:59:50] &lt;sustrik&gt;       it&#8217;s something that&#8217;s not good to do on a sensor or an embedded system</div>
<div class="line">[Saturday 01 January 2011] [14:00:11] &lt;sustrik&gt;       0mq tries to be generic</div>
<div class="line">[Saturday 01 January 2011] [14:00:12] &lt;dos000&gt;        indeed .. for a server its much different</div>
<div class="line">[Saturday 01 January 2011] [14:00:26] &lt;sustrik&gt;       you can of course tune it by hand if you want to</div>
<div class="line">[Saturday 01 January 2011] [14:00:48] &lt;sustrik&gt;       see src/config.hpp</div>
<div class="line">[Saturday 01 January 2011] [14:01:51] &lt;dos000&gt;        sustrik, so its configurable by source changes only then</div>
<div class="line">[Saturday 01 January 2011] [14:02:16] &lt;sustrik&gt;       there are 2 mechanisms there</div>
<div class="line">[Saturday 01 January 2011] [14:02:26] &lt;sustrik&gt;       config.hpp are compile-time options</div>
<div class="line">[Saturday 01 January 2011] [14:02:28] &lt;dos000&gt;        sustrik, it will apply to all queues then</div>
<div class="line">[Saturday 01 January 2011] [14:02:40] &lt;sustrik&gt;       socket options can be used in run-time</div>
<div class="line">[Saturday 01 January 2011] [14:02:49] &lt;dos000&gt;        ah!</div>
<div class="line">[Saturday 01 January 2011] [14:03:08] &lt;sustrik&gt;       it&#8217;s a matter to consider whether specific tuning parameter</div>
<div class="line">[Saturday 01 January 2011] [14:03:09] &lt;dos000&gt;        socket options allow to you bigger/smaller buffers ?</div>
<div class="line">[Saturday 01 January 2011] [14:03:18] &lt;sustrik&gt;       should be a socket option or a compile-time param</div>
<div class="line">[Saturday 01 January 2011] [14:03:36] &lt;sustrik&gt;       socket option allow to set the maximal buffer size</div>
<div class="line">[Saturday 01 January 2011] [14:03:49] &lt;dos000&gt;        i cant use compile time options</div>
<div class="line">[Saturday 01 January 2011] [14:03:58] &lt;sustrik&gt;       what are you trying to do?</div>
<div class="line">[Saturday 01 January 2011] [14:05:13] &lt;dos000&gt;        i am writing queues with different bechmarking options</div>
<div class="line">[Saturday 01 January 2011] [14:05:24] &lt;dos000&gt;        so i want to see effect of the changes</div>
<div class="line">[Saturday 01 January 2011] [14:06:26] &lt;sustrik&gt;       writing queues?</div>
<div class="line">[Saturday 01 January 2011] [14:06:36] &lt;sustrik&gt;       you mean you are implementing the queues yourself?</div>
<div class="line">[Saturday 01 January 2011] [14:06:41] &lt;dos000&gt;        so far i have 0mq and fastflow ( <a class="reference external" href="http://calvados.di.unipi.it/dokuwiki/doku.php?id=ffnamespace:about">http://calvados.di.unipi.it/dokuwiki/doku.php?id=ffnamespace:about</a> ) on my list</div>
<div class="line">[Saturday 01 January 2011] [14:06:59] &lt;sustrik&gt;       ok, i see</div>
<div class="line">[Saturday 01 January 2011] [14:07:05] &lt;sustrik&gt;       and what exactly are you missing?</div>
<div class="line">[Saturday 01 January 2011] [14:08:39] &lt;dos000&gt;        sustrik, i only have one issue so far ...</div>
<div class="line">[Saturday 01 January 2011] [14:09:17] &lt;dos000&gt;        i have to receive the events and process them in  java ...</div>
<div class="line">[Saturday 01 January 2011] [14:10:07] &lt;dos000&gt;        i either reimplement the lockfree ring buffers in java .. or use jzmq</div>
<div class="line">[Saturday 01 January 2011] [14:10:39] &lt;dos000&gt;        it looks deceptively easy to write it in java !</div>
<div class="line">[Saturday 01 January 2011] [14:11:27] &lt;sustrik&gt;       i still don&#8217;t see what you are missing :)</div>
<div class="line">[Saturday 01 January 2011] [14:11:39] &lt;sustrik&gt;       0mq is lock-free</div>
<div class="line">[Saturday 01 January 2011] [14:11:43] &lt;dos000&gt;        yes ... i am not missing anything ...</div>
<div class="line">[Saturday 01 January 2011] [14:11:48] &lt;dos000&gt;        i just have options !</div>
<div class="line">[Saturday 01 January 2011] [14:12:04] &lt;sustrik&gt;       implementing the lock-free queeu is not hard</div>
<div class="line">[Saturday 01 January 2011] [14:12:20] &lt;sustrik&gt;       it may become a problem as you want to add more features</div>
<div class="line">[Saturday 01 January 2011] [14:12:23] &lt;dos000&gt;        sustrik, there is locking when you call c++ functions from java</div>
<div class="line">[Saturday 01 January 2011] [14:12:28] &lt;sustrik&gt;       like limiting the number of messages in queue</div>
<div class="line">[Saturday 01 January 2011] [14:12:31] &lt;sustrik&gt;       or somesuch</div>
<div class="line">[Saturday 01 January 2011] [14:13:00] &lt;sustrik&gt;       is there, i am not familiar with how jzmq works atm</div>
<div class="line">[Saturday 01 January 2011] [14:13:09] &lt;dos000&gt;        its inherent in jni</div>
<div class="line">[Saturday 01 January 2011] [14:13:15] &lt;sustrik&gt;       i see</div>
<div class="line">[Saturday 01 January 2011] [14:13:28] &lt;sustrik&gt;       then you have to reimplement it yourself</div>
<div class="line">[Saturday 01 January 2011] [14:13:35] &lt;dos000&gt;        another option would be to receive the events via sockets in java</div>
<div class="line">[Saturday 01 January 2011] [14:13:53] &lt;sustrik&gt;       what sockets?</div>
<div class="line">[Saturday 01 January 2011] [14:14:40] &lt;dos000&gt;        instead of passing the messages via jni pass it via a the (local) netwrk interface</div>
<div class="line">[Saturday 01 January 2011] [14:15:00] &lt;dos000&gt;        of course that would be slower i imagine</div>
<div class="line">[Saturday 01 January 2011] [14:15:33] &lt;dos000&gt;        1) evtsource -&gt; zmq &#8211;&gt; jzmq &#8211;&gt; java app</div>
<div class="line">[Saturday 01 January 2011] [14:16:08] &lt;dos000&gt;        eventsource -&gt; zmq &#8211;&gt; javanio &#8211;&gt; javaapp</div>
<div class="line">[Saturday 01 January 2011] [14:17:19] &lt;dos000&gt;        anyway ...</div>
<div class="line">[Saturday 01 January 2011] [14:17:25] &lt;dos000&gt;        i will keep you updated !</div>
<div class="line">[Saturday 01 January 2011] [14:17:28] &lt;dos000&gt;        thanks a lot</div>
<div class="line">[Saturday 01 January 2011] [14:20:46] &lt;sustrik&gt;       you are welcome</div>
<div class="line">[Saturday 01 January 2011] [14:36:27] &lt;mikko&gt; happy new year all</div>
<div class="line">[Saturday 01 January 2011] [15:12:01] &lt;andrewvc&gt;      cremes: If you&#8217;re around I have a question about error_check_nonblock if you have a chance</div>
<div class="line">[Saturday 01 January 2011] [15:33:17] &lt;andrewvc&gt;      So, here&#8217;s a nonblocking question</div>
<div class="line">[Saturday 01 January 2011] [15:36:31] &lt;andrewvc&gt;      so, if I get an errno 95 doing a recv NOBLOCK</div>
<div class="line">[Saturday 01 January 2011] [15:37:18] &lt;andrewvc&gt;      what is the usual cause for that</div>
<div class="line">[Saturday 01 January 2011] [15:37:28] &lt;andrewvc&gt;      I was expecting an EAGAIN</div>
<div class="line">[Saturday 01 January 2011] [15:37:36] &lt;andrewvc&gt;      and retrying later my recv did work</div>
<div class="line">[Saturday 01 January 2011] [16:27:29] &lt;sustrik&gt;       what&#8217;s errno 95?</div>
<div class="line">[Saturday 01 January 2011] [16:59:13] &lt;andrewvc&gt;      sustrik,  #define EOPNOTSUPP  95  /* Operation not supported on transport endpoint <a href="#id1"><span class="problematic" id="id2">*</span></a>/</div>
<div class="line">[Saturday 01 January 2011] [16:59:53] &lt;andrewvc&gt;      basically, I get a notification of activity via select for a FD</div>
<div class="line">[Saturday 01 January 2011] [17:00:06] &lt;andrewvc&gt;      so I&#8217;m calling a recv ZMQ::NOBLOCK on it to see if I can read off a message</div>
<div class="line">[Saturday 01 January 2011] [17:00:08] &lt;andrewvc&gt;      and I get that</div>
<div class="line">[Saturday 01 January 2011] [17:00:29] &lt;andrewvc&gt;      i mean if I just pretend that&#8217;s an EAGAIN it works alright</div>
<div class="line">[Saturday 01 January 2011] [17:00:37] &lt;andrewvc&gt;      but just not what I expected</div>
<div class="line">[Saturday 01 January 2011] [18:23:03] &lt;neopallium&gt;    andrewvc: if you are calling recv() on a REQ/REP socket during the wrong state, you will get that error.</div>
<div class="line">[Saturday 01 January 2011] [18:24:36] &lt;neopallium&gt;    REQ/REP sockets switch back and forth from send-only to recv-only states.</div>
<div class="line">[Saturday 01 January 2011] [19:03:57] &lt;andrewvc&gt;      neopallium: it&#8217;s actually a push socket</div>
<div class="line">[Saturday 01 January 2011] [19:04:03] &lt;andrewvc&gt;      errr a pull socket I mena</div>
<div class="line">[Saturday 01 January 2011] [19:04:20] &lt;andrewvc&gt;      maybe it didn&#8217;t finish binding yet or something?</div>
<div class="line">[Saturday 01 January 2011] [19:04:28] &lt;andrewvc&gt;      though the FD did trigger</div>
<div class="line">[Saturday 01 January 2011] [19:19:37] &lt;mikko&gt; andrewvc: are you sure it&#8217;s a pull and not push socket?</div>
<div class="line">[Saturday 01 January 2011] [19:28:59] &lt;andrewvc&gt;      yeah I&#8217;m certain</div>
<div class="line">[Saturday 01 January 2011] [19:29:10] &lt;andrewvc&gt;      mikko: I&#8217;m certain because the messages eventually do start coming off</div>
<div class="line">[Saturday 01 January 2011] [19:29:19] &lt;andrewvc&gt;      I should double check though</div>
<div class="line">[Saturday 01 January 2011] [19:50:12] &lt;andrewvc&gt;      mikko: Oh how about that, I didn&#8217;t realize that was being called on both send AND recv.... Thanks for the pointer</div>
<div class="line">[Saturday 01 January 2011] [19:50:35] &lt;andrewvc&gt;      it was a PUSH after all. Thanks for recognizing that!</div>
<div class="line">[Saturday 01 January 2011] [19:51:13] &lt;mikko&gt; no prob, i think i&#8217;ve done that before as well</div>
<div class="line">[Saturday 01 January 2011] [19:51:21] &lt;andrewvc&gt;      but recv isn&#8217;t being called on it</div>
<div class="line">[Saturday 01 January 2011] [19:51:23] &lt;andrewvc&gt;      send is</div>
<div class="line">[Saturday 01 January 2011] [19:51:40] &lt;andrewvc&gt;      so, does that mean the socket isn&#8217;t in a state where it&#8217;s ready for sending I suppose</div>
<div class="line">[Saturday 01 January 2011] [19:54:57] &lt;andrewvc&gt;      mikko: Well, re-checking it I&#8217;m getting all proper codes, and EAGAIN where I expect it. I guess cleaning up my testing code must have fixed whatever the err was</div>
<div class="line">[Saturday 01 January 2011] [19:55:11] &lt;andrewvc&gt;      thanks for the help though, still good to know for later</div>
<div class="line">[Sunday 02 January 2011] [05:08:53] &lt;sustrik&gt; andrewvc: you&#8217;ve got ENOTSUPP from zmq_recv?</div>
<div class="line">[Sunday 02 January 2011] [05:11:38] &lt;sustrik&gt; looking at the code...</div>
<div class="line">[Sunday 02 January 2011] [05:12:00] &lt;sustrik&gt; hm, it can possibly happen when the socket is not yet fully initialised</div>
<div class="line">[Sunday 02 January 2011] [05:31:08] &lt;sustrik&gt; do you have a test program to reproduce it?</div>
<div class="line">[Sunday 02 January 2011] [17:20:36] &lt;<a href="#id9"><span class="problematic" id="id10">shykes_</span></a>&gt; Hello</div>
<div class="line">[Sunday 02 January 2011] [17:29:28] &lt;mikko&gt;   hi</div>
<div class="line">[Sunday 02 January 2011] [17:31:06] &lt;<a href="#id11"><span class="problematic" id="id12">shykes_</span></a>&gt; I&#8217;m weighing my options for a &#8220;smarter&#8221; req/rep device. Are you aware of any projects going in that direction?</div>
<div class="line">[Sunday 02 January 2011] [17:31:25] &lt;mikko&gt;   what do you mean by smarter?</div>
<div class="line">[Sunday 02 January 2011] [17:31:27] &lt;mikko&gt;   brb</div>
<div class="line">[Sunday 02 January 2011] [17:32:19] &lt;<a href="#id13"><span class="problematic" id="id14">shykes_</span></a>&gt; Currently we have a forwarder with bind on both sides</div>
<div class="line">[Sunday 02 January 2011] [17:32:26] &lt;<a href="#id15"><span class="problematic" id="id16">shykes_</span></a>&gt; ie dynamic workers, dynamic clients</div>
<div class="line">[Sunday 02 January 2011] [17:32:57] &lt;<a href="#id17"><span class="problematic" id="id18">shykes_</span></a>&gt; we use that to load-balance synchronous rpc. I&#8217;m guessing this is a classic use case</div>
<div class="line">[Sunday 02 January 2011] [17:34:02] &lt;<a href="#id19"><span class="problematic" id="id20">shykes_</span></a>&gt; I&#8217;d like my device to stop forwarding requests to a worker which doesn&#8217;t behave properly</div>
<div class="line">[Sunday 02 January 2011] [17:34:29] &lt;<a href="#id21"><span class="problematic" id="id22">shykes_</span></a>&gt; eg. a pre-configured timeout</div>
<div class="line">[Sunday 02 January 2011] [17:37:18] &lt;<a href="#id23"><span class="problematic" id="id24">shykes_</span></a>&gt; Maybe I could implement this as a &#8216;proxy device&#8217; in front of each worker</div>
<div class="line">[Sunday 02 January 2011] [17:38:00] &lt;<a href="#id25"><span class="problematic" id="id26">shykes_</span></a>&gt; each proxy has only one message to worry about at a time, which makes it simpler to write</div>
<div class="line">[Sunday 02 January 2011] [17:38:06] &lt;<a href="#id27"><span class="problematic" id="id28">shykes_</span></a>&gt; Any insight would be much appreciated :)</div>
<div class="line">[Sunday 02 January 2011] [19:47:25] &lt;Skaag&gt;   <a href="#id29"><span class="problematic" id="id30">shykes_</span></a>: sounds like an important and also &#8220;classical&#8221; use case to me, sounds like you need a sort of a &#8220;broker&#8221;? :-)</div>
<div class="line">[Sunday 02 January 2011] [19:48:57] &lt;<a href="#id31"><span class="problematic" id="id32">shykes_</span></a>&gt; Correct. Although I already use zmq_forwarder as a broker</div>
<div class="line">[Sunday 02 January 2011] [19:50:09] &lt;<a href="#id33"><span class="problematic" id="id34">shykes_</span></a>&gt; But before I reinvent the wheel, I&#8217;m trying to find out how much of it already exists</div>
<div class="line">[Sunday 02 January 2011] [19:50:51] &lt;<a href="#id35"><span class="problematic" id="id36">shykes_</span></a>&gt; I&#8217;m guessing a lot of people use zeromq for the same purpose as me. How did all these people implement this?</div>
<div class="line">[Sunday 02 January 2011] [19:55:14] &lt;<a href="#id37"><span class="problematic" id="id38">shykes_</span></a>&gt; Hum, I just found rabbitmq&#8217;s rmq-0mq plugin. Maybe that can help</div>
<div class="line">[Sunday 02 January 2011] [20:00:11] &lt;Skaag&gt;   we are porting our system from rabbitmq to 0mq</div>
<div class="line">[Sunday 02 January 2011] [20:00:26] &lt;Skaag&gt;   because of scaling issues</div>
<div class="line">[Sunday 02 January 2011] [20:00:43] &lt;<a href="#id39"><span class="problematic" id="id40">shykes_</span></a>&gt; Yeah, we were using rabbitmq too</div>
<div class="line">[Sunday 02 January 2011] [20:00:46] &lt;Skaag&gt;   I think the case of a &#8220;dead&#8221; machine is handled well, but a misbehaving machine, that&#8217;s another story</div>
<div class="line">[Sunday 02 January 2011] [20:01:23] &lt;Skaag&gt;   you&#8217;ll simply need to implement this yourself, or on the machine itself, decouple the process that receives the messages from the processes that do the actual work</div>
<div class="line">[Sunday 02 January 2011] [20:01:31] &lt;<a href="#id41"><span class="problematic" id="id42">shykes_</span></a>&gt; yeah</div>
<div class="line">[Sunday 02 January 2011] [20:01:39] &lt;<a href="#id43"><span class="problematic" id="id44">shykes_</span></a>&gt; sounds like less work than putting rabbitmq back into the mix :)</div>
<div class="line">[Sunday 02 January 2011] [20:01:44] &lt;Skaag&gt;   why are you using 0mq instead of the wicked rabbit if I may ask?</div>
<div class="line">[Sunday 02 January 2011] [20:02:09] &lt;Skaag&gt;   yes, also in my opinion, it is less work.</div>
<div class="line">[Sunday 02 January 2011] [20:02:16] &lt;<a href="#id45"><span class="problematic" id="id46">shykes_</span></a>&gt; A few reasons</div>
<div class="line">[Sunday 02 January 2011] [20:02:29] &lt;<a href="#id47"><span class="problematic" id="id48">shykes_</span></a>&gt; 1. We encountered problems with our Celery+RabbitMQ setup</div>
<div class="line">[Sunday 02 January 2011] [20:02:30] &lt;Skaag&gt;   I wish I knew about the shortcomings before I started implementing with rabbit...</div>
<div class="line">[Sunday 02 January 2011] [20:02:56] &lt;<a href="#id49"><span class="problematic" id="id50">shykes_</span></a>&gt; 2. We hit a major bug in the persister, which made it crash and not come back. Had to recover by hand...</div>
<div class="line">[Sunday 02 January 2011] [20:03:09] &lt;Skaag&gt;   crap</div>
<div class="line">[Sunday 02 January 2011] [20:03:15] &lt;Skaag&gt;   (and now i&#8217;m told that our 16 node cluster is considered &#8220;very large&#8221; in rabbitmq terms...)</div>
<div class="line">[Sunday 02 January 2011] [20:03:19] &lt;<a href="#id51"><span class="problematic" id="id52">shykes_</span></a>&gt; 3. I hate amqp. It&#8217;s too complicated</div>
<div class="line">[Sunday 02 January 2011] [20:03:55] &lt;Skaag&gt;   well then we agree at least on 2 and 3, and about 1 is irrelevant to our own system</div>
<div class="line">[Sunday 02 January 2011] [20:03:58] &lt;<a href="#id53"><span class="problematic" id="id54">shykes_</span></a>&gt; 4. more freedom in the topology</div>
<div class="line">[Sunday 02 January 2011] [20:04:04] &lt;Skaag&gt;   right</div>
<div class="line">[Sunday 02 January 2011] [20:04:13] &lt;<a href="#id55"><span class="problematic" id="id56">shykes_</span></a>&gt; for example, switch to multicast down the road</div>
<div class="line">[Sunday 02 January 2011] [20:04:16] &lt;Skaag&gt;   ok this gives me validation in my own path</div>
<div class="line">[Sunday 02 January 2011] [20:04:20] &lt;Skaag&gt;   yep</div>
<div class="line">[Sunday 02 January 2011] [20:04:28] &lt;Skaag&gt;   at least within a single DC</div>
<div class="line">[Sunday 02 January 2011] [20:04:37] &lt;Skaag&gt;   I believe multicast over WAN is not feasible and may never be</div>
<div class="line">[Sunday 02 January 2011] [20:04:51] &lt;<a href="#id57"><span class="problematic" id="id58">shykes_</span></a>&gt; yeah, we&#8217;re primarily on EC2 for now, so not relevant for us either</div>
<div class="line">[Sunday 02 January 2011] [20:21:22] &lt;Skaag&gt;   I constantly fail to see how EC2 helps with anything other than temporarily huge computations</div>
<div class="line">[Sunday 02 January 2011] [20:21:38] &lt;Skaag&gt;   it&#8217;s more expensive than standard hosting</div>
<div class="line">[Sunday 02 January 2011] [20:21:46] &lt;Skaag&gt;   by any calculation I made</div>
<div class="line">[Sunday 02 January 2011] [22:01:38] &lt;viraptor&gt;        hi all</div>
<div class="line">[Sunday 02 January 2011] [22:02:29] &lt;viraptor&gt;        could someone tell me where to look for information on zeromq + forking? the docs describe multithreading, but not how I should handle a fork (inherit the context or not)</div>
<div class="line">[Sunday 02 January 2011] [22:46:42] &lt;viraptor&gt;        ehh... found the answer after all... it&#8217;s &#8220;don&#8217;t share the context with fork&#8221;</div>
<div class="line">[Monday 03 January 2011] [00:46:14] &lt;jugg&gt;    with zmq 2.1.x, sockets can be shared between threads.  However, zmq_poll documentation still state that the sockets must belong to the same thread calling zmq_poll.   Is that still the case?</div>
<div class="line">[Monday 03 January 2011] [01:09:59] &lt;neopallium&gt;      jugg: with zmq 2.1 sockets can be moved between threads, but you still can&#8217;t send/recv from different threads on the same socket.</div>
<div class="line">[Monday 03 January 2011] [01:57:01] &lt;PeterTork&gt;       Question regarding the Ruby bindings. I am creating a socket, and then trying to extend it with a module. This causes it to fail in ZM.select(arrayOfSockets, nil, nil, 30) with the error <a href="#id3"><span class="problematic" id="id4">`</span></a>select&#8217;: uninitialized stream (IOError)</div>
<div class="line">[Monday 03 January 2011] [01:57:20] &lt;PeterTork&gt;       Removing the s.extend(EmptyModule) fixes this.</div>
<div class="line">[Monday 03 January 2011] [12:55:38] &lt;Seta00&gt;  I&#8217;m having lots of problems building pyzmq :(</div>
<div class="line">[Monday 03 January 2011] [12:55:57] &lt;Seta00&gt;  well, only one problem, but I can&#8217;t fix it :P</div>
<div class="line">[Monday 03 January 2011] [12:58:15] &lt;mikko&gt;   what problem are you having?</div>
<div class="line">[Monday 03 January 2011] [13:02:15] &lt;Seta00&gt;  mikko, distutils couldn&#8217;t find my vcvarsall, but I&#8217;ve just fixed it by manually returning the absolute path to it</div>
<div class="line">[Monday 03 January 2011] [13:02:42] &lt;Seta00&gt;  now I just need to put the include files on the right dirs</div>
<div class="line">[Monday 03 January 2011] [13:02:49] &lt;Seta00&gt;  and everything is good to go (I think)</div>
<div class="line">[Monday 03 January 2011] [13:06:27] &lt;Seta00&gt;  now I need a constants.pyd.manifest file</div>
<div class="line">[Monday 03 January 2011] [13:15:44] &lt;Seta00&gt;  lol I had to manually create a bunch of manifest files</div>
<div class="line">[Monday 03 January 2011] [13:18:10] &lt;Seta00&gt;  hehe finally working</div>
<div class="line">[Monday 03 January 2011] [13:25:58] &lt;Seta00&gt;  aaaand they don&#8217;t work :)</div>
<div class="line">[Monday 03 January 2011] [13:26:13] &lt;Seta00&gt;  DLL load failed: The application has failed to start because its side-by-side configuration is incorrect.</div>
<div class="line">[Monday 03 January 2011] [13:50:22] &lt;Seta00&gt;  this thing is driving me nuts, I think I&#8217;ll just use the C++ library</div>
<div class="line">[Monday 03 January 2011] [13:56:17] &lt;sustrik&gt; Seta00: try asking on the mailing list, the pyzmq guys can possibly help you</div>
<div class="line">[Monday 03 January 2011] [14:29:29] &lt;mikko&gt;   sustrik: build currently fails on sunos using gcc3</div>
<div class="line">[Monday 03 January 2011] [14:29:33] &lt;mikko&gt;   not sure if that is big deal</div>
<div class="line">[Monday 03 January 2011] [14:38:11] &lt;sustrik&gt; mikko: there&#8217;s lot of failures there...</div>
<div class="line">[Monday 03 January 2011] [14:38:38] &lt;mikko&gt;   what do you mean?</div>
<div class="line">[Monday 03 January 2011] [14:38:59] &lt;mikko&gt;   you mean sunos and gcc3 to begin with</div>
<div class="line">[Monday 03 January 2011] [14:39:00] &lt;mikko&gt;   :)</div>
<div class="line">[Monday 03 January 2011] [14:39:13] &lt;sustrik&gt; i see 8 red point on valokuva.org</div>
<div class="line">[Monday 03 January 2011] [14:39:20] &lt;sustrik&gt; points</div>
<div class="line">[Monday 03 January 2011] [14:39:45] &lt;mikko&gt;   have i broken something?</div>
<div class="line">[Monday 03 January 2011] [14:39:50] &lt;mikko&gt;   i&#8217;ll check</div>
<div class="line">[Monday 03 January 2011] [14:40:09] &lt;mikko&gt;   github was unavailable it seems</div>
<div class="line">[Monday 03 January 2011] [14:40:17] &lt;sustrik&gt; ah, yes</div>
<div class="line">[Monday 03 January 2011] [14:40:25] &lt;sustrik&gt; i&#8217;ve noticed that myself</div>
<div class="line">[Monday 03 January 2011] [14:40:41] &lt;sustrik&gt; so where should i look for console output?</div>
<div class="line">[Monday 03 January 2011] [14:41:23] &lt;mikko&gt;   <a class="reference external" href="http://build.valokuva.org/job/ZeroMQ2-core-master-SunGCC-solaris10/4/console">http://build.valokuva.org/job/ZeroMQ2-core-master-SunGCC-solaris10/4/console</a></div>
<div class="line">[Monday 03 January 2011] [14:41:27] &lt;mikko&gt;   there at the end</div>
<div class="line">[Monday 03 January 2011] [14:42:02] &lt;mikko&gt;   i looked at it last night, looks like compiler error to me</div>
<div class="line">[Monday 03 January 2011] [14:44:05] &lt;sustrik&gt; yep</div>
<div class="line">[Monday 03 January 2011] [14:44:08] &lt;sustrik&gt; let me fix it</div>
<div class="line">[Monday 03 January 2011] [14:49:56] &lt;CIA-21&gt;  zeromq2: 03Martin Sustrik 07master * r95eebbf 10/ src/sub.cpp :</div>
<div class="line">[Monday 03 January 2011] [14:49:56] &lt;CIA-21&gt;  zeromq2: sunos/gcc3 compilation issue fixed</div>
<div class="line">[Monday 03 January 2011] [14:49:56] &lt;CIA-21&gt;  zeromq2: Signed-off-by: Martin Sustrik &lt;<a class="reference external" href="mailto:sustrik&#37;&#52;&#48;250bpm&#46;com">sustrik<span>&#64;</span>250bpm<span>&#46;</span>com</a>&gt; - <a class="reference external" href="http://bit.ly/ezkv67">http://bit.ly/ezkv67</a></div>
<div class="line">[Monday 03 January 2011] [14:50:02] &lt;sustrik&gt; mikko: try now</div>
<div class="line">[Monday 03 January 2011] [16:07:50] &lt;mikko&gt;   sustrik: i&#8217;ll kick a build</div>
<div class="line">[Monday 03 January 2011] [16:08:16] &lt;mikko&gt;   building</div>
<div class="line">[Monday 03 January 2011] [16:16:11] &lt;mikko&gt;   passes</div>
<div class="line">[Monday 03 January 2011] [16:18:26] &lt;sustrik&gt; great</div>
<div class="line">[Monday 03 January 2011] [16:26:09] &lt;Thomas_aboutus&gt;  I have what I&#8217;m sure is a super-noob question, but I&#8217;ve been over the docs a hundred times and can&#8217;t figure out what I&#8217;m doing wrong. If someone can help me that would rock!</div>
<div class="line">[Monday 03 January 2011] [16:26:48] &lt;Thomas_aboutus&gt;  I am trying to make a simple pub/sub setup. I have the code here: <a class="reference external" href="https://gist.github.com/763990">https://gist.github.com/763990</a>   For some reason, the subscriber never receives messages from the publisher. The code in the gist is as simple as I could make it for clarities sake.</div>
<div class="line">[Monday 03 January 2011] [16:36:08] &lt;mikko&gt;   Thomas_aboutus: both sockets connect</div>
<div class="line">[Monday 03 January 2011] [16:37:39] &lt;mikko&gt;   change the pub to bind and it should work</div>
<div class="line">[Monday 03 January 2011] [16:40:05] &lt;Thomas_aboutus&gt;  Wow... Thank you.</div>
<div class="line">[Monday 03 January 2011] [16:40:07] &lt;Thomas_aboutus&gt;  :)</div>
<div class="line">[Tuesday 04 January 2011] [00:42:35] &lt;jugg&gt;   I&#8217;ve done some work updating the zmq erlang bindings, for the most part things are working well now, but I&#8217;m running into issues with events on the socket FD (that was retrieved using ZMQ_FD getsockopt).  question: Can the FD be used in poll/select in one thread while the Socket is being used in other thread?  eg. the erlang vm sits on the FD in the poll/select call while waiting for an event and in the mean time other socket operations may be performe</div>
<div class="line">[Tuesday 04 January 2011] [01:45:35] &lt;sustrik&gt;        jugg: no</div>
<div class="line">[Tuesday 04 January 2011] [01:45:41] &lt;sustrik&gt;        sockets are not thread safe</div>
<div class="line">[Tuesday 04 January 2011] [01:46:02] &lt;sustrik&gt;        you can access a socket from at most one thread at a time</div>
<div class="line">[Tuesday 04 January 2011] [01:48:40] &lt;jugg&gt;   Is this zmq specific, or (I&#8217;ve not yet been able to find an answer) is it the case that a normal file descriptor would have problems if one thread used it in a poll() call, while another thread tried to read/write to it?</div>
<div class="line">[Tuesday 04 January 2011] [01:49:31] &lt;sustrik&gt;        normal FDs are thread safe</div>
<div class="line">[Tuesday 04 January 2011] [01:50:16] &lt;sustrik&gt;        0mq is special as it uses lock-free algorithms</div>
<div class="line">[Tuesday 04 January 2011] [01:50:32] &lt;sustrik&gt;        thus, it cannot synchronise the access using mutex or somesuch</div>
<div class="line">[Tuesday 04 January 2011] [01:51:32] &lt;sustrik&gt;        you can apply a mutex on top of it yourself, if that&#8217;s what you need</div>
<div class="line">[Tuesday 04 January 2011] [01:51:40] &lt;sustrik&gt;        but be aware of the performance impact</div>
<div class="line">[Tuesday 04 January 2011] [01:51:42] &lt;jugg&gt;   What makes the socket FD different than a normal FD in this regards?</div>
<div class="line">[Tuesday 04 January 2011] [01:51:51] &lt;jugg&gt;   No, that isn&#8217;t an option for the erlang bindings...</div>
<div class="line">[Tuesday 04 January 2011] [01:59:51] &lt;neopallium&gt;     jugg: the 0mq FD is just a socketpair to sent notices that there are messages/commands to read from the socket&#8217;s queue.</div>
<div class="line">[Tuesday 04 January 2011] [02:00:47] &lt;neopallium&gt;     the message data you get from recv() is transferred in-memory from a lock-free queue, not over the socketpair.</div>
<div class="line">[Tuesday 04 January 2011] [02:02:58] &lt;neopallium&gt;     jugg: are you making a erlang port or a linked-in driver?</div>
<div class="line">[Tuesday 04 January 2011] [02:03:30] &lt;jugg&gt;   linked-in driver - its based off of the broken erlzmq bindings.</div>
<div class="line">[Tuesday 04 January 2011] [02:10:39] &lt;jugg&gt;   So if the socket FD is a socketpair, what makes it not usable in a poll call from one thread while another thread uses the socket?  Does zmq listen for events on the socket internally (outside of zmq_poll itself)?</div>
<div class="line">[Tuesday 04 January 2011] [02:11:45] &lt;sustrik&gt;        jugg: yes, it does so in zmq_send, zmq_recv and alike</div>
<div class="line">[Tuesday 04 January 2011] [02:12:50] &lt;jugg&gt;   ok... well, time to approach the erlang binding architecture differently then... :/</div>
<div class="line">[Tuesday 04 January 2011] [02:14:09] &lt;neopallium&gt;     sustrik: if the polling thread just calls poll() and not any zmq_* functions like zmq_poll(), would it still cause an issue?</div>
<div class="line">[Tuesday 04 January 2011] [02:14:33] &lt;jugg&gt;   if other parts of zmq consume the socketpair events, then yes...</div>
<div class="line">[Tuesday 04 January 2011] [02:14:35] &lt;neopallium&gt;     jugg: what is your polling thread doing with the events it gets back from the 0mq FD?</div>
<div class="line">[Tuesday 04 January 2011] [02:15:04] &lt;jugg&gt;   Notifies the socket owner thread and event occurred.</div>
<div class="line">[Tuesday 04 January 2011] [02:16:12] &lt;jugg&gt;   and =&gt; an</div>
<div class="line">[Tuesday 04 January 2011] [02:16:38] &lt;neopallium&gt;     ok, even if the owner thread gets a old POLLIN or POLLOUT event it can still try to call zmq_send/zmq_recv() with the NOBLOCK flag.</div>
<div class="line">[Tuesday 04 January 2011] [02:16:59] &lt;neopallium&gt;     it will just get an EAGAIN if it had already comsumed the event.</div>
<div class="line">[Tuesday 04 January 2011] [02:17:10] &lt;jugg&gt;   the problem is that it does not get a POLLIN/OUT event - as it appears the zmq internals are consuming those events...</div>
<div class="line">[Tuesday 04 January 2011] [02:17:23] &lt;jugg&gt;   which from sustrik&#8217;s statement confirms this.</div>
<div class="line">[Tuesday 04 January 2011] [02:17:32] &lt;neopallium&gt;     do you use the NOBLOCK flag?</div>
<div class="line">[Tuesday 04 January 2011] [02:18:09] &lt;jugg&gt;   I don&#8217;t see the relevance... the problem is the erlang poll is not being signaled an event occurred...</div>
<div class="line">[Tuesday 04 January 2011] [02:18:56] &lt;neopallium&gt;     your owner thread should be calling zmq_send()/zmq_recv() with the NOBLOCK flag, and only if it get EAGAIN, do it wait for an event notice from the polling thread.</div>
<div class="line">[Tuesday 04 January 2011] [02:18:57] &lt;sustrik&gt;        neopallium: getsockopt(ZMQ_EVENTS) consumes events from the socket pair</div>
<div class="line">[Tuesday 04 January 2011] [02:19:27] &lt;neopallium&gt;     sustrik: yes, and he should only call that from the owner thread not the poller thread.</div>
<div class="line">[Tuesday 04 January 2011] [02:20:39] &lt;sustrik&gt;        jugg: why do you need to combine recv and poll from different threads</div>
<div class="line">[Tuesday 04 January 2011] [02:20:52] &lt;sustrik&gt;        (i know, erlang is tricky)</div>
<div class="line">[Tuesday 04 January 2011] [02:21:46] &lt;sustrik&gt;        neopallium: i assume the problem is how erlang VM works</div>
<div class="line">[Tuesday 04 January 2011] [02:21:55] &lt;sustrik&gt;        it&#8217;s kind of thread-agnostic</div>
<div class="line">[Tuesday 04 January 2011] [02:22:27] &lt;neopallium&gt;     jugg: have you tried an external C port?  it would make this must similar.</div>
<div class="line">[Tuesday 04 January 2011] [02:23:47] &lt;neopallium&gt;     sustrik: yeah, the book I have on erlang doesn&#8217;t have much details about how the linked-in driver interface is effected by any internal threads that the erlang VM might have.</div>
<div class="line">[Tuesday 04 January 2011] [02:25:29] &lt;sustrik&gt;        the erlang binding is a troublesome one</div>
<div class="line">[Tuesday 04 January 2011] [02:25:39] &lt;sustrik&gt;        originally it was written by shammika pathirana</div>
<div class="line">[Tuesday 04 January 2011] [02:25:44] &lt;jugg&gt;   the only way to wait on an event in erlang is to provide the fd to the erlang vm.  The erlang vm, then calls the driver callback routine input/output_ready depending on the event type.  The callback is an arbitrary thread.   That callback checks the fd if an even actually occurred on the socket using getsockopt(ZMQ_EVENTS), and if so, then sends a notification back into the erlang world notifying an erlang process which owns the socket.  That erlang pr</div>
<div class="line">[Tuesday 04 January 2011] [02:25:51] &lt;sustrik&gt;        who had no erlang experience at the time afaik</div>
<div class="line">[Tuesday 04 January 2011] [02:26:06] &lt;sustrik&gt;        then it was fixed by serge aleynikov</div>
<div class="line">[Tuesday 04 January 2011] [02:26:26] &lt;sustrik&gt;        later on we&#8217;ve created some fixes when working on RabbitMQ/0MQ bridge with VMWare</div>
<div class="line">[Tuesday 04 January 2011] [02:26:29] &lt;neopallium&gt;     jugg: are you sure the vm is using a different polling thread from the callbacks?</div>
<div class="line">[Tuesday 04 January 2011] [02:26:32] &lt;sustrik&gt;        this are not yet in</div>
<div class="line">[Tuesday 04 January 2011] [02:26:34] &lt;sustrik&gt;        etc.</div>
<div class="line">[Tuesday 04 January 2011] [02:27:21] &lt;jugg&gt;   neopallium, the callback gets called from arbitrary threads... I don&#8217;t know for sure if the poll is happening in the same thread or not.</div>
<div class="line">[Tuesday 04 January 2011] [02:28:54] &lt;sustrik&gt;        what about an alternative architecture: poll on FD, when signaled remove it from the pollset then read, when read is done, return it to the pollset</div>
<div class="line">[Tuesday 04 January 2011] [02:29:09] &lt;neopallium&gt;     jugg: why not do the zmq_recv() in the output_ready() callback instead of sending a notice to the erlang process (which is not a real thread/process).</div>
<div class="line">[Tuesday 04 January 2011] [02:30:17] &lt;jugg&gt;   sustrik, I&#8217;m already half way down that path...</div>
<div class="line">[Tuesday 04 January 2011] [02:30:58] &lt;neopallium&gt;     even if you are sending a notice back to the erlang process (saying hay you can read now), that erlang process will just send a port command which will be delivered to the port</div>
<div class="line">[Tuesday 04 January 2011] [02:30:59] &lt;jugg&gt;   neopallium, that has issues with multi-part messages...</div>
<div class="line">[Tuesday 04 January 2011] [02:31:19] &lt;neopallium&gt;     the ports callbacks should be restricted to one thread.</div>
<div class="line">[Tuesday 04 January 2011] [02:31:36] &lt;neopallium&gt;     I don&#8217;t see any warnings that linked-in drivers need to be thread-safe.</div>
<div class="line">[Tuesday 04 January 2011] [02:32:45] &lt;neopallium&gt;     jugg: do you deliver each part of the message in a different message back to the controlling process?</div>
<div class="line">[Tuesday 04 January 2011] [02:33:47] &lt;jugg&gt;   each erlzmq recv call acts just like zmq_recv.  It&#8217;ll return each part separately.</div>
<div class="line">[Tuesday 04 January 2011] [02:34:58] &lt;sustrik&gt;        jugg: btw, there&#8217;s a problem with erlzmq project now; as i&#8217;ve mentioned dhammika is not really an erlang guy and serge has unrelated problems now that prevent him from doing stuff</div>
<div class="line">[Tuesday 04 January 2011] [02:35:18] &lt;sustrik&gt;        in case you are interested i can give you commit access...</div>
<div class="line">[Tuesday 04 January 2011] [02:36:32] &lt;jugg&gt;   sustrik, let me get this working successfully, and I&#8217;ll ping you then for access.</div>
<div class="line">[Tuesday 04 January 2011] [02:37:07] &lt;sustrik&gt;        jugg: ok, good</div>
<div class="line">[Tuesday 04 January 2011] [02:38:31] &lt;sustrik&gt;        there&#8217;s also VMware patch that solves the sender-side backpressure IIRC</div>
<div class="line">[Tuesday 04 January 2011] [02:38:40] &lt;jugg&gt;   sustrik, just to clarify something.. you said getsockopt(ZMQ_EVENTS) consumes the socketpair events... do you mean payload or events that would trigger a waiting poll call?</div>
<div class="line">[Tuesday 04 January 2011] [02:38:40]   * sustrik makes a mental note that it has to be applied</div>
<div class="line">[Tuesday 04 January 2011] [02:39:30] &lt;sustrik&gt;        it consumes internal 0mq events from the socket pair</div>
<div class="line">[Tuesday 04 January 2011] [02:39:49] &lt;neopallium&gt;     jugg: it reads from the socketpair which will consume the POLLIN event from the FD</div>
<div class="line">[Tuesday 04 January 2011] [02:40:26] &lt;sustrik&gt;        let me give an overvirew of the achitecture</div>
<div class="line">[Tuesday 04 January 2011] [02:40:39] &lt;sustrik&gt;        the actual TCP sockets are handled by background threads</div>
<div class="line">[Tuesday 04 January 2011] [02:40:49] &lt;sustrik&gt;        making sending/receiving messages asynchronous</div>
<div class="line">[Tuesday 04 January 2011] [02:41:20] &lt;sustrik&gt;        the user&#8217;s thread communicates with background (I/O) threads using so called &#8216;commands&#8217;</div>
<div class="line">[Tuesday 04 January 2011] [02:41:41] &lt;sustrik&gt;        these are sent via a socketpair connecting the user thread and the I/O thread</div>
<div class="line">[Tuesday 04 January 2011] [02:42:14] &lt;sustrik&gt;        example of a command sent from I/O thread to user&#8217;s thread would be &#8220;there are messages available for reading&#8221;</div>
<div class="line">[Tuesday 04 January 2011] [02:43:02] &lt;sustrik&gt;        when user&#8217;s thread get that command it knows it can unblock (in case it&#8217;s blocked in recv) and read new messages from the lock-free queue</div>
<div class="line">[Tuesday 04 January 2011] [02:43:16] &lt;sustrik&gt;        that&#8217;s more or less it</div>
<div class="line">[Tuesday 04 January 2011] [02:45:48] &lt;jugg&gt;   are socketpairs ever shared with multiple zmq sockets?</div>
<div class="line">[Tuesday 04 January 2011] [02:46:18] &lt;jugg&gt;   or does every zmq socket have its own socketpair?</div>
<div class="line">[Tuesday 04 January 2011] [02:46:57] &lt;sustrik&gt;        every socket has it&#8217;s own socketpair</div>
<div class="line">[Tuesday 04 January 2011] [02:47:11] &lt;sustrik&gt;        this is needed to be able to migrate sockets between threads</div>
<div class="line">[Tuesday 04 January 2011] [02:47:33] &lt;sustrik&gt;        so, to be precise, in 2.0.x multiple sockets share single socketpair</div>
<div class="line">[Tuesday 04 January 2011] [02:47:53] &lt;sustrik&gt;        in 2.1 there&#8217;s one socketpair per 0mq socket</div>
<div class="line">[Tuesday 04 January 2011] [02:50:46] &lt;jugg&gt;   ok.  Thanks, this helps my mental picture.  I have a couple of approaches to test out now.</div>
<div class="line">[Tuesday 04 January 2011] [02:51:43] &lt;sustrik&gt;        good luck :)</div>
<div class="line">[Tuesday 04 January 2011] [02:52:30] &lt;sustrik&gt;        ah, btw, erlang binding works with 2.1 only anyway</div>
<div class="line">[Tuesday 04 January 2011] [02:52:53] &lt;sustrik&gt;        so you don&#8217;t have to take the case where the socketpair is shared between sockets into account</div>
<div class="line">[Tuesday 04 January 2011] [02:54:24] &lt;jugg&gt;   yes</div>
<div class="line">[Tuesday 04 January 2011] [02:59:03] &lt;neopallium&gt;     jugg: I think you should only register events with driver_select() when the 0mq socket is blocked as reported by ZMQ_EVENTS.</div>
<div class="line">[Tuesday 04 January 2011] [02:59:47] &lt;neopallium&gt;     and when you are waiting for an event back from the vm don&#8217;t call zmq_recv() or ZMQ_EVENTS until the event comes back.</div>
<div class="line">[Tuesday 04 January 2011] [03:00:15] &lt;jugg&gt;   that is interesting</div>
<div class="line">[Tuesday 04 January 2011] [03:00:20] &lt;neopallium&gt;     that way the owner thread can&#8217;t consume events from the socketpair.</div>
<div class="line">[Tuesday 04 January 2011] [03:01:32] &lt;neopallium&gt;     I found the details about driver&#8217;s and erlang threads.</div>
<div class="line">[Tuesday 04 January 2011] [03:01:54] &lt;neopallium&gt;     and by default the driver will only have one thread access it at a time.</div>
<div class="line">[Tuesday 04 January 2011] [03:02:19] &lt;neopallium&gt;     you can do locking at driver or port level, the default is locking at the driver level.</div>
<div class="line">[Tuesday 04 January 2011] [03:03:19] &lt;neopallium&gt;     if you don&#8217;t share 0mq sockets between ports it should be possible to use port-level locking.</div>
<div class="line">[Tuesday 04 January 2011] [03:04:26] &lt;neopallium&gt;     also remember to remove the event notice from the socket after receiving the event and mark the socket as readable/writable.</div>
<div class="line">[Tuesday 04 January 2011] [03:05:38] &lt;neopallium&gt;     sustrik basically said the same thing earlier about removing the socket from the pollset (i.e. from driver_select()) when it is readable.</div>
<div class="line">[Tuesday 04 January 2011] [03:06:50] &lt;jugg&gt;   I&#8217;m not sure what you meant by &#8220;remove the event notice&#8221;... are you talking an implementation concept, or an erlang requirement?</div>
<div class="line">[Tuesday 04 January 2011] [03:07:44] &lt;neopallium&gt;     jugg: driver_select(port, event, mode, /* put 0 here. <a href="#id5"><span class="problematic" id="id6">*</span></a>/)</div>
<div class="line">[Tuesday 04 January 2011] [03:08:14] &lt;neopallium&gt;     that last arg. is for clearing the event (i.e. removing it from the pollset)</div>
<div class="line">[Tuesday 04 January 2011] [03:09:27] &lt;jugg&gt;   yes.  But my understanding is (although it has been hard to find supporting evidence) that it isn&#8217;t a requirement normally to do that in order for the erlang vm to report subsequent events on a fd.</div>
<div class="line">[Tuesday 04 January 2011] [03:10:17] &lt;neopallium&gt;     jugg: is your current problem that you are not receiving an event from the vm?</div>
<div class="line">[Tuesday 04 January 2011] [03:11:22] &lt;jugg&gt;   yes, but I think between sustrik&#8217;s comment on getsockopt(ZMQ_EVENTS) consuming events, and his description on how things work, I can see why that is the case...</div>
<div class="line">[Tuesday 04 January 2011] [03:11:25] &lt;neopallium&gt;     0mq sockets are edge-triggered, that means you need to read from them until they will block (i.e. you get EAGAIN)</div>
<div class="line">[Tuesday 04 January 2011] [03:11:33] &lt;jugg&gt;   yes</div>
<div class="line">[Tuesday 04 January 2011] [03:12:57] &lt;neopallium&gt;     when your driver call getsockopt(ZMQ_EVENTS) and it says there is a message to read, then you need to mark the socket as readable, until you read a full message.</div>
<div class="line">[Tuesday 04 January 2011] [03:13:48] &lt;neopallium&gt;     once you read a full message call ZMQ_EVENTS again to check if there is another message to read, if it reports &#8220;no messages&#8221;, then you wait for a read event from the vm.</div>
<div class="line">[Tuesday 04 January 2011] [03:14:32] &lt;neopallium&gt;     I think there was an example in the guide that use ZMQ_EVENTS like that.</div>
<div class="line">[Tuesday 04 January 2011] [03:14:54] &lt;sustrik&gt;        yes, more or less</div>
<div class="line">[Tuesday 04 January 2011] [03:15:06] &lt;sustrik&gt;        but you don&#8217;t have to store the &#8220;readable&#8221; flag yourself</div>
<div class="line">[Tuesday 04 January 2011] [03:15:30] &lt;sustrik&gt;        you can retrieve it from 0mq by calling getsockop(ZMQ_EVENTS) actually</div>
<div class="line">[Tuesday 04 January 2011] [03:15:33] &lt;jugg&gt;   yes, I think the key is to implement a poll method which checks ZMQ_EVENTS prior to passing the fd to the erlang vm, and only do so if nothing is pending.</div>
<div class="line">[Tuesday 04 January 2011] [03:15:52] &lt;sustrik&gt;        yes</div>
<div class="line">[Tuesday 04 January 2011] [03:17:53] &lt;neopallium&gt;     jugg: is this driver pushing messages out to the controlling erlang process?  or does the erlang process block in a recv() type function for each message?</div>
<div class="line">[Tuesday 04 January 2011] [03:22:17] &lt;jugg&gt;   the driver returns messages only if the erlang process requests it via recv().   Of course, driver does not block in the recv() call, as that&#8217;d freeze the vm.  It later pushes the incoming message when it comes available - thus the driver must use the fd to be notified of such an event.  A gen_server is used to ensure further requests to the driver is not made, and the calling erlang process is blocked in the gen_server call until the driver eventually</div>
<div class="line">[Tuesday 04 January 2011] [03:22:56] &lt;jugg&gt;   of course the erlang process can call a non blocking recv as well.</div>
<div class="line">[Tuesday 04 January 2011] [03:23:25] &lt;jugg&gt;   (the old erlzmq did not support that last)</div>
<div class="line">[Tuesday 04 January 2011] [03:27:15] &lt;jugg&gt;   sustrik, does one only use the socketpair fd with POLLIN?  even if waiting for the zmq socket to become writeable?</div>
<div class="line">[Tuesday 04 January 2011] [03:28:10] &lt;neopallium&gt;     jugg: so the erlang sends the port a {call, recv} type message telling it to call zmq_recv() and send back a part of the message.</div>
<div class="line">[Tuesday 04 January 2011] [03:28:18] &lt;sustrik&gt;        jugg: yes</div>
<div class="line">[Tuesday 04 January 2011] [03:28:25] &lt;sustrik&gt;        POLLOUT makes no sense</div>
<div class="line">[Tuesday 04 January 2011] [03:28:31] &lt;jugg&gt;   sustrik, ok</div>
<div class="line">[Tuesday 04 January 2011] [03:29:55] &lt;jugg&gt;   neopallium, the driver will always call zmq_recv with NOBLOCK.  But if the erlang requests did not specify NOBLOCK, and zmq_recv returns EAGAIN, then the driver calls driver_select on the socket fd, and waits for an event, at which point it reads from the socket and returns the received message part to the erlang process.</div>
<div class="line">[Tuesday 04 January 2011] [03:29:56] &lt;neopallium&gt;     sustrik: so if the 0mq socket blocks on zmq_send(), do you have to wait for a POLLIN from the socketpair and the check with ZMQ_EVENTS if the socket is writable?</div>
<div class="line">[Tuesday 04 January 2011] [03:30:14] &lt;sustrik&gt;        yes</div>
<div class="line">[Tuesday 04 January 2011] [03:30:35] &lt;sustrik&gt;        the underlying socketpair is actually used for uni-directional transfer of commands</div>
<div class="line">[Tuesday 04 January 2011] [03:30:42] &lt;neopallium&gt;     ok, I need to fix my Lua async handler for 0mq sockets.</div>
<div class="line">[Tuesday 04 January 2011] [03:30:43] &lt;sustrik&gt;        so POLLOUT is always signaled</div>
<div class="line">[Tuesday 04 January 2011] [03:31:18] &lt;sustrik&gt;        i think it&#8217;s mentioned in the reference</div>
<div class="line">[Tuesday 04 January 2011] [03:31:20] &lt;sustrik&gt;        let me check</div>
<div class="line">[Tuesday 04 January 2011] [03:31:24] &lt;jugg&gt;   sustrik, the docs could be clarified on that regards... It kind of says so, but it was unclear.</div>
<div class="line">[Tuesday 04 January 2011] [03:31:28] &lt;neopallium&gt;     yeah, I am basically doing a POLLOUT on the socketpair when zmq_send() returns EAGAIN.</div>
<div class="line">[Tuesday 04 January 2011] [03:32:07] &lt;neopallium&gt;     it is hard to test blocking on zmq_send()</div>
<div class="line">[Tuesday 04 January 2011] [03:32:17] &lt;jugg&gt;   indeed :/</div>
<div class="line">[Tuesday 04 January 2011] [03:32:42] &lt;sustrik&gt;        &#8220;0MQ library shall signal any pending events on the socket in an edge-triggered fashion by making the file descriptor become ready for reading&#8221;</div>
<div class="line">[Tuesday 04 January 2011] [03:33:00] &lt;sustrik&gt;        how would you reprharse that?</div>
<div class="line">[Tuesday 04 January 2011] [03:33:47] &lt;neopallium&gt;     .... signal any pending events from getsockopt(ZMQ_EVENTS...) when the FD is readable?</div>
<div class="line">[Tuesday 04 January 2011] [03:34:13] &lt;sustrik&gt;        i don&#8217;t understand that :)</div>
<div class="line">[Tuesday 04 January 2011] [03:34:17] &lt;sustrik&gt;        maybe 2 sentences?</div>
<div class="line">[Tuesday 04 January 2011] [03:34:51] &lt;neopallium&gt;     it needs to say something about calling getsockopt(ZMQ_EVENTS...) for the ready events.</div>
<div class="line">[Tuesday 04 January 2011] [03:35:28] &lt;sustrik&gt;        &#8220;The ability to read from the returned file descriptor does not necessarily indicate that messages are available to be read from, or can be written to, the underlying socket; applications</div>
<div class="line">[Tuesday 04 January 2011] [03:35:29] &lt;sustrik&gt;                   must retrieve the actual event state with a subsequent retrieval of the ZMQ_EVENTS option.&#8221;</div>
<div class="line">[Tuesday 04 January 2011] [03:35:43] &lt;sustrik&gt;        see zmq_getsockopt(3)</div>
<div class="line">[Tuesday 04 January 2011] [03:36:42] &lt;neopallium&gt;     how about something like: &#8220;0MQ library shall signal any pending events by making the FD readable, getsockopt(ZMQ_EVENTS...) returns which events are pending.&#8221;</div>
<div class="line">[Tuesday 04 January 2011] [03:37:09] &lt;sustrik&gt;        that&#8217;s better</div>
<div class="line">[Tuesday 04 January 2011] [03:37:26] &lt;neopallium&gt;     yeah, but not perfect</div>
<div class="line">[Tuesday 04 January 2011] [03:37:28] &lt;sustrik&gt;        but kind of duplicates what the note above says</div>
<div class="line">[Tuesday 04 January 2011] [03:38:42] &lt;sustrik&gt;        have a look at whole ZMQ_FD section and feel free to propose a better wording</div>
<div class="line">[Tuesday 04 January 2011] [03:40:28] &lt;neopallium&gt;     hmm, yeah I guess the original dues say that in the Note</div>
<div class="line">[Tuesday 04 January 2011] [03:41:49] &lt;neopallium&gt;     maybe just add a note that checking for POLLOUT on the FD is use-less for finding out if it is writable?</div>
<div class="line">[Tuesday 04 January 2011] [03:42:27] &lt;jugg&gt;   is it the case to mark the socketpair FD read, one must call getsockopt(ZMQ_EVENTS), else subsequent calls to poll will always return immediately?</div>
<div class="line">[Tuesday 04 January 2011] [03:44:51] &lt;neopallium&gt;     jugg: if you get a POLLIN event from poll() you will need to call getsockopt(ZMQ_EVENTS) to clear that event, or you will just keep getting the POLLIN.</div>
<div class="line">[Tuesday 04 January 2011] [03:46:38] &lt;neopallium&gt;     I think from a simple event loop it would be best to call getsockopt(ZMQ_EVENTS) on each POLLIN event and then dispatch the real POLLIN/POLLOUT events as returned from getsockopt(ZMQ_EVENTS).</div>
<div class="line">[Tuesday 04 January 2011] [03:47:10] &lt;neopallium&gt;     that is what I am going to try with my async. handlers.</div>
<div class="line">[Tuesday 04 January 2011] [03:49:50] &lt;sustrik&gt;        jugg: the event is cleared also when you call non-blocking recv() which returns with EAGAIN</div>
<div class="line">[Tuesday 04 January 2011] [04:26:50] &lt;mikko&gt;  good morning</div>
<div class="line">[Tuesday 04 January 2011] [04:53:03] &lt;sustrik&gt;        morning</div>
<div class="line">[Tuesday 04 January 2011] [04:57:17] &lt;mikko&gt;  hmm, [zeromq-dev] Segfault</div>
<div class="line">[Tuesday 04 January 2011] [04:57:26] &lt;mikko&gt;  looks like to be related to the HWM bug we discussed ages ago</div>
<div class="line">[Tuesday 04 January 2011] [04:58:05] &lt;sustrik&gt;        mikko: the one you&#8217;ve gave me the test case for?</div>
<div class="line">[Tuesday 04 January 2011] [04:58:24] &lt;mikko&gt;  sustrik: i think so</div>
<div class="line">[Tuesday 04 January 2011] [04:58:30] &lt;sustrik&gt;        i&#8217;ve looked into that but the problem was not obvious</div>
<div class="line">[Tuesday 04 January 2011] [04:58:47] &lt;sustrik&gt;        i&#8217;ll have to look at it further</div>
<div class="line">[Tuesday 04 January 2011] [04:58:59] &lt;mikko&gt;  man, year after year it&#8217;s harder to come back to work after holidays</div>
<div class="line">[Tuesday 04 January 2011] [04:59:27] &lt;sustrik&gt;        same here :)</div>
<div class="line">[Tuesday 04 January 2011] [05:15:22] &lt;neopallium&gt;     I hit this assertion in zeromq: Assertion failed: <a href="#id59"><span class="problematic" id="id60">msg_</span></a>-&gt;flags &amp; ZMQ_MSG_MORE (rep.cpp:80)</div>
<div class="line">[Tuesday 04 January 2011] [05:15:53] &lt;neopallium&gt;     that is from a REP socket with a XREQ client.</div>
<div class="line">[Tuesday 04 January 2011] [05:16:27] &lt;neopallium&gt;     is it bad to connect a XREQ socket to a REP socket?</div>
<div class="line">[Tuesday 04 January 2011] [05:18:37] &lt;neopallium&gt;     hmm, looks like XREQ -&gt; REP is a supported setup.</div>
<div class="line">[Tuesday 04 January 2011] [05:23:25] &lt;jugg&gt;   I believe REP socket expects at least two message parts, but three is needed.  &lt;msg id&gt; &lt;empty msg&gt; &lt;msg body&gt;.  Both &lt;msg id&gt; and &lt;empty msg&gt; should be sent with SNDMORE flag set.</div>
<div class="line">[Tuesday 04 January 2011] [05:26:55] &lt;jugg&gt;   basically, your application code on the xreq side passes in &lt;msg body&gt; (in one or more parts).  The xreq wrapper layer must then provide an identifier for that &lt;msg body&gt; and send that along to the rep socket, along with an empty message so that the rep socket and delineate between id parts and body parts.  When the rep socket responds, your xrep wrapper layer pulls off the msg id part and looks up who to route the body part to.</div>
<div class="line">[Tuesday 04 January 2011] [05:28:28] &lt;jugg&gt;   &#8221;...so that the rep socket can delineate..&#8221;</div>
<div class="line">[Tuesday 04 January 2011] [05:29:20] &lt;neopallium&gt;     jugg: yup, REQ/REP sockets hid the &#8220;address&#8221; part of the message, XREQ/XREP expose the &#8220;address&#8221; part.</div>
<div class="line">[Tuesday 04 January 2011] [05:30:00] &lt;neopallium&gt;     I am trying a manual example with the plain lua-zmq bindings to make sure it is not just my use of zmq that is cause it.</div>
<div class="line">[Tuesday 04 January 2011] [05:30:15] &lt;jugg&gt;   so, you were already sending along the message id and blank msg?</div>
<div class="line">[Tuesday 04 January 2011] [05:30:37] &lt;jugg&gt;   with SNDMORE set?</div>
<div class="line">[Tuesday 04 January 2011] [05:31:39] &lt;neopallium&gt;     testing that right now, making a minimal example.</div>
<div class="line">[Tuesday 04 January 2011] [05:41:29] &lt;neopallium&gt;     jugg: <a class="reference external" href="https://gist.github.com/764629">https://gist.github.com/764629</a></div>
<div class="line">[Tuesday 04 January 2011] [05:42:33] &lt;neopallium&gt;     also sometime I got a crash on the XREQ side.</div>
<div class="line">[Tuesday 04 January 2011] [05:42:49] &lt;neopallium&gt;     but not an assertion, just a core dump.</div>
<div class="line">[Tuesday 04 January 2011] [05:43:23] &lt;jugg&gt;   I believe the delim needs to be empty, zero bytes.  You are sending a single byte.</div>
<div class="line">[Tuesday 04 January 2011] [05:43:46] &lt;jugg&gt;   try: s:send(&#8220;&#8221;, zmq.SNDMORE)</div>
<div class="line">[Tuesday 04 January 2011] [05:44:13] &lt;neopallium&gt;     ah, yeah, I just tried that and it worked</div>
<div class="line">[Tuesday 04 January 2011] [05:44:18] &lt;jugg&gt;   cool</div>
<div class="line">[Tuesday 04 January 2011] [05:44:41] &lt;neopallium&gt;     I don&#8217;t know where I read to send &#8220;0&#8221; as the delim. part</div>
<div class="line">[Tuesday 04 January 2011] [06:05:25] &lt;orestis&gt;        Hello, I&#8217;m wondering how 0mq fits in with a GUI event loop - is it safe to make 0mq requests from the GUI thread?</div>
<div class="line">[Tuesday 04 January 2011] [06:05:48] &lt;mikko&gt;  orestis: you mean whether it would block?</div>
<div class="line">[Tuesday 04 January 2011] [06:06:39] &lt;mikko&gt;  orestis: can you integrate external filehandle polling to your gui event loop?</div>
<div class="line">[Tuesday 04 January 2011] [06:06:59] &lt;mikko&gt;  you can get ZMQ_FD from the socket and use that event loop</div>
<div class="line">[Tuesday 04 January 2011] [06:07:08] &lt;mikko&gt;  then in the callback check for ZMQ_EVENTS</div>
<div class="line">[Tuesday 04 January 2011] [06:29:35] &lt;orestis&gt;        Thanks. That looks a bit too cutting-edge for my taste. I guess my original question was, are the 0mq send/receive calls async? I&#8217;m a bit confused because there are mentions of background threads.</div>
<div class="line">[Tuesday 04 January 2011] [06:33:19] &lt;mikko&gt;  orestis: send/recv is async yes but there is a possiblity that the calls block</div>
<div class="line">[Tuesday 04 January 2011] [06:33:27] &lt;mikko&gt;  unless ZMQ_NOBLOCK is used</div>
<div class="line">[Tuesday 04 January 2011] [06:37:16] &lt;orestis&gt;        Thanks. In general, is 0mq a bit more low-level for doing async I/O from something like Twisted (that gives you Deferreds, Callbacks etc)?</div>
<div class="line">[Tuesday 04 January 2011] [06:38:16] &lt;mikko&gt;  orestis: i guess that is true. then again as far as i understand twisted is more general purpose ae framework where as 0mq is messaging stack</div>
<div class="line">[Tuesday 04 January 2011] [06:41:02] &lt;orestis&gt;        yes, apparently. I mainly wanted to use 0mq to split a monolithic gui app that does heavy I/O into separate processes. I definitely want to use Twisted for Deferreds and Callbacks (and Twisted plays well with GUIs) so I was wondering how to bring everything together.</div>
<div class="line">[Tuesday 04 January 2011] [06:42:25] &lt;mikko&gt;  orestis: you should be able to integrate 0mq into twisted</div>
<div class="line">[Tuesday 04 January 2011] [06:42:33] &lt;mikko&gt;  using the methods i mentioned earlier</div>
<div class="line">[Tuesday 04 January 2011] [06:44:05] &lt;orestis&gt;        mikko: they&#8217;re not in the stable version though, are they?</div>
<div class="line">[Tuesday 04 January 2011] [06:45:05] &lt;mikko&gt;  orestis: if you mean 2.0.x then no</div>
<div class="line">[Tuesday 04 January 2011] [06:45:11] &lt;mikko&gt;  but 2.1.x seems fairly stable</div>
<div class="line">[Tuesday 04 January 2011] [06:45:19] &lt;mikko&gt;  i use github trunk in all my developments</div>
<div class="line">[Tuesday 04 January 2011] [07:14:53] &lt;orestis&gt;        mikko: thanks for your input. I&#8217;ll see what I can come up with.</div>
<div class="line">[Tuesday 04 January 2011] [07:21:39] &lt;jugg&gt;   The documentation for ZMQ_IDENTITY is not clear to me.  I assume that the zmq context has to be maintained in order for a socket&#8217;s identity to be re-usable?  But terminating the zmq context will lose the identity persistence?</div>
<div class="line">[Tuesday 04 January 2011] [10:55:17] &lt;Seta00&gt; how do I build 0MQ with MinGW?</div>
<div class="line">[Tuesday 04 January 2011] [10:55:36] &lt;mikko&gt;  Seta00: configure &amp;&amp; make &amp;&amp; make install i guess</div>
<div class="line">[Tuesday 04 January 2011] [10:55:51] &lt;mikko&gt;  Seta00: i got mingw build running on linux machine</div>
<div class="line">[Tuesday 04 January 2011] [10:55:52]   * Seta00 installs MSYS</div>
<div class="line">[Tuesday 04 January 2011] [10:55:54] &lt;Seta00&gt; :P</div>
<div class="line">[Tuesday 04 January 2011] [10:56:05] &lt;mikko&gt;  haven&#8217;t tried on windows in a while</div>
<div class="line">[Tuesday 04 January 2011] [10:56:32] &lt;mikko&gt;  i got mingw32 on linux and VS2008 on windows in daily builds</div>
<div class="line">[Tuesday 04 January 2011] [10:56:43] &lt;mikko&gt;  maybe mingw32 on windows would be a good addition</div>
<div class="line">[Tuesday 04 January 2011] [10:57:26] &lt;Seta00&gt; definitely :)</div>
<div class="line">[Tuesday 04 January 2011] [11:00:21] &lt;Seta00&gt; working with various libraries can get messed up really fast</div>
<div class="line">[Tuesday 04 January 2011] [11:12:05] &lt;Seta00&gt; msg_store.cpp:279: error: ISO C++ does not support <a href="#id7"><span class="problematic" id="id8">`</span></a>long long&#8217;</div>
<div class="line">[Tuesday 04 January 2011] [11:12:10] &lt;Seta00&gt; why aren&#8217;t things easier? hehe</div>
<div class="line">[Tuesday 04 January 2011] [11:13:17] &lt;sustrik&gt;        Set00: is that 2.0.10?</div>
<div class="line">[Tuesday 04 January 2011] [11:13:39] &lt;Seta00&gt; sustrik, yes</div>
<div class="line">[Tuesday 04 January 2011] [11:13:52] &lt;sustrik&gt;        i recall the long long issue was being solved</div>
<div class="line">[Tuesday 04 January 2011] [11:13:59] &lt;sustrik&gt;        maybe it&#8217;s fixed in 2.1</div>
<div class="line">[Tuesday 04 January 2011] [11:14:08] &lt;sustrik&gt;        mikko: don&#8217;t you remember by chance?</div>
<div class="line">[Tuesday 04 January 2011] [11:14:46] &lt;Seta00&gt; I&#8217;ll try</div>
<div class="line">[Tuesday 04 January 2011] [11:26:16] &lt;Seta00&gt; 2.1.0 gives me &#8221;.../mingw/lib/dllcrt2.o: No such file or directory&#8221; when linking</div>
<div class="line">[Tuesday 04 January 2011] [11:27:32] &lt;sustrik&gt;        :|</div>
<div class="line">[Tuesday 04 January 2011] [11:28:53] &lt;sustrik&gt;        no idea what that is</div>
<div class="line">[Tuesday 04 January 2011] [11:28:57] &lt;sustrik&gt;        as for the long long problem</div>
<div class="line">[Tuesday 04 January 2011] [11:29:31] &lt;sustrik&gt;        iirc the problem is that long long is not part of C++ standard, yet it it used in Win32 signatures</div>
<div class="line">[Tuesday 04 January 2011] [11:29:37] &lt;sustrik&gt;        Win32 API</div>
<div class="line">[Tuesday 04 January 2011] [11:30:09] &lt;Skaag&gt;  I wonder if anyone else is using google protocol buffers to send messages over zmq</div>
<div class="line">[Tuesday 04 January 2011] [11:31:14] &lt;Seta00&gt; I&#8217;m trying with uint64_t</div>
<div class="line">[Tuesday 04 January 2011] [11:33:42] &lt;Seta00&gt; doesn&#8217;t work</div>
<div class="line">[Tuesday 04 January 2011] [11:34:03] &lt;Seta00&gt; how can I remove -Werror?</div>
<div class="line">[Tuesday 04 January 2011] [11:34:16] &lt;Seta00&gt; other than manually editing the makefile?</div>
<div class="line">[Tuesday 04 January 2011] [11:35:32] &lt;Seta00&gt; long works fine, but msys doesn`t find that DLL</div>
<div class="line">[Tuesday 04 January 2011] [11:40:26] &lt;sustrik&gt;        no idea, try checking configure.in</div>
<div class="line">[Tuesday 04 January 2011] [11:41:28] &lt;Seta00&gt; forgot to configure fstab</div>
<div class="line">[Tuesday 04 January 2011] [11:42:39] &lt;mikko&gt;  sustrik: yes</div>
<div class="line">[Tuesday 04 January 2011] [11:42:48] &lt;mikko&gt;  ah, it was answered</div>
<div class="line">[Tuesday 04 January 2011] [11:42:58] &lt;mikko&gt;  long long problem is with 2.0.x</div>
<div class="line">[Tuesday 04 January 2011] [11:43:02] &lt;mikko&gt;  it&#8217;s fixed in 2.1.0</div>
<div class="line">[Tuesday 04 January 2011] [11:43:48] &lt;sustrik&gt;        thx</div>
<div class="line">[Tuesday 04 January 2011] [11:46:20] &lt;mikko&gt;  Skaag: there has been a couple of mentions about that</div>
<div class="line">[Tuesday 04 January 2011] [11:46:31] &lt;mikko&gt;  Seta00: i can test mingw32 build when i get home</div>
<div class="line">[Tuesday 04 January 2011] [11:47:00] &lt;Seta00&gt; mikko, it worked after I configured my fstab on MSYS</div>
<div class="line">[Tuesday 04 January 2011] [11:47:15] &lt;Seta00&gt; thanks sustrik and mikko</div>
<div class="line">[Tuesday 04 January 2011] [11:47:37] &lt;sustrik&gt;        you are welcome</div>
<div class="line">[Tuesday 04 January 2011] [11:47:49] &lt;Seta00&gt; now I need qmake to link to it :P</div>
<div class="line">[Tuesday 04 January 2011] [11:48:04] &lt;Seta00&gt; which shall be solved in #qt</div>
<div class="line">[Tuesday 04 January 2011] [11:48:05] &lt;Seta00&gt; :)</div>
<div class="line">[Tuesday 04 January 2011] [11:48:28] &lt;mikko&gt;  i remember someone doing this before</div>
<div class="line">[Tuesday 04 January 2011] [11:48:31] &lt;mikko&gt;  with qt toolchain</div>
<div class="line">[Tuesday 04 January 2011] [11:48:39] &lt;mikko&gt;  that sparked the whole fixing of mingw32 builds</div>
<div class="line">[Tuesday 04 January 2011] [12:28:58] &lt;s0undt3ch&gt;      with pyzmq, on a publisher subscriber model, I&#8217;m setting the publisher&#8217;s identity, how can a subscriber retrieve that identity</div>
<div class="line">[Tuesday 04 January 2011] [12:28:59] &lt;s0undt3ch&gt;      ?</div>
<div class="line">[Tuesday 04 January 2011] [12:31:53] &lt;sustrik&gt;        it can&#8217;t</div>
<div class="line">[Tuesday 04 January 2011] [12:33:16] &lt;s0undt3ch&gt;      hmmm</div>
<div class="line">[Tuesday 04 January 2011] [12:33:25] &lt;s0undt3ch&gt;      I need to pass that on the message then</div>
<div class="line">[Tuesday 04 January 2011] [12:34:26] &lt;sustrik&gt;        yes, the identity is only internel per-hop mechanism</div>
<div class="line">[Tuesday 04 January 2011] [12:34:42] &lt;sustrik&gt;        it&#8217;s not passed all the way down from publisher to subscriber</div>
<div class="line">[Tuesday 04 January 2011] [12:39:56] &lt;s0undt3ch&gt;      sustrik: same for req/rep right?</div>
<div class="line">[Tuesday 04 January 2011] [12:41:11] &lt;Seta00&gt; s0undt3ch, are you on windows?</div>
<div class="line">[Tuesday 04 January 2011] [12:44:59] &lt;sustrik&gt;        same for all patterns</div>
<div class="line">[Tuesday 04 January 2011] [12:45:31] &lt;sustrik&gt;        req/rep is special in that identities are stuck to the request as it passes individual nodes</div>
<div class="line">[Tuesday 04 January 2011] [12:46:03] &lt;sustrik&gt;        but there&#8217;s still no special mechanism to inspect peers&#8217; identities</div>
<div class="line">[Tuesday 04 January 2011] [12:48:35] &lt;s0undt3ch&gt;      Seta00: nope</div>
<div class="line">[Tuesday 04 January 2011] [12:49:01] &lt;Seta00&gt; just checking if someone has a pyzmq build for Windows</div>
<div class="line">[Tuesday 04 January 2011] [13:54:20] &lt;<a href="#id61"><span class="problematic" id="id62">Joes_</span></a>&gt;  Hello. It is very tempting for me to use ZeroMQ, but I&#8217;m trying to figure out how architecture would look like. So, we have chat server (a-la IRC) with chat rooms.</div>
<div class="line">[Tuesday 04 January 2011] [13:54:40] &lt;<a href="#id63"><span class="problematic" id="id64">Joes_</span></a>&gt;  Users can join multiple rooms and I need to route messages between users in same room.</div>
<div class="line">[Tuesday 04 January 2011] [13:54:53] &lt;<a href="#id65"><span class="problematic" id="id66">Joes_</span></a>&gt;  As far as I understood tutorials, I need 2 connections</div>
<div class="line">[Tuesday 04 January 2011] [13:55:06] &lt;<a href="#id67"><span class="problematic" id="id68">Joes_</span></a>&gt;  one pubsub to send room events back to users</div>
<div class="line">[Tuesday 04 January 2011] [13:55:16] &lt;<a href="#id69"><span class="problematic" id="id70">Joes_</span></a>&gt;  and one pubsub to send events from users to rooms?</div>
<div class="line">[Tuesday 04 January 2011] [13:55:30] &lt;<a href="#id71"><span class="problematic" id="id72">Joes_</span></a>&gt;  can it be done with only one connection?</div>
<div class="line">[Tuesday 04 January 2011] [13:55:38] &lt;<a href="#id73"><span class="problematic" id="id74">Joes_</span></a>&gt;  (or socket)</div>
<div class="line">[Tuesday 04 January 2011] [14:16:49] &lt;mikko&gt;  <a href="#id75"><span class="problematic" id="id76">Joes_</span></a>: you would need two</div>
<div class="line">[Tuesday 04 January 2011] [14:17:34] &lt;<a href="#id77"><span class="problematic" id="id78">Joes_</span></a>&gt;  in terms of low level communication with tcp transport - two tcp ports on the server will be used</div>
<div class="line">[Tuesday 04 January 2011] [14:17:36] &lt;<a href="#id79"><span class="problematic" id="id80">Joes_</span></a>&gt;  correct?</div>
<div class="line">[Tuesday 04 January 2011] [14:17:44] &lt;<a href="#id81"><span class="problematic" id="id82">Joes_</span></a>&gt;  (firewall setup, etc)</div>
<div class="line">[Tuesday 04 January 2011] [14:18:04] &lt;mikko&gt;  <a href="#id83"><span class="problematic" id="id84">Joes_</span></a>: assuming you bind the two sockets then yet</div>
<div class="line">[Tuesday 04 January 2011] [14:18:07] &lt;mikko&gt;  yes*</div>
<div class="line">[Tuesday 04 January 2011] [14:18:10] &lt;<a href="#id85"><span class="problematic" id="id86">Joes_</span></a>&gt;  ok</div>
<div class="line">[Tuesday 04 January 2011] [14:18:19] &lt;<a href="#id87"><span class="problematic" id="id88">Joes_</span></a>&gt;  and second question - any bindings for Javascript?</div>
<div class="line">[Tuesday 04 January 2011] [14:18:31] &lt;mikko&gt;  i think someone was working for node.js bindings</div>
<div class="line">[Tuesday 04 January 2011] [14:18:34] &lt;<a href="#id89"><span class="problematic" id="id90">Joes_</span></a>&gt;  using WebSockets/socketjs/etc</div>
<div class="line">[Tuesday 04 January 2011] [14:18:42] &lt;<a href="#id91"><span class="problematic" id="id92">Joes_</span></a>&gt;  saw them</div>
<div class="line">[Tuesday 04 January 2011] [14:18:52] &lt;<a href="#id93"><span class="problematic" id="id94">Joes_</span></a>&gt;  includes native C code</div>
<div class="line">[Tuesday 04 January 2011] [14:19:02] &lt;<a href="#id95"><span class="problematic" id="id96">Joes_</span></a>&gt;  is wire protocol documented?</div>
<div class="line">[Tuesday 04 January 2011] [14:19:08] &lt;mikko&gt;  yes, i think it is</div>
<div class="line">[Tuesday 04 January 2011] [14:19:19] &lt;mikko&gt;  gimme a sec</div>
<div class="line">[Tuesday 04 January 2011] [14:20:39] &lt;mikko&gt;  here is the message format <a class="reference external" href="http://rfc.zeromq.org/spec:2">http://rfc.zeromq.org/spec:2</a></div>
<div class="line">[Tuesday 04 January 2011] [14:20:54] &lt;<a href="#id97"><span class="problematic" id="id98">Joes_</span></a>&gt;  thanks</div>
<div class="line">[Tuesday 04 January 2011] [14:20:57] &lt;mikko&gt;  let me see if the rest is documented</div>
<div class="line">[Tuesday 04 January 2011] [14:21:02] &lt;<a href="#id99"><span class="problematic" id="id100">Joes_</span></a>&gt;  going to see how long it will take to write dumb client in JS</div>
<div class="line">[Tuesday 04 January 2011] [14:21:25] &lt;<a href="#id101"><span class="problematic" id="id102">Joes_</span></a>&gt;  there&#8217;s one for AMQP, but nothing for ZeroMQ</div>
<div class="line">[Tuesday 04 January 2011] [14:21:33] &lt;<a href="#id103"><span class="problematic" id="id104">Joes_</span></a>&gt;  and I don&#8217;t need 95% of AMQP features...</div>
<div class="line">[Tuesday 04 January 2011] [14:22:38] &lt;mikko&gt;  are you going to do communications from browser straight to 0mq?</div>
<div class="line">[Tuesday 04 January 2011] [14:22:46] &lt;<a href="#id105"><span class="problematic" id="id106">Joes_</span></a>&gt;  well, that would be ideal</div>
<div class="line">[Tuesday 04 January 2011] [14:22:55] &lt;mikko&gt;  i don&#8217;t think that&#8217;s going to work</div>
<div class="line">[Tuesday 04 January 2011] [14:23:00] &lt;mikko&gt;  at least with websockets</div>
<div class="line">[Tuesday 04 January 2011] [14:23:12] &lt;mikko&gt;  as websockets have their own framing as well</div>
<div class="line">[Tuesday 04 January 2011] [14:23:25] &lt;<a href="#id107"><span class="problematic" id="id108">Joes_</span></a>&gt;  instead of making own wire protocol</div>
<div class="line">[Tuesday 04 January 2011] [14:23:40] &lt;<a href="#id109"><span class="problematic" id="id110">Joes_</span></a>&gt;  hm</div>
<div class="line">[Tuesday 04 January 2011] [14:23:43] &lt;mikko&gt;  have you looked into mongrel2?</div>
<div class="line">[Tuesday 04 January 2011] [14:24:04] &lt;<a href="#id111"><span class="problematic" id="id112">Joes_</span></a>&gt;  I did</div>
<div class="line">[Tuesday 04 January 2011] [14:24:14] &lt;<a href="#id113"><span class="problematic" id="id114">Joes_</span></a>&gt;  however, I can&#8217;t find any benchmarks</div>
<div class="line">[Tuesday 04 January 2011] [14:24:20] &lt;<a href="#id115"><span class="problematic" id="id116">Joes_</span></a>&gt;  or who&#8217;s using it in production</div>
<div class="line">[Tuesday 04 January 2011] [14:24:38] &lt;mikko&gt;  it&#8217;s very new tech, i would be surprised if there are large installations yet</div>
<div class="line">[Tuesday 04 January 2011] [14:25:03] &lt;mikko&gt;  and i tend to find benchmarks mainly useless as there are a lot of people who don&#8217;t know how to benchmark the software</div>
<div class="line">[Tuesday 04 January 2011] [14:25:08] &lt;mikko&gt;  or optimize it for benchmarking</div>
<div class="line">[Tuesday 04 January 2011] [14:25:27] &lt;<a href="#id117"><span class="problematic" id="id118">Joes_</span></a>&gt;  well, at least some rough numbers would help</div>
<div class="line">[Tuesday 04 January 2011] [14:25:34] &lt;<a href="#id119"><span class="problematic" id="id120">Joes_</span></a>&gt;  like faster than X Y times</div>
<div class="line">[Tuesday 04 January 2011] [14:27:12] &lt;mikko&gt;  but very often i find they are comparing apples to oranges</div>
<div class="line">[Tuesday 04 January 2011] [14:27:35] &lt;mikko&gt;  one tool with highly optimized config against incorrect config of other</div>
<div class="line">[Tuesday 04 January 2011] [14:27:49] &lt;<a href="#id121"><span class="problematic" id="id122">Joes_</span></a>&gt;  I see.</div>
<div class="line">[Tuesday 04 January 2011] [14:28:17] &lt;mikko&gt;  it&#8217;s very hard to create good benchmarks</div>
<div class="line">[Tuesday 04 January 2011] [14:32:13] &lt;mikko&gt;  but communicating from browser you most likely need some sort of middle piece</div>
<div class="line">[Tuesday 04 January 2011] [14:32:36] &lt;mikko&gt;  probably doesn&#8217;t need to be complicated but something that converts websocket messages to 0mq messages</div>
<div class="line">[Tuesday 04 January 2011] [14:32:40] &lt;<a href="#id123"><span class="problematic" id="id124">Joes_</span></a>&gt;  Let&#8217;s assume I have middlepiece - some kind of broker between browser and 0MQ</div>
<div class="line">[Tuesday 04 January 2011] [14:32:45] &lt;<a href="#id125"><span class="problematic" id="id126">Joes_</span></a>&gt;  (thought about it)</div>
<div class="line">[Tuesday 04 January 2011] [14:32:49] &lt;<a href="#id127"><span class="problematic" id="id128">Joes_</span></a>&gt;  with some simple wire protocol</div>
<div class="line">[Tuesday 04 January 2011] [14:32:56] &lt;sustrik&gt;        i think that&#8217;s mostly what mongrel2 does</div>
<div class="line">[Tuesday 04 January 2011] [14:33:01] &lt;<a href="#id129"><span class="problematic" id="id130">Joes_</span></a>&gt;  but I have following issues:</div>
<div class="line">[Tuesday 04 January 2011] [14:33:12] &lt;<a href="#id131"><span class="problematic" id="id132">Joes_</span></a>&gt;  1. Who will guarantee delivery, if client drops connection</div>
<div class="line">[Tuesday 04 January 2011] [14:33:26] &lt;<a href="#id133"><span class="problematic" id="id134">Joes_</span></a>&gt;  (I will need to queue up messages for this client till his next connection)</div>
<div class="line">[Tuesday 04 January 2011] [14:33:53] &lt;<a href="#id135"><span class="problematic" id="id136">Joes_</span></a>&gt;  well, there some other issues, but I don&#8217;t remember them all :-)</div>
<div class="line">[Tuesday 04 January 2011] [14:33:57] &lt;mikko&gt;  if client drops connection do you want to queue messages?</div>
<div class="line">[Tuesday 04 January 2011] [14:34:08] &lt;mikko&gt;  for how long time after client leaves?</div>
<div class="line">[Tuesday 04 January 2011] [14:34:19] &lt;<a href="#id137"><span class="problematic" id="id138">Joes_</span></a>&gt;  I don&#8217;t know if client dropped or temporary lost connection to the server and will reconnect shortly</div>
<div class="line">[Tuesday 04 January 2011] [14:34:30] &lt;sustrik&gt;        can be done using ZMQ_IDENTITY</div>
<div class="line">[Tuesday 04 January 2011] [14:34:39] &lt;<a href="#id139"><span class="problematic" id="id140">Joes_</span></a>&gt;  em</div>
<div class="line">[Tuesday 04 January 2011] [14:34:51] &lt;<a href="#id141"><span class="problematic" id="id142">Joes_</span></a>&gt;  let&#8217;s say I&#8217;m am the server which handles requests from browsers.</div>
<div class="line">[Tuesday 04 January 2011] [14:34:59] &lt;<a href="#id143"><span class="problematic" id="id144">Joes_</span></a>&gt;  I accepted raw TCP connection (or websocket connection)</div>
<div class="line">[Tuesday 04 January 2011] [14:35:16] &lt;<a href="#id145"><span class="problematic" id="id146">Joes_</span></a>&gt;  so, for this connection, I will create 0MQ socket (or two, but it does not matter now)</div>
<div class="line">[Tuesday 04 January 2011] [14:35:24] &lt;<a href="#id147"><span class="problematic" id="id148">Joes_</span></a>&gt;  and will connect to the chat server</div>
<div class="line">[Tuesday 04 January 2011] [14:35:31] &lt;sustrik&gt;        right</div>
<div class="line">[Tuesday 04 January 2011] [14:35:41] &lt;<a href="#id149"><span class="problematic" id="id150">Joes_</span></a>&gt;  if incoming (browser) connection will drop</div>
<div class="line">[Tuesday 04 January 2011] [14:35:48] &lt;<a href="#id151"><span class="problematic" id="id152">Joes_</span></a>&gt;  I should close socket?</div>
<div class="line">[Tuesday 04 January 2011] [14:35:54] &lt;<a href="#id153"><span class="problematic" id="id154">Joes_</span></a>&gt;  (0MQ socket)</div>
<div class="line">[Tuesday 04 January 2011] [14:36:08] &lt;sustrik&gt;        no, 0MQ socket represents all the connections</div>
<div class="line">[Tuesday 04 January 2011] [14:36:17] &lt;sustrik&gt;        so closing it means closing all the connections</div>
<div class="line">[Tuesday 04 January 2011] [14:36:20] &lt;<a href="#id155"><span class="problematic" id="id156">Joes_</span></a>&gt;  hm</div>
<div class="line">[Tuesday 04 January 2011] [14:36:27] &lt;<a href="#id157"><span class="problematic" id="id158">Joes_</span></a>&gt;  1 socket for all incoming clients?</div>
<div class="line">[Tuesday 04 January 2011] [14:36:31] &lt;sustrik&gt;        yes</div>
<div class="line">[Tuesday 04 January 2011] [14:37:03] &lt;<a href="#id159"><span class="problematic" id="id160">Joes_</span></a>&gt;  who will be doing queuing of the messages for temporary disconnected clients?</div>
<div class="line">[Tuesday 04 January 2011] [14:37:14] &lt;sustrik&gt;        the server</div>
<div class="line">[Tuesday 04 January 2011] [14:37:39] &lt;<a href="#id161"><span class="problematic" id="id162">Joes_</span></a>&gt;  I see</div>
<div class="line">[Tuesday 04 January 2011] [14:37:41] &lt;sustrik&gt;        to be precise, the 0MQ socket in the server</div>
<div class="line">[Tuesday 04 January 2011] [14:37:45] &lt;<a href="#id163"><span class="problematic" id="id164">Joes_</span></a>&gt;  hm</div>
<div class="line">[Tuesday 04 January 2011] [14:38:03] &lt;sustrik&gt;        all you need to do is set the ZMQ_IDENTITY socket option on the client</div>
<div class="line">[Tuesday 04 January 2011] [14:38:37] &lt;sustrik&gt;        that way the server socket would know that is should not deallocate the connection when it accidentally breaks</div>
<div class="line">[Tuesday 04 January 2011] [14:38:46] &lt;sustrik&gt;        the messages will be stored</div>
<div class="line">[Tuesday 04 January 2011] [14:38:58] &lt;sustrik&gt;        and once the same client re-connects they will be sent</div>
<div class="line">[Tuesday 04 January 2011] [14:39:03] &lt;<a href="#id165"><span class="problematic" id="id166">Joes_</span></a>&gt;  that&#8217;s the problem - I will have to write proxy between browser and 0MQ server</div>
<div class="line">[Tuesday 04 January 2011] [14:39:05] &lt;mikko&gt;  i think you are talking about separate issue</div>
<div class="line">[Tuesday 04 January 2011] [14:39:10] &lt;mikko&gt;  in this case:</div>
<div class="line">[Tuesday 04 January 2011] [14:39:33] &lt;mikko&gt;  chat server &lt;&#8211; 0mq &#8211;&gt; broker &lt;&#8211; raw tcp &#8211;&gt; client</div>
<div class="line">[Tuesday 04 January 2011] [14:39:38] &lt;<a href="#id167"><span class="problematic" id="id168">Joes_</span></a>&gt;  yep</div>
<div class="line">[Tuesday 04 January 2011] [14:40:33] &lt;<a href="#id169"><span class="problematic" id="id170">Joes_</span></a>&gt;  so, my question is - I&#8217;m adding extra logic on broker side to handle another wire protocol, message queuing (connection persistence logic like in 0MQ)</div>
<div class="line">[Tuesday 04 January 2011] [14:40:42] &lt;<a href="#id171"><span class="problematic" id="id172">Joes_</span></a>&gt;  is it worth of the trouble?</div>
<div class="line">[Tuesday 04 January 2011] [14:41:01] &lt;<a href="#id173"><span class="problematic" id="id174">Joes_</span></a>&gt;  broker can be &#8220;end point&#8221;</div>
<div class="line">[Tuesday 04 January 2011] [14:41:34] &lt;<a href="#id175"><span class="problematic" id="id176">Joes_</span></a>&gt;  not scalable solution, though</div>
<div class="line">[Tuesday 04 January 2011] [14:41:35] &lt;mikko&gt;  the only thing you have described about the application this far that it&#8217;s a chat like irc</div>
<div class="line">[Tuesday 04 January 2011] [14:41:56] &lt;<a href="#id177"><span class="problematic" id="id178">Joes_</span></a>&gt;  yep, pretty much</div>
<div class="line">[Tuesday 04 January 2011] [14:42:03] &lt;mikko&gt;  is this from scratch or do you have something running already?</div>
<div class="line">[Tuesday 04 January 2011] [14:42:07] &lt;<a href="#id179"><span class="problematic" id="id180">Joes_</span></a>&gt;  scratch</div>
<div class="line">[Tuesday 04 January 2011] [14:42:12] &lt;<a href="#id181"><span class="problematic" id="id182">Joes_</span></a>&gt;  prototyping</div>
<div class="line">[Tuesday 04 January 2011] [14:43:04] &lt;<a href="#id183"><span class="problematic" id="id184">Joes_</span></a>&gt;  well, in terms of possible load - ~12k users average online</div>
<div class="line">[Tuesday 04 January 2011] [14:43:30] &lt;<a href="#id185"><span class="problematic" id="id186">Joes_</span></a>&gt;  each making ~1 message in 5 seconds (worst case)</div>
<div class="line">[Tuesday 04 January 2011] [14:43:49] &lt;<a href="#id187"><span class="problematic" id="id188">Joes_</span></a>&gt;  ajax with long polling does not suit very well</div>
<div class="line">[Tuesday 04 January 2011] [14:44:17] &lt;mikko&gt;  why do you need to queue the messages if the client drops?</div>
<div class="line">[Tuesday 04 January 2011] [14:44:20] &lt;<a href="#id189"><span class="problematic" id="id190">Joes_</span></a>&gt;  so, trying to find other possibilities apart of writing custom protocol on top of raw sockets</div>
<div class="line">[Tuesday 04 January 2011] [14:44:36] &lt;<a href="#id191"><span class="problematic" id="id192">Joes_</span></a>&gt;  to keep state of the room and its recent history</div>
<div class="line">[Tuesday 04 January 2011] [14:45:03] &lt;<a href="#id193"><span class="problematic" id="id194">Joes_</span></a>&gt;  it is doable by resending last N items on reconnect</div>
<div class="line">[Tuesday 04 January 2011] [14:45:19] &lt;<a href="#id195"><span class="problematic" id="id196">Joes_</span></a>&gt;  which solves the problem, but.. if 0MQ provides it for free..</div>
<div class="line">[Tuesday 04 January 2011] [14:49:14] &lt;mikko&gt;  let me think for a sec</div>
<div class="line">[Tuesday 04 January 2011] [14:49:28] &lt;mikko&gt;  the biggest problem is the last part to the browser</div>
<div class="line">[Tuesday 04 January 2011] [14:49:32] &lt;<a href="#id197"><span class="problematic" id="id198">Joes_</span></a>&gt;  yep</div>
<div class="line">[Tuesday 04 January 2011] [14:49:45] &lt;<a href="#id199"><span class="problematic" id="id200">Joes_</span></a>&gt;  I want to get rid of it by having simple, yet functional, 0mq client</div>
<div class="line">[Tuesday 04 January 2011] [14:50:01] &lt;<a href="#id201"><span class="problematic" id="id202">Joes_</span></a>&gt;  let&#8217;s assume there&#8217;s no WebSocket wrapping for now.</div>
<div class="line">[Tuesday 04 January 2011] [14:50:05] &lt;<a href="#id203"><span class="problematic" id="id204">Joes_</span></a>&gt;  plain tcp sockets</div>
<div class="line">[Tuesday 04 January 2011] [14:50:54] &lt;mikko&gt;  you are not in control of the client side i assume?</div>
<div class="line">[Tuesday 04 January 2011] [14:51:04] &lt;mikko&gt;  as in installing 0mq on client :)</div>
<div class="line">[Tuesday 04 January 2011] [14:51:16] &lt;<a href="#id205"><span class="problematic" id="id206">Joes_</span></a>&gt;  nope.</div>
<div class="line">[Tuesday 04 January 2011] [14:51:19] &lt;<a href="#id207"><span class="problematic" id="id208">Joes_</span></a>&gt;  plain HTML+JS</div>
<div class="line">[Tuesday 04 January 2011] [14:51:28] &lt;<a href="#id209"><span class="problematic" id="id210">Joes_</span></a>&gt;  and, maybe, some Flash.</div>
<div class="line">[Tuesday 04 January 2011] [14:51:50] &lt;<a href="#id211"><span class="problematic" id="id212">Joes_</span></a>&gt;  (I already checked almost all language integrations - all of them are dependent on the native C library)</div>
<div class="line">[Tuesday 04 January 2011] [14:54:36] &lt;mikko&gt;  yes, i think you would need to implement some logic in your broker</div>
<div class="line">[Tuesday 04 January 2011] [14:55:52] &lt;<a href="#id213"><span class="problematic" id="id214">Joes_</span></a>&gt;  in terms of code, for 1 incoming browser it will create 0mq socket or it will handle all incoming browser connections through 1 0mq socket?</div>
<div class="line">[Tuesday 04 January 2011] [14:55:55] &lt;<a href="#id215"><span class="problematic" id="id216">Joes_</span></a>&gt;  what is better approach?</div>
<div class="line">[Tuesday 04 January 2011] [14:56:37] &lt;<a href="#id217"><span class="problematic" id="id218">Joes_</span></a>&gt;  multiple sockets - free message queuing</div>
<div class="line">[Tuesday 04 January 2011] [14:56:57] &lt;<a href="#id219"><span class="problematic" id="id220">Joes_</span></a>&gt;  one socket - easier overall architecture (and speed?), but manual queuing on the broker</div>
<div class="line">[Tuesday 04 January 2011] [14:57:17] &lt;<a href="#id221"><span class="problematic" id="id222">Joes_</span></a>&gt;  plus, custom wire protocol from broker to browser</div>
<div class="line">[Tuesday 04 January 2011] [14:57:20] &lt;<a href="#id223"><span class="problematic" id="id224">Joes_</span></a>&gt;  etc.</div>
<div class="line">[Tuesday 04 January 2011] [14:57:31] &lt;mikko&gt;  one socket also requires custom filtering i guess</div>
<div class="line">[Tuesday 04 January 2011] [14:57:49] &lt;mikko&gt;  you got messages coming in 1 socket destined to ~12k clients</div>
<div class="line">[Tuesday 04 January 2011] [14:57:51] &lt;<a href="#id225"><span class="problematic" id="id226">Joes_</span></a>&gt;  well, I can read address from the message</div>
<div class="line">[Tuesday 04 January 2011] [14:58:00] &lt;mikko&gt;  so you need to write them to correct handles on other side</div>
<div class="line">[Tuesday 04 January 2011] [14:58:12] &lt;<a href="#id227"><span class="problematic" id="id228">Joes_</span></a>&gt;  and then pick proper browser socket and send it there</div>
<div class="line">[Tuesday 04 January 2011] [14:58:12] &lt;<a href="#id229"><span class="problematic" id="id230">Joes_</span></a>&gt;  yep</div>
<div class="line">[Tuesday 04 January 2011] [14:58:20] &lt;<a href="#id231"><span class="problematic" id="id232">Joes_</span></a>&gt;  it = message</div>
<div class="line">[Tuesday 04 January 2011] [14:59:02] &lt;mikko&gt;  one socket might be easier to handle for events as well</div>
<div class="line">[Tuesday 04 January 2011] [14:59:09] &lt;mikko&gt;  otherwise you got a pollset of 12k items</div>
<div class="line">[Tuesday 04 January 2011] [14:59:13] &lt;mikko&gt;  that you need to maintain</div>
<div class="line">[Tuesday 04 January 2011] [14:59:15] &lt;<a href="#id233"><span class="problematic" id="id234">Joes_</span></a>&gt;  yeah</div>
<div class="line">[Tuesday 04 January 2011] [14:59:19] &lt;<a href="#id235"><span class="problematic" id="id236">Joes_</span></a>&gt;  bad idea.</div>
<div class="line">[Tuesday 04 January 2011] [14:59:27] &lt;<a href="#id237"><span class="problematic" id="id238">Joes_</span></a>&gt;  ok, another idea.</div>
<div class="line">[Tuesday 04 January 2011] [14:59:39] &lt;<a href="#id239"><span class="problematic" id="id240">Joes_</span></a>&gt;  I write pure JS implementation of the wire protocol</div>
<div class="line">[Tuesday 04 January 2011] [14:59:43] &lt;<a href="#id241"><span class="problematic" id="id242">Joes_</span></a>&gt;  it&#8217;s pretty simple</div>
<div class="line">[Tuesday 04 January 2011] [14:59:57] &lt;<a href="#id243"><span class="problematic" id="id244">Joes_</span></a>&gt;  and broker will be dump WebSocket negotiator and TCP proxy</div>
<div class="line">[Tuesday 04 January 2011] [15:00:07] &lt;<a href="#id245"><span class="problematic" id="id246">Joes_</span></a>&gt;  (forwards tcp connection to the real 0MQ server port)</div>
<div class="line">[Tuesday 04 January 2011] [15:00:14] &lt;<a href="#id247"><span class="problematic" id="id248">Joes_</span></a>&gt;  I assume it might work.</div>
<div class="line">[Tuesday 04 January 2011] [15:00:33] &lt;<a href="#id249"><span class="problematic" id="id250">Joes_</span></a>&gt;  each message sent will have address as a first chunk</div>
<div class="line">[Tuesday 04 January 2011] [15:00:46] &lt;<a href="#id251"><span class="problematic" id="id252">Joes_</span></a>&gt;  so chat server knows who sent it</div>
<div class="line">[Tuesday 04 January 2011] [15:00:54] &lt;<a href="#id253"><span class="problematic" id="id254">Joes_</span></a>&gt;  and, maybe, where</div>
<div class="line">[Tuesday 04 January 2011] [15:01:07] &lt;<a href="#id255"><span class="problematic" id="id256">Joes_</span></a>&gt;  dump = dumb</div>
<div class="line">[Tuesday 04 January 2011] [15:01:18] &lt;mikko&gt;  i think i wrote websocket daemon ages ago using libev</div>
<div class="line">[Tuesday 04 January 2011] [15:01:29] &lt;mikko&gt;  it wasn&#8217;t complicated</div>
<div class="line">[Tuesday 04 January 2011] [15:03:57] &lt;<a href="#id257"><span class="problematic" id="id258">Joes_</span></a>&gt;  hm, someone already did it for Ruby</div>
<div class="line">[Tuesday 04 January 2011] [15:04:10] &lt;<a href="#id259"><span class="problematic" id="id260">Joes_</span></a>&gt;  <a class="reference external" href="https://github.com/andrewvc/dripdrop">https://github.com/andrewvc/dripdrop</a></div>
<div class="line">[Tuesday 04 January 2011] [15:04:28] &lt;<a href="#id261"><span class="problematic" id="id262">Joes_</span></a>&gt;  custom wire format from client</div>
<div class="line">[Tuesday 04 January 2011] [15:04:32] &lt;andrewvc&gt;       hey, that&#8217;s me</div>
<div class="line">[Tuesday 04 January 2011] [15:04:35] &lt;<a href="#id263"><span class="problematic" id="id264">Joes_</span></a>&gt;  browser that is</div>
<div class="line">[Tuesday 04 January 2011] [15:04:36] &lt;<a href="#id265"><span class="problematic" id="id266">Joes_</span></a>&gt;  :-)</div>
<div class="line">[Tuesday 04 January 2011] [15:04:39] &lt;<a href="#id267"><span class="problematic" id="id268">Joes_</span></a>&gt;  wonderful</div>
<div class="line">[Tuesday 04 January 2011] [15:04:54] &lt;<a href="#id269"><span class="problematic" id="id270">Joes_</span></a>&gt;  there was pretty long discussion</div>
<div class="line">[Tuesday 04 January 2011] [15:05:04] &lt;andrewvc&gt;       oh?</div>
<div class="line">[Tuesday 04 January 2011] [15:05:16] &lt;<a href="#id271"><span class="problematic" id="id272">Joes_</span></a>&gt;  but, to sum it up - any plans for pure JS 0mq client instead of custom protocol?</div>
<div class="line">[Tuesday 04 January 2011] [15:05:18] &lt;<a href="#id273"><span class="problematic" id="id274">Joes_</span></a>&gt;  (or message format)</div>
<div class="line">[Tuesday 04 January 2011] [15:05:39] &lt;<a href="#id275"><span class="problematic" id="id276">Joes_</span></a>&gt;  so, you can get rid of Ruby server and just relay messages to 0mq</div>
<div class="line">[Tuesday 04 January 2011] [15:05:42] &lt;<a href="#id277"><span class="problematic" id="id278">Joes_</span></a>&gt;  straight</div>
<div class="line">[Tuesday 04 January 2011] [15:05:46] &lt;andrewvc&gt;       oh</div>
<div class="line">[Tuesday 04 January 2011] [15:05:54] &lt;andrewvc&gt;       well, there&#8217;s a node JS project</div>
<div class="line">[Tuesday 04 January 2011] [15:06:05] &lt;andrewvc&gt;       and I was going to implement zmq_devices as part of ffi-rzmq as well</div>
<div class="line">[Tuesday 04 January 2011] [15:06:14] &lt;andrewvc&gt;       or do those options not cover it?</div>
<div class="line">[Tuesday 04 January 2011] [15:06:19] &lt;<a href="#id279"><span class="problematic" id="id280">Joes_</span></a>&gt;  node JS is using native C library</div>
<div class="line">[Tuesday 04 January 2011] [15:06:28] &lt;<a href="#id281"><span class="problematic" id="id282">Joes_</span></a>&gt;  I want something like DripDrop</div>
<div class="line">[Tuesday 04 January 2011] [15:06:31] &lt;andrewvc&gt;       oh</div>
<div class="line">[Tuesday 04 January 2011] [15:06:33] &lt;andrewvc&gt;       interesting</div>
<div class="line">[Tuesday 04 January 2011] [15:06:33] &lt;<a href="#id283"><span class="problematic" id="id284">Joes_</span></a>&gt;  browser &lt;-&gt; 0mq</div>
<div class="line">[Tuesday 04 January 2011] [15:06:40] &lt;<a href="#id285"><span class="problematic" id="id286">Joes_</span></a>&gt;  and simple TCP proxy</div>
<div class="line">[Tuesday 04 January 2011] [15:06:42] &lt;<a href="#id287"><span class="problematic" id="id288">Joes_</span></a>&gt;  in between</div>
<div class="line">[Tuesday 04 January 2011] [15:06:49] &lt;andrewvc&gt;       well, dripdrop doesn&#8217;t really require zeromq</div>
<div class="line">[Tuesday 04 January 2011] [15:06:50] &lt;<a href="#id289"><span class="problematic" id="id290">Joes_</span></a>&gt;  which knows how to handle WebSocket handshake</div>
<div class="line">[Tuesday 04 January 2011] [15:06:53] &lt;andrewvc&gt;       it works well with websockets</div>
<div class="line">[Tuesday 04 January 2011] [15:06:56] &lt;andrewvc&gt;       and http</div>
<div class="line">[Tuesday 04 January 2011] [15:06:57] &lt;andrewvc&gt;       all evented</div>
<div class="line">[Tuesday 04 January 2011] [15:07:18] &lt;andrewvc&gt;       I&#8217;m a bit confused as to the actual question still I guess</div>
<div class="line">[Tuesday 04 January 2011] [15:07:21] &lt;mikko&gt;  andrewvc: but he wants to run this in browser</div>
<div class="line">[Tuesday 04 January 2011] [15:07:28] &lt;mikko&gt;  andrewvc: hence the pure js implementation i guess</div>
<div class="line">[Tuesday 04 January 2011] [15:07:34] &lt;<a href="#id291"><span class="problematic" id="id292">Joes_</span></a>&gt;  yes</div>
<div class="line">[Tuesday 04 January 2011] [15:07:43] &lt;andrewvc&gt;       ohhh, well who would the browser talk to. Itself?</div>
<div class="line">[Tuesday 04 January 2011] [15:07:51] &lt;<a href="#id293"><span class="problematic" id="id294">Joes_</span></a>&gt;  0mq server, preferably.</div>
<div class="line">[Tuesday 04 January 2011] [15:08:09] &lt;<a href="#id295"><span class="problematic" id="id296">Joes_</span></a>&gt;  here&#8217;s another example: online real-time game.</div>
<div class="line">[Tuesday 04 January 2011] [15:08:11] &lt;andrewvc&gt;       oh, well, as far as I know you can&#8217;t open a raw TCP conn from any browser still</div>
<div class="line">[Tuesday 04 January 2011] [15:08:17] &lt;andrewvc&gt;       so you&#8217;re using websockets in the yes?</div>
<div class="line">[Tuesday 04 January 2011] [15:08:29] &lt;<a href="#id297"><span class="problematic" id="id298">Joes_</span></a>&gt;  socketjs also works</div>
<div class="line">[Tuesday 04 January 2011] [15:09:01] &lt;<a href="#id299"><span class="problematic" id="id300">Joes_</span></a>&gt;  (embeds small Flash object to proxy sockets)</div>
<div class="line">[Tuesday 04 January 2011] [15:09:09] &lt;<a href="#id301"><span class="problematic" id="id302">Joes_</span></a>&gt;  gives plain sockets in JS</div>
<div class="line">[Tuesday 04 January 2011] [15:09:41] &lt;andrewvc&gt;       yeah, so, that&#8217;s an interesting idea</div>
<div class="line">[Tuesday 04 January 2011] [15:09:56] &lt;<a href="#id303"><span class="problematic" id="id304">Joes_</span></a>&gt;  I mean - sure, I can create custom protocol</div>
<div class="line">[Tuesday 04 January 2011] [15:10:00] &lt;<a href="#id305"><span class="problematic" id="id306">Joes_</span></a>&gt;  write custom server software</div>
<div class="line">[Tuesday 04 January 2011] [15:10:00] &lt;andrewvc&gt;       what kinds of implementation were you guys thinking?</div>
<div class="line">[Tuesday 04 January 2011] [15:10:06] &lt;<a href="#id307"><span class="problematic" id="id308">Joes_</span></a>&gt;  which will parse messages, etc</div>
<div class="line">[Tuesday 04 January 2011] [15:10:11] &lt;<a href="#id309"><span class="problematic" id="id310">Joes_</span></a>&gt;  but I dont see a point</div>
<div class="line">[Tuesday 04 January 2011] [15:10:52] &lt;andrewvc&gt;       what would the api look like, in JS?</div>
<div class="line">[Tuesday 04 January 2011] [15:11:04] &lt;<a href="#id311"><span class="problematic" id="id312">Joes_</span></a>&gt;  so, DripDrop already doing it - checked JS files, it is encapsulating messages into DD.Message</div>
<div class="line">[Tuesday 04 January 2011] [15:11:05] &lt;andrewvc&gt;       I think that&#8217;s probably a good place to start, if you can throw up a gist for a simple case</div>
<div class="line">[Tuesday 04 January 2011] [15:11:09] &lt;andrewvc&gt;       yep</div>
<div class="line">[Tuesday 04 January 2011] [15:11:37] &lt;andrewvc&gt;       the JS prolly needs a little love at this point</div>
<div class="line">[Tuesday 04 January 2011] [15:12:15] &lt;<a href="#id313"><span class="problematic" id="id314">Joes_</span></a>&gt;  so, imagine that there&#8217;s no need to have custom wire protocol (json serialized) and JS would just talk to 0mq server using 0mq wire protocol</div>
<div class="line">[Tuesday 04 January 2011] [15:12:48] &lt;<a href="#id315"><span class="problematic" id="id316">Joes_</span></a>&gt;  that&#8217;s the simpliest case</div>
<div class="line">[Tuesday 04 January 2011] [15:13:18] &lt;andrewvc&gt;       hmmm, the 0mq wire protocol doesn&#8217;t handle that much really</div>
<div class="line">[Tuesday 04 January 2011] [15:13:43] &lt;andrewvc&gt;       I mean, you could express multipart stuff, like socket identities for stuff like xreq/xrep</div>
<div class="line">[Tuesday 04 January 2011] [15:13:45] &lt;<a href="#id317"><span class="problematic" id="id318">Joes_</span></a>&gt;  browser won&#8217;t be server either</div>
<div class="line">[Tuesday 04 January 2011] [15:13:49] &lt;andrewvc&gt;       but I&#8217;m not sure how useful that is</div>
<div class="line">[Tuesday 04 January 2011] [15:13:50] &lt;<a href="#id319"><span class="problematic" id="id320">Joes_</span></a>&gt;  sub or pub, mostly</div>
<div class="line">[Tuesday 04 January 2011] [15:13:59] &lt;<a href="#id321"><span class="problematic" id="id322">Joes_</span></a>&gt;  maybe req</div>
<div class="line">[Tuesday 04 January 2011] [15:14:13] &lt;andrewvc&gt;       I&#8217;m off to grab some lunch, but it&#8217;s an interesting idea</div>
<div class="line">[Tuesday 04 January 2011] [15:14:20] &lt;andrewvc&gt;       I&#8217;d love to see a gist of a proposed API</div>
<div class="line">[Tuesday 04 January 2011] [15:14:26] &lt;<a href="#id323"><span class="problematic" id="id324">Joes_</span></a>&gt;  actually, from wire perspective it can be req</div>
<div class="line">[Tuesday 04 January 2011] [15:14:28] &lt;<a href="#id325"><span class="problematic" id="id326">Joes_</span></a>&gt;  always</div>
<div class="line">[Tuesday 04 January 2011] [15:14:37] &lt;<a href="#id327"><span class="problematic" id="id328">Joes_</span></a>&gt;  em, no.</div>
<div class="line">[Tuesday 04 January 2011] [15:14:40] &lt;<a href="#id329"><span class="problematic" id="id330">Joes_</span></a>&gt;  I need to get updates from server.</div>
<div class="line">[Tuesday 04 January 2011] [15:14:44] &lt;<a href="#id331"><span class="problematic" id="id332">Joes_</span></a>&gt;  anyway, I&#8217;ll think about it.</div>
<div class="line">[Tuesday 04 January 2011] [15:14:53] &lt;andrewvc&gt;       yeah, I&#8217;d like to hear more</div>
<div class="line">[Tuesday 04 January 2011] [15:15:00] &lt;<a href="#id333"><span class="problematic" id="id334">Joes_</span></a>&gt;  it won&#8217;t be full-scale 0mq implementation anyway</div>
<div class="line">[Tuesday 04 January 2011] [15:15:04] &lt;andrewvc&gt;       If you could ping me at &#64;andrewvc on twitter when you have something I&#8217;d be interested</div>
<div class="line">[Tuesday 04 January 2011] [15:15:09] &lt;andrewvc&gt;       anyway, off to lunch</div>
<div class="line">[Tuesday 04 January 2011] [15:15:12] &lt;<a href="#id335"><span class="problematic" id="id336">Joes_</span></a>&gt;  k</div>
<div class="line">[Tuesday 04 January 2011] [15:15:24] &lt;<a href="#id337"><span class="problematic" id="id338">Joes_</span></a>&gt;  bon appetit</div>
<div class="line">[Tuesday 04 January 2011] [15:17:32] &lt;<a href="#id339"><span class="problematic" id="id340">Joes_</span></a>&gt;  Disconnected question - how do you handle security? If you don&#8217;t want particular client to be connected, what you can do?</div>
<div class="line">[Tuesday 04 January 2011] [15:17:48] &lt;<a href="#id341"><span class="problematic" id="id342">Joes_</span></a>&gt;  so, I don&#8217;t want malicious client to DOS my message queue</div>
<div class="line">[Tuesday 04 January 2011] [15:17:52] &lt;<a href="#id343"><span class="problematic" id="id344">Joes_</span></a>&gt;  can I forcibly disconnect him?</div>
<div class="line">[Tuesday 04 January 2011] [15:17:58] &lt;<a href="#id345"><span class="problematic" id="id346">Joes_</span></a>&gt;  (in my application)</div>
<div class="line">[Tuesday 04 January 2011] [15:20:29] &lt;mikko&gt;  hmm</div>
<div class="line">[Tuesday 04 January 2011] [15:20:47] &lt;mikko&gt;  was searching for 0mq on twitter and most of the results are people using &#8220;0mq&#8221; instead of &#8220;omg&#8221;</div>
<div class="line">[Tuesday 04 January 2011] [15:20:53] &lt;<a href="#id347"><span class="problematic" id="id348">Joes_</span></a>&gt;  :-)</div>
<div class="line">[Tuesday 04 January 2011] [15:24:09] &lt;<a href="#id349"><span class="problematic" id="id350">Joes_</span></a>&gt;  mikko: any hints on how to forcibly drop connections on server side?</div>
<div class="line">[Tuesday 04 January 2011] [15:25:44] &lt;<a href="#id351"><span class="problematic" id="id352">Joes_</span></a>&gt;  or 0mq not really suited for client-facing functionality?</div>
<div class="line">[Tuesday 04 January 2011] [15:26:51] &lt;mikko&gt;  there is really no way to forcibly drop a connection</div>
<div class="line">[Tuesday 04 January 2011] [15:27:02] &lt;<a href="#id353"><span class="problematic" id="id354">Joes_</span></a>&gt;  ouch.</div>
<div class="line">[Tuesday 04 January 2011] [15:27:12] &lt;mikko&gt;  apart from closing the socket</div>
<div class="line">[Tuesday 04 January 2011] [15:27:20] &lt;<a href="#id355"><span class="problematic" id="id356">Joes_</span></a>&gt;  on client side, I assume</div>
<div class="line">[Tuesday 04 January 2011] [15:27:21] &lt;<a href="#id357"><span class="problematic" id="id358">Joes_</span></a>&gt;  ?</div>
<div class="line">[Tuesday 04 January 2011] [15:27:31] &lt;mikko&gt;  on the server-side but that closes all connections</div>
<div class="line">[Tuesday 04 January 2011] [15:27:39] &lt;<a href="#id359"><span class="problematic" id="id360">Joes_</span></a>&gt;  oops.</div>
<div class="line">[Tuesday 04 January 2011] [15:28:40] &lt;<a href="#id361"><span class="problematic" id="id362">Joes_</span></a>&gt;  means, 0mq not really suitable for client-facing stuff, as clients might misbehave</div>
<div class="line">[Tuesday 04 January 2011] [15:28:47] &lt;<a href="#id363"><span class="problematic" id="id364">Joes_</span></a>&gt;  plus, if there&#8217;s some sort of authentication</div>
<div class="line">[Tuesday 04 January 2011] [15:28:56] &lt;<a href="#id365"><span class="problematic" id="id366">Joes_</span></a>&gt;  it&#8217;s easier to disconnect client</div>
<div class="line">[Tuesday 04 January 2011] [15:29:01] &lt;<a href="#id367"><span class="problematic" id="id368">Joes_</span></a>&gt;  than to ignore all his sent messages</div>
<div class="line">[Tuesday 04 January 2011] [15:43:17] &lt;sustrik&gt;        what&#8217;s the difference? a malevolent client can reconnect immediately and sent another malformed message</div>
<div class="line">[Tuesday 04 January 2011] [15:43:59] &lt;sustrik&gt;        the only consequence is that the server would use much more CPU to handle the reconnecting instead of simply dropping the messages</div>
<div class="line">[Tuesday 04 January 2011] [15:47:25] &lt;<a href="#id369"><span class="problematic" id="id370">Joes_</span></a>&gt;  yep</div>
<div class="line">[Tuesday 04 January 2011] [15:47:28] &lt;<a href="#id371"><span class="problematic" id="id372">Joes_</span></a>&gt;  but</div>
<div class="line">[Tuesday 04 January 2011] [15:47:35] &lt;<a href="#id373"><span class="problematic" id="id374">Joes_</span></a>&gt;  let&#8217;s assume that it is pub/sub</div>
<div class="line">[Tuesday 04 January 2011] [15:47:41] &lt;<a href="#id375"><span class="problematic" id="id376">Joes_</span></a>&gt;  with, let&#8217;s say 10 subscribers</div>
<div class="line">[Tuesday 04 January 2011] [15:48:15] &lt;<a href="#id377"><span class="problematic" id="id378">Joes_</span></a>&gt;  so, bad clients sends 1 message</div>
<div class="line">[Tuesday 04 January 2011] [15:48:47] &lt;<a href="#id379"><span class="problematic" id="id380">Joes_</span></a>&gt;  and 10 messages total are sent to subscribers</div>
<div class="line">[Tuesday 04 January 2011] [15:49:01] &lt;<a href="#id381"><span class="problematic" id="id382">Joes_</span></a>&gt;  effectively, network topology creates nice DOS environment</div>
<div class="line">[Tuesday 04 January 2011] [15:49:31] &lt;<a href="#id383"><span class="problematic" id="id384">Joes_</span></a>&gt;  bad client sends*</div>
<div class="line">[Tuesday 04 January 2011] [15:49:55] &lt;<a href="#id385"><span class="problematic" id="id386">Joes_</span></a>&gt;  I mean - there&#8217;s no built-in security, so there&#8217;s no way to filter these messages before they get into &#8220;internal&#8221; network</div>
<div class="line">[Tuesday 04 January 2011] [15:50:08] &lt;<a href="#id387"><span class="problematic" id="id388">Joes_</span></a>&gt;  where workers sit</div>
<div class="line">[Tuesday 04 January 2011] [15:56:16] &lt;<a href="#id389"><span class="problematic" id="id390">Joes_</span></a>&gt;  however, I think broker which will relay messages to internal network will work</div>
<div class="line">[Tuesday 04 January 2011] [15:56:26] &lt;<a href="#id391"><span class="problematic" id="id392">Joes_</span></a>&gt;  and he&#8217;ll do the authentication stuff too</div>
<div class="line">[Tuesday 04 January 2011] [16:13:42] &lt;mikko&gt;  <a href="#id393"><span class="problematic" id="id394">Joes_</span></a>: it sounds like a sensible approach</div>
<div class="line">[Tuesday 04 January 2011] [20:47:48] &lt;jugg&gt;   sustrik, it would appear that 2.1.x C zmq_poll function needs to check ZMQ_EVENTS prior to polling the FD... yes?</div>
<div class="line">[Tuesday 04 January 2011] [20:49:53] &lt;jugg&gt;   btw, erlang bindings are functioning again... still some clean up work and consideration on how to expose certain aspects, but it is fairly usable now.</div>
<div class="line">[Tuesday 04 January 2011] [21:30:33] &lt;jugg&gt;   documentation bug: <a class="reference external" href="http://api.zeromq.org/zmq_send.html">http://api.zeromq.org/zmq_send.html</a> -&gt; EFAULT incorrectly references &#8216;context&#8217; rather than &#8216;socket&#8217;.</div>
<div class="line">[Tuesday 04 January 2011] [23:56:48] &lt;munin&gt;  i have a python / zeromq question if anyone is active..?</div>
<div class="line">[Tuesday 04 January 2011] [23:57:04] &lt;munin&gt;  i&#8217;m trying to get python 3.2 and zeromq to work and am having a problem importing zmq:</div>
<div class="line">[Tuesday 04 January 2011] [23:57:14] &lt;munin&gt;  ImportError: /home/munin/dbz-class/python/lib/python3.2/site-packages/zmq/core/poll.cpython-32m.so: undefined symbol: PyCObject_FromVoidPtr</div>
<div class="line">[Wednesday 05 January 2011] [01:31:27] &lt;the_hulk&gt;     hi, if i allocate a memory to zmq_msg_t pointer using malloc, then does zmq_msg_close frees the memory, or i would have to free it?</div>
<div class="line">[Wednesday 05 January 2011] [01:35:49] &lt;jsimmons&gt;     if you allocate it, you have to free it.</div>
<div class="line">[Wednesday 05 January 2011] [01:36:36] &lt;the_hulk&gt;     jsimmons, after zmq_msg_close, ok, thanks</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="2011-December.html"
                        title="previous chapter">2011-December</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="sources/2011-January.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="2011-December.html" title="2011-December"
             >previous</a> |</li>
        <li><a href="index.html">ZeroMq IRC Log v0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2010, Peter Alexander.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.5.
    </div>
  </body>
</html>